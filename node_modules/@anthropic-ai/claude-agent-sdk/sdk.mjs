#!/usr/bin/env node
// (c) Anthropic PBC. All rights reserved. Use is subject to the Legal Agreements outlined here: https://code.claude.com/docs/en/legal-and-compliance.

// Version: 0.2.50

// Want to see the unminified source? We're hiring!
// https://job-boards.greenhouse.io/anthropic/jobs/4816199008
import{createRequire as oq}from"node:module";var pq=Object.create;var{getPrototypeOf:dq,defineProperty:xQ,getOwnPropertyNames:iq}=Object;var nq=Object.prototype.hasOwnProperty;var b8=(Q,X,$)=>{$=Q!=null?pq(dq(Q)):{};let Y=X||!Q||!Q.__esModule?xQ($,"default",{value:Q,enumerable:!0}):$;for(let G of iq(Q))if(!nq.call(Y,G))xQ(Y,G,{get:()=>Q[G],enumerable:!0});return Y};var b=(Q,X)=>()=>(X||Q((X={exports:{}}).exports,X),X.exports);var w7=(Q,X)=>{for(var $ in X)xQ(Q,$,{get:X[$],enumerable:!0,configurable:!0,set:(Y)=>X[$]=()=>Y})};var L0=oq(import.meta.url),rq=Symbol.dispose||Symbol.for("Symbol.dispose"),tq=Symbol.asyncDispose||Symbol.for("Symbol.asyncDispose"),e=(Q,X,$)=>{if(X!=null){if(typeof X!=="object"&&typeof X!=="function")throw TypeError('Object expected to be assigned to "using" declaration');var Y;if($)Y=X[tq];if(Y===void 0)Y=X[rq];if(typeof Y!=="function")throw TypeError("Object not disposable");Q.push([$,Y,X])}else if($)Q.push([$]);return X},Q1=(Q,X,$)=>{var Y=typeof SuppressedError==="function"?SuppressedError:function(W,H,z,B){return B=Error(z),B.name="SuppressedError",B.error=W,B.suppressed=H,B},G=(W)=>X=$?new Y(W,X,"An error was suppressed during disposal"):($=!0,W),J=(W)=>{while(W=Q.pop())try{var H=W[1]&&W[1].call(W[2]);if(W[0])return Promise.resolve(H).then(J,(z)=>(G(z),J()))}catch(z){G(z)}if($)throw X};return J()};var A5=b((u_,M5)=>{M5.exports=O5;O5.sync=oL;var N5=L0("fs");function nL(Q,X){var $=X.pathExt!==void 0?X.pathExt:process.env.PATHEXT;if(!$)return!0;if($=$.split(";"),$.indexOf("")!==-1)return!0;for(var Y=0;Y<$.length;Y++){var G=$[Y].toLowerCase();if(G&&Q.substr(-G.length).toLowerCase()===G)return!0}return!1}function D5(Q,X,$){if(!Q.isSymbolicLink()&&!Q.isFile())return!1;return nL(X,$)}function O5(Q,X,$){N5.stat(Q,function(Y,G){$(Y,Y?!1:D5(G,Q,X))})}function oL(Q,X){return D5(N5.statSync(Q),Q,X)}});var R5=b((l_,b5)=>{b5.exports=j5;j5.sync=rL;var w5=L0("fs");function j5(Q,X,$){w5.stat(Q,function(Y,G){$(Y,Y?!1:I5(G,X))})}function rL(Q,X){return I5(w5.statSync(Q),X)}function I5(Q,X){return Q.isFile()&&tL(Q,X)}function tL(Q,X){var{mode:$,uid:Y,gid:G}=Q,J=X.uid!==void 0?X.uid:process.getuid&&process.getuid(),W=X.gid!==void 0?X.gid:process.getgid&&process.getgid(),H=parseInt("100",8),z=parseInt("010",8),B=parseInt("001",8),K=H|z,q=$&B||$&z&&G===W||$&H&&Y===J||$&K&&J===0;return q}});var P5=b((c_,E5)=>{var m_=L0("fs"),v8;if(process.platform==="win32"||global.TESTING_WINDOWS)v8=A5();else v8=R5();E5.exports=uQ;uQ.sync=aL;function uQ(Q,X,$){if(typeof X==="function")$=X,X={};if(!$){if(typeof Promise!=="function")throw TypeError("callback not provided");return new Promise(function(Y,G){uQ(Q,X||{},function(J,W){if(J)G(J);else Y(W)})})}v8(Q,X||{},function(Y,G){if(Y){if(Y.code==="EACCES"||X&&X.ignoreErrors)Y=null,G=!1}$(Y,G)})}function aL(Q,X){try{return v8.sync(Q,X||{})}catch($){if(X&&X.ignoreErrors||$.code==="EACCES")return!1;else throw $}}});var T5=b((p_,v5)=>{var S6=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",S5=L0("path"),sL=S6?";":":",Z5=P5(),C5=(Q)=>Object.assign(Error(`not found: ${Q}`),{code:"ENOENT"}),_5=(Q,X)=>{let $=X.colon||sL,Y=Q.match(/\//)||S6&&Q.match(/\\/)?[""]:[...S6?[process.cwd()]:[],...(X.path||process.env.PATH||"").split($)],G=S6?X.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",J=S6?G.split($):[""];if(S6){if(Q.indexOf(".")!==-1&&J[0]!=="")J.unshift("")}return{pathEnv:Y,pathExt:J,pathExtExe:G}},k5=(Q,X,$)=>{if(typeof X==="function")$=X,X={};if(!X)X={};let{pathEnv:Y,pathExt:G,pathExtExe:J}=_5(Q,X),W=[],H=(B)=>new Promise((K,q)=>{if(B===Y.length)return X.all&&W.length?K(W):q(C5(Q));let U=Y[B],V=/^".*"$/.test(U)?U.slice(1,-1):U,L=S5.join(V,Q),F=!V&&/^\.[\\\/]/.test(Q)?Q.slice(0,2)+L:L;K(z(F,B,0))}),z=(B,K,q)=>new Promise((U,V)=>{if(q===G.length)return U(H(K+1));let L=G[q];Z5(B+L,{pathExt:J},(F,M)=>{if(!F&&M)if(X.all)W.push(B+L);else return U(B+L);return U(z(B,K,q+1))})});return $?H(0).then((B)=>$(null,B),$):H(0)},eL=(Q,X)=>{X=X||{};let{pathEnv:$,pathExt:Y,pathExtExe:G}=_5(Q,X),J=[];for(let W=0;W<$.length;W++){let H=$[W],z=/^".*"$/.test(H)?H.slice(1,-1):H,B=S5.join(z,Q),K=!z&&/^\.[\\\/]/.test(Q)?Q.slice(0,2)+B:B;for(let q=0;q<Y.length;q++){let U=K+Y[q];try{if(Z5.sync(U,{pathExt:G}))if(X.all)J.push(U);else return U}catch(V){}}}if(X.all&&J.length)return J;if(X.nothrow)return null;throw C5(Q)};v5.exports=k5;k5.sync=eL});var y5=b((d_,lQ)=>{var x5=(Q={})=>{let X=Q.env||process.env;if((Q.platform||process.platform)!=="win32")return"PATH";return Object.keys(X).reverse().find((Y)=>Y.toUpperCase()==="PATH")||"Path"};lQ.exports=x5;lQ.exports.default=x5});var u5=b((i_,h5)=>{var g5=L0("path"),QF=T5(),XF=y5();function f5(Q,X){let $=Q.options.env||process.env,Y=process.cwd(),G=Q.options.cwd!=null,J=G&&process.chdir!==void 0&&!process.chdir.disabled;if(J)try{process.chdir(Q.options.cwd)}catch(H){}let W;try{W=QF.sync(Q.command,{path:$[XF({env:$})],pathExt:X?g5.delimiter:void 0})}catch(H){}finally{if(J)process.chdir(Y)}if(W)W=g5.resolve(G?Q.options.cwd:"",W);return W}function $F(Q){return f5(Q)||f5(Q,!0)}h5.exports=$F});var l5=b((JF,cQ)=>{var mQ=/([()\][%!^"`<>&|;, *?])/g;function YF(Q){return Q=Q.replace(mQ,"^$1"),Q}function GF(Q,X){if(Q=`${Q}`,Q=Q.replace(/(?=(\\+?)?)\1"/g,"$1$1\\\""),Q=Q.replace(/(?=(\\+?)?)\1$/,"$1$1"),Q=`"${Q}"`,Q=Q.replace(mQ,"^$1"),X)Q=Q.replace(mQ,"^$1");return Q}JF.command=YF;JF.argument=GF});var c5=b((n_,m5)=>{m5.exports=/^#!(.*)/});var d5=b((o_,p5)=>{var zF=c5();p5.exports=(Q="")=>{let X=Q.match(zF);if(!X)return null;let[$,Y]=X[0].replace(/#! ?/,"").split(" "),G=$.split("/").pop();if(G==="env")return Y;return Y?`${G} ${Y}`:G}});var n5=b((r_,i5)=>{var pQ=L0("fs"),BF=d5();function KF(Q){let $=Buffer.alloc(150),Y;try{Y=pQ.openSync(Q,"r"),pQ.readSync(Y,$,0,150,0),pQ.closeSync(Y)}catch(G){}return BF($.toString())}i5.exports=KF});var a5=b((t_,t5)=>{var VF=L0("path"),o5=u5(),r5=l5(),qF=n5(),UF=process.platform==="win32",LF=/\.(?:com|exe)$/i,FF=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function NF(Q){Q.file=o5(Q);let X=Q.file&&qF(Q.file);if(X)return Q.args.unshift(Q.file),Q.command=X,o5(Q);return Q.file}function DF(Q){if(!UF)return Q;let X=NF(Q),$=!LF.test(X);if(Q.options.forceShell||$){let Y=FF.test(X);Q.command=VF.normalize(Q.command),Q.command=r5.command(Q.command),Q.args=Q.args.map((J)=>r5.argument(J,Y));let G=[Q.command].concat(Q.args).join(" ");Q.args=["/d","/s","/c",`"${G}"`],Q.command=process.env.comspec||"cmd.exe",Q.options.windowsVerbatimArguments=!0}return Q}function OF(Q,X,$){if(X&&!Array.isArray(X))$=X,X=null;X=X?X.slice(0):[],$=Object.assign({},$);let Y={command:Q,args:X,options:$,file:void 0,original:{command:Q,args:X}};return $.shell?Y:DF(Y)}t5.exports=OF});var QJ=b((a_,e5)=>{var dQ=process.platform==="win32";function iQ(Q,X){return Object.assign(Error(`${X} ${Q.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${X} ${Q.command}`,path:Q.command,spawnargs:Q.args})}function MF(Q,X){if(!dQ)return;let $=Q.emit;Q.emit=function(Y,G){if(Y==="exit"){let J=s5(G,X);if(J)return $.call(Q,"error",J)}return $.apply(Q,arguments)}}function s5(Q,X){if(dQ&&Q===1&&!X.file)return iQ(X.original,"spawn");return null}function AF(Q,X){if(dQ&&Q===1&&!X.file)return iQ(X.original,"spawnSync");return null}e5.exports={hookChildProcess:MF,verifyENOENT:s5,verifyENOENTSync:AF,notFoundError:iQ}});var YJ=b((s_,Z6)=>{var XJ=L0("child_process"),nQ=a5(),oQ=QJ();function $J(Q,X,$){let Y=nQ(Q,X,$),G=XJ.spawn(Y.command,Y.args,Y.options);return oQ.hookChildProcess(G,Y),G}function wF(Q,X,$){let Y=nQ(Q,X,$),G=XJ.spawnSync(Y.command,Y.args,Y.options);return G.error=G.error||oQ.verifyENOENTSync(G.status,Y),G}Z6.exports=$J;Z6.exports.spawn=$J;Z6.exports.sync=wF;Z6.exports._parse=nQ;Z6.exports._enoent=oQ});var vJ=b((Yv,kJ)=>{var{PassThrough:MN}=L0("stream");kJ.exports=function(){var Q=[],X=new MN({objectMode:!0});return X.setMaxListeners(0),X.add=$,X.isEmpty=Y,X.on("unpipe",G),Array.prototype.slice.call(arguments).forEach($),X;function $(J){if(Array.isArray(J))return J.forEach($),this;return Q.push(J),J.once("end",G.bind(null,J)),J.once("error",X.emit.bind(X,"error")),J.pipe(X,{end:!1}),this}function Y(){return Q.length==0}function G(J){if(Q=Q.filter(function(W){return W!==J}),!Q.length&&X.readable)X.end()}}});var a4=b((cH)=>{Object.defineProperty(cH,"__esModule",{value:!0});cH.regexpCode=cH.getEsmExportName=cH.getProperty=cH.safeStringify=cH.stringify=cH.strConcat=cH.addCodeArg=cH.str=cH._=cH.nil=cH._Code=cH.Name=cH.IDENTIFIER=cH._CodeOrName=void 0;class t9{}cH._CodeOrName=t9;cH.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class d6 extends t9{constructor(Q){super();if(!cH.IDENTIFIER.test(Q))throw Error("CodeGen: name must be a valid identifier");this.str=Q}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}cH.Name=d6;class Q0 extends t9{constructor(Q){super();this._items=typeof Q==="string"?[Q]:Q}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let Q=this._items[0];return Q===""||Q==='""'}get str(){var Q;return(Q=this._str)!==null&&Q!==void 0?Q:this._str=this._items.reduce((X,$)=>`${X}${$}`,"")}get names(){var Q;return(Q=this._names)!==null&&Q!==void 0?Q:this._names=this._items.reduce((X,$)=>{if($ instanceof d6)X[$.str]=(X[$.str]||0)+1;return X},{})}}cH._Code=Q0;cH.nil=new Q0("");function lH(Q,...X){let $=[Q[0]],Y=0;while(Y<X.length)zG($,X[Y]),$.push(Q[++Y]);return new Q0($)}cH._=lH;var HG=new Q0("+");function mH(Q,...X){let $=[t4(Q[0])],Y=0;while(Y<X.length)$.push(HG),zG($,X[Y]),$.push(HG,t4(Q[++Y]));return qw($),new Q0($)}cH.str=mH;function zG(Q,X){if(X instanceof Q0)Q.push(...X._items);else if(X instanceof d6)Q.push(X);else Q.push(Fw(X))}cH.addCodeArg=zG;function qw(Q){let X=1;while(X<Q.length-1){if(Q[X]===HG){let $=Uw(Q[X-1],Q[X+1]);if($!==void 0){Q.splice(X-1,3,$);continue}Q[X++]="+"}X++}}function Uw(Q,X){if(X==='""')return Q;if(Q==='""')return X;if(typeof Q=="string"){if(X instanceof d6||Q[Q.length-1]!=='"')return;if(typeof X!="string")return`${Q.slice(0,-1)}${X}"`;if(X[0]==='"')return Q.slice(0,-1)+X.slice(1);return}if(typeof X=="string"&&X[0]==='"'&&!(Q instanceof d6))return`"${Q}${X.slice(1)}`;return}function Lw(Q,X){return X.emptyStr()?Q:Q.emptyStr()?X:mH`${Q}${X}`}cH.strConcat=Lw;function Fw(Q){return typeof Q=="number"||typeof Q=="boolean"||Q===null?Q:t4(Array.isArray(Q)?Q.join(","):Q)}function Nw(Q){return new Q0(t4(Q))}cH.stringify=Nw;function t4(Q){return JSON.stringify(Q).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}cH.safeStringify=t4;function Dw(Q){return typeof Q=="string"&&cH.IDENTIFIER.test(Q)?new Q0(`.${Q}`):lH`[${Q}]`}cH.getProperty=Dw;function Ow(Q){if(typeof Q=="string"&&cH.IDENTIFIER.test(Q))return new Q0(`${Q}`);throw Error(`CodeGen: invalid export name: ${Q}, use explicit $id name mapping`)}cH.getEsmExportName=Ow;function Mw(Q){return new Q0(Q.toString())}cH.regexpCode=Mw});var qG=b((nH)=>{Object.defineProperty(nH,"__esModule",{value:!0});nH.ValueScope=nH.ValueScopeName=nH.Scope=nH.varKinds=nH.UsedValueState=void 0;var x1=a4();class dH extends Error{constructor(Q){super(`CodeGen: "code" for ${Q} not defined`);this.value=Q.value}}var s9;(function(Q){Q[Q.Started=0]="Started",Q[Q.Completed=1]="Completed"})(s9||(nH.UsedValueState=s9={}));nH.varKinds={const:new x1.Name("const"),let:new x1.Name("let"),var:new x1.Name("var")};class KG{constructor({prefixes:Q,parent:X}={}){this._names={},this._prefixes=Q,this._parent=X}toName(Q){return Q instanceof x1.Name?Q:this.name(Q)}name(Q){return new x1.Name(this._newName(Q))}_newName(Q){let X=this._names[Q]||this._nameGroup(Q);return`${Q}${X.index++}`}_nameGroup(Q){var X,$;if((($=(X=this._parent)===null||X===void 0?void 0:X._prefixes)===null||$===void 0?void 0:$.has(Q))||this._prefixes&&!this._prefixes.has(Q))throw Error(`CodeGen: prefix "${Q}" is not allowed in this scope`);return this._names[Q]={prefix:Q,index:0}}}nH.Scope=KG;class VG extends x1.Name{constructor(Q,X){super(X);this.prefix=Q}setValue(Q,{property:X,itemIndex:$}){this.value=Q,this.scopePath=x1._`.${new x1.Name(X)}[${$}]`}}nH.ValueScopeName=VG;var kw=x1._`\n`;class iH extends KG{constructor(Q){super(Q);this._values={},this._scope=Q.scope,this.opts={...Q,_n:Q.lines?kw:x1.nil}}get(){return this._scope}name(Q){return new VG(Q,this._newName(Q))}value(Q,X){var $;if(X.ref===void 0)throw Error("CodeGen: ref must be passed in value");let Y=this.toName(Q),{prefix:G}=Y,J=($=X.key)!==null&&$!==void 0?$:X.ref,W=this._values[G];if(W){let B=W.get(J);if(B)return B}else W=this._values[G]=new Map;W.set(J,Y);let H=this._scope[G]||(this._scope[G]=[]),z=H.length;return H[z]=X.ref,Y.setValue(X,{property:G,itemIndex:z}),Y}getValue(Q,X){let $=this._values[Q];if(!$)return;return $.get(X)}scopeRefs(Q,X=this._values){return this._reduceValues(X,($)=>{if($.scopePath===void 0)throw Error(`CodeGen: name "${$}" has no value`);return x1._`${Q}${$.scopePath}`})}scopeCode(Q=this._values,X,$){return this._reduceValues(Q,(Y)=>{if(Y.value===void 0)throw Error(`CodeGen: name "${Y}" has no value`);return Y.value.code},X,$)}_reduceValues(Q,X,$={},Y){let G=x1.nil;for(let J in Q){let W=Q[J];if(!W)continue;let H=$[J]=$[J]||new Map;W.forEach((z)=>{if(H.has(z))return;H.set(z,s9.Started);let B=X(z);if(B){let K=this.opts.es5?nH.varKinds.var:nH.varKinds.const;G=x1._`${G}${K} ${z} = ${B};${this.opts._n}`}else if(B=Y===null||Y===void 0?void 0:Y(z))G=x1._`${G}${B}${this.opts._n}`;else throw new dH(z);H.set(z,s9.Completed)})}return G}}nH.ValueScope=iH});var c=b((y1)=>{Object.defineProperty(y1,"__esModule",{value:!0});y1.or=y1.and=y1.not=y1.CodeGen=y1.operators=y1.varKinds=y1.ValueScopeName=y1.ValueScope=y1.Scope=y1.Name=y1.regexpCode=y1.stringify=y1.getProperty=y1.nil=y1.strConcat=y1.str=y1._=void 0;var r=a4(),X0=qG(),c0=a4();Object.defineProperty(y1,"_",{enumerable:!0,get:function(){return c0._}});Object.defineProperty(y1,"str",{enumerable:!0,get:function(){return c0.str}});Object.defineProperty(y1,"strConcat",{enumerable:!0,get:function(){return c0.strConcat}});Object.defineProperty(y1,"nil",{enumerable:!0,get:function(){return c0.nil}});Object.defineProperty(y1,"getProperty",{enumerable:!0,get:function(){return c0.getProperty}});Object.defineProperty(y1,"stringify",{enumerable:!0,get:function(){return c0.stringify}});Object.defineProperty(y1,"regexpCode",{enumerable:!0,get:function(){return c0.regexpCode}});Object.defineProperty(y1,"Name",{enumerable:!0,get:function(){return c0.Name}});var GQ=qG();Object.defineProperty(y1,"Scope",{enumerable:!0,get:function(){return GQ.Scope}});Object.defineProperty(y1,"ValueScope",{enumerable:!0,get:function(){return GQ.ValueScope}});Object.defineProperty(y1,"ValueScopeName",{enumerable:!0,get:function(){return GQ.ValueScopeName}});Object.defineProperty(y1,"varKinds",{enumerable:!0,get:function(){return GQ.varKinds}});y1.operators={GT:new r._Code(">"),GTE:new r._Code(">="),LT:new r._Code("<"),LTE:new r._Code("<="),EQ:new r._Code("==="),NEQ:new r._Code("!=="),NOT:new r._Code("!"),OR:new r._Code("||"),AND:new r._Code("&&"),ADD:new r._Code("+")};class p0{optimizeNodes(){return this}optimizeNames(Q,X){return this}}class rH extends p0{constructor(Q,X,$){super();this.varKind=Q,this.name=X,this.rhs=$}render({es5:Q,_n:X}){let $=Q?X0.varKinds.var:this.varKind,Y=this.rhs===void 0?"":` = ${this.rhs}`;return`${$} ${this.name}${Y};`+X}optimizeNames(Q,X){if(!Q[this.name.str])return;if(this.rhs)this.rhs=n6(this.rhs,Q,X);return this}get names(){return this.rhs instanceof r._CodeOrName?this.rhs.names:{}}}class FG extends p0{constructor(Q,X,$){super();this.lhs=Q,this.rhs=X,this.sideEffects=$}render({_n:Q}){return`${this.lhs} = ${this.rhs};`+Q}optimizeNames(Q,X){if(this.lhs instanceof r.Name&&!Q[this.lhs.str]&&!this.sideEffects)return;return this.rhs=n6(this.rhs,Q,X),this}get names(){let Q=this.lhs instanceof r.Name?{}:{...this.lhs.names};return YQ(Q,this.rhs)}}class tH extends FG{constructor(Q,X,$,Y){super(Q,$,Y);this.op=X}render({_n:Q}){return`${this.lhs} ${this.op}= ${this.rhs};`+Q}}class aH extends p0{constructor(Q){super();this.label=Q,this.names={}}render({_n:Q}){return`${this.label}:`+Q}}class sH extends p0{constructor(Q){super();this.label=Q,this.names={}}render({_n:Q}){return`break${this.label?` ${this.label}`:""};`+Q}}class eH extends p0{constructor(Q){super();this.error=Q}render({_n:Q}){return`throw ${this.error};`+Q}get names(){return this.error.names}}class Qz extends p0{constructor(Q){super();this.code=Q}render({_n:Q}){return`${this.code};`+Q}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(Q,X){return this.code=n6(this.code,Q,X),this}get names(){return this.code instanceof r._CodeOrName?this.code.names:{}}}class JQ extends p0{constructor(Q=[]){super();this.nodes=Q}render(Q){return this.nodes.reduce((X,$)=>X+$.render(Q),"")}optimizeNodes(){let{nodes:Q}=this,X=Q.length;while(X--){let $=Q[X].optimizeNodes();if(Array.isArray($))Q.splice(X,1,...$);else if($)Q[X]=$;else Q.splice(X,1)}return Q.length>0?this:void 0}optimizeNames(Q,X){let{nodes:$}=this,Y=$.length;while(Y--){let G=$[Y];if(G.optimizeNames(Q,X))continue;yw(Q,G.names),$.splice(Y,1)}return $.length>0?this:void 0}get names(){return this.nodes.reduce((Q,X)=>U6(Q,X.names),{})}}class d0 extends JQ{render(Q){return"{"+Q._n+super.render(Q)+"}"+Q._n}}class Xz extends JQ{}class s4 extends d0{}s4.kind="else";class b0 extends d0{constructor(Q,X){super(X);this.condition=Q}render(Q){let X=`if(${this.condition})`+super.render(Q);if(this.else)X+="else "+this.else.render(Q);return X}optimizeNodes(){super.optimizeNodes();let Q=this.condition;if(Q===!0)return this.nodes;let X=this.else;if(X){let $=X.optimizeNodes();X=this.else=Array.isArray($)?new s4($):$}if(X){if(Q===!1)return X instanceof b0?X:X.nodes;if(this.nodes.length)return this;return new b0(Wz(Q),X instanceof b0?[X]:X.nodes)}if(Q===!1||!this.nodes.length)return;return this}optimizeNames(Q,X){var $;if(this.else=($=this.else)===null||$===void 0?void 0:$.optimizeNames(Q,X),!(super.optimizeNames(Q,X)||this.else))return;return this.condition=n6(this.condition,Q,X),this}get names(){let Q=super.names;if(YQ(Q,this.condition),this.else)U6(Q,this.else.names);return Q}}b0.kind="if";class i6 extends d0{}i6.kind="for";class $z extends i6{constructor(Q){super();this.iteration=Q}render(Q){return`for(${this.iteration})`+super.render(Q)}optimizeNames(Q,X){if(!super.optimizeNames(Q,X))return;return this.iteration=n6(this.iteration,Q,X),this}get names(){return U6(super.names,this.iteration.names)}}class Yz extends i6{constructor(Q,X,$,Y){super();this.varKind=Q,this.name=X,this.from=$,this.to=Y}render(Q){let X=Q.es5?X0.varKinds.var:this.varKind,{name:$,from:Y,to:G}=this;return`for(${X} ${$}=${Y}; ${$}<${G}; ${$}++)`+super.render(Q)}get names(){let Q=YQ(super.names,this.from);return YQ(Q,this.to)}}class UG extends i6{constructor(Q,X,$,Y){super();this.loop=Q,this.varKind=X,this.name=$,this.iterable=Y}render(Q){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(Q)}optimizeNames(Q,X){if(!super.optimizeNames(Q,X))return;return this.iterable=n6(this.iterable,Q,X),this}get names(){return U6(super.names,this.iterable.names)}}class e9 extends d0{constructor(Q,X,$){super();this.name=Q,this.args=X,this.async=$}render(Q){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(Q)}}e9.kind="func";class QQ extends JQ{render(Q){return"return "+super.render(Q)}}QQ.kind="return";class Gz extends d0{render(Q){let X="try"+super.render(Q);if(this.catch)X+=this.catch.render(Q);if(this.finally)X+=this.finally.render(Q);return X}optimizeNodes(){var Q,X;return super.optimizeNodes(),(Q=this.catch)===null||Q===void 0||Q.optimizeNodes(),(X=this.finally)===null||X===void 0||X.optimizeNodes(),this}optimizeNames(Q,X){var $,Y;return super.optimizeNames(Q,X),($=this.catch)===null||$===void 0||$.optimizeNames(Q,X),(Y=this.finally)===null||Y===void 0||Y.optimizeNames(Q,X),this}get names(){let Q=super.names;if(this.catch)U6(Q,this.catch.names);if(this.finally)U6(Q,this.finally.names);return Q}}class XQ extends d0{constructor(Q){super();this.error=Q}render(Q){return`catch(${this.error})`+super.render(Q)}}XQ.kind="catch";class $Q extends d0{render(Q){return"finally"+super.render(Q)}}$Q.kind="finally";class Jz{constructor(Q,X={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...X,_n:X.lines?`
`:""},this._extScope=Q,this._scope=new X0.Scope({parent:Q}),this._nodes=[new Xz]}toString(){return this._root.render(this.opts)}name(Q){return this._scope.name(Q)}scopeName(Q){return this._extScope.name(Q)}scopeValue(Q,X){let $=this._extScope.value(Q,X);return(this._values[$.prefix]||(this._values[$.prefix]=new Set)).add($),$}getScopeValue(Q,X){return this._extScope.getValue(Q,X)}scopeRefs(Q){return this._extScope.scopeRefs(Q,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(Q,X,$,Y){let G=this._scope.toName(X);if($!==void 0&&Y)this._constants[G.str]=$;return this._leafNode(new rH(Q,G,$)),G}const(Q,X,$){return this._def(X0.varKinds.const,Q,X,$)}let(Q,X,$){return this._def(X0.varKinds.let,Q,X,$)}var(Q,X,$){return this._def(X0.varKinds.var,Q,X,$)}assign(Q,X,$){return this._leafNode(new FG(Q,X,$))}add(Q,X){return this._leafNode(new tH(Q,y1.operators.ADD,X))}code(Q){if(typeof Q=="function")Q();else if(Q!==r.nil)this._leafNode(new Qz(Q));return this}object(...Q){let X=["{"];for(let[$,Y]of Q){if(X.length>1)X.push(",");if(X.push($),$!==Y||this.opts.es5)X.push(":"),(0,r.addCodeArg)(X,Y)}return X.push("}"),new r._Code(X)}if(Q,X,$){if(this._blockNode(new b0(Q)),X&&$)this.code(X).else().code($).endIf();else if(X)this.code(X).endIf();else if($)throw Error('CodeGen: "else" body without "then" body');return this}elseIf(Q){return this._elseNode(new b0(Q))}else(){return this._elseNode(new s4)}endIf(){return this._endBlockNode(b0,s4)}_for(Q,X){if(this._blockNode(Q),X)this.code(X).endFor();return this}for(Q,X){return this._for(new $z(Q),X)}forRange(Q,X,$,Y,G=this.opts.es5?X0.varKinds.var:X0.varKinds.let){let J=this._scope.toName(Q);return this._for(new Yz(G,J,X,$),()=>Y(J))}forOf(Q,X,$,Y=X0.varKinds.const){let G=this._scope.toName(Q);if(this.opts.es5){let J=X instanceof r.Name?X:this.var("_arr",X);return this.forRange("_i",0,r._`${J}.length`,(W)=>{this.var(G,r._`${J}[${W}]`),$(G)})}return this._for(new UG("of",Y,G,X),()=>$(G))}forIn(Q,X,$,Y=this.opts.es5?X0.varKinds.var:X0.varKinds.const){if(this.opts.ownProperties)return this.forOf(Q,r._`Object.keys(${X})`,$);let G=this._scope.toName(Q);return this._for(new UG("in",Y,G,X),()=>$(G))}endFor(){return this._endBlockNode(i6)}label(Q){return this._leafNode(new aH(Q))}break(Q){return this._leafNode(new sH(Q))}return(Q){let X=new QQ;if(this._blockNode(X),this.code(Q),X.nodes.length!==1)throw Error('CodeGen: "return" should have one node');return this._endBlockNode(QQ)}try(Q,X,$){if(!X&&!$)throw Error('CodeGen: "try" without "catch" and "finally"');let Y=new Gz;if(this._blockNode(Y),this.code(Q),X){let G=this.name("e");this._currNode=Y.catch=new XQ(G),X(G)}if($)this._currNode=Y.finally=new $Q,this.code($);return this._endBlockNode(XQ,$Q)}throw(Q){return this._leafNode(new eH(Q))}block(Q,X){if(this._blockStarts.push(this._nodes.length),Q)this.code(Q).endBlock(X);return this}endBlock(Q){let X=this._blockStarts.pop();if(X===void 0)throw Error("CodeGen: not in self-balancing block");let $=this._nodes.length-X;if($<0||Q!==void 0&&$!==Q)throw Error(`CodeGen: wrong number of nodes: ${$} vs ${Q} expected`);return this._nodes.length=X,this}func(Q,X=r.nil,$,Y){if(this._blockNode(new e9(Q,X,$)),Y)this.code(Y).endFunc();return this}endFunc(){return this._endBlockNode(e9)}optimize(Q=1){while(Q-- >0)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(Q){return this._currNode.nodes.push(Q),this}_blockNode(Q){this._currNode.nodes.push(Q),this._nodes.push(Q)}_endBlockNode(Q,X){let $=this._currNode;if($ instanceof Q||X&&$ instanceof X)return this._nodes.pop(),this;throw Error(`CodeGen: not in block "${X?`${Q.kind}/${X.kind}`:Q.kind}"`)}_elseNode(Q){let X=this._currNode;if(!(X instanceof b0))throw Error('CodeGen: "else" without "if"');return this._currNode=X.else=Q,this}get _root(){return this._nodes[0]}get _currNode(){let Q=this._nodes;return Q[Q.length-1]}set _currNode(Q){let X=this._nodes;X[X.length-1]=Q}}y1.CodeGen=Jz;function U6(Q,X){for(let $ in X)Q[$]=(Q[$]||0)+(X[$]||0);return Q}function YQ(Q,X){return X instanceof r._CodeOrName?U6(Q,X.names):Q}function n6(Q,X,$){if(Q instanceof r.Name)return Y(Q);if(!G(Q))return Q;return new r._Code(Q._items.reduce((J,W)=>{if(W instanceof r.Name)W=Y(W);if(W instanceof r._Code)J.push(...W._items);else J.push(W);return J},[]));function Y(J){let W=$[J.str];if(W===void 0||X[J.str]!==1)return J;return delete X[J.str],W}function G(J){return J instanceof r._Code&&J._items.some((W)=>W instanceof r.Name&&X[W.str]===1&&$[W.str]!==void 0)}}function yw(Q,X){for(let $ in X)Q[$]=(Q[$]||0)-(X[$]||0)}function Wz(Q){return typeof Q=="boolean"||typeof Q=="number"||Q===null?!Q:r._`!${LG(Q)}`}y1.not=Wz;var gw=Hz(y1.operators.AND);function fw(...Q){return Q.reduce(gw)}y1.and=fw;var hw=Hz(y1.operators.OR);function uw(...Q){return Q.reduce(hw)}y1.or=uw;function Hz(Q){return(X,$)=>X===r.nil?$:$===r.nil?X:r._`${LG(X)} ${Q} ${LG($)}`}function LG(Q){return Q instanceof r.Name?Q:r._`(${Q})`}});var a=b((Nz)=>{Object.defineProperty(Nz,"__esModule",{value:!0});Nz.checkStrictMode=Nz.getErrorPath=Nz.Type=Nz.useFunc=Nz.setEvaluated=Nz.evaluatedPropsToName=Nz.mergeEvaluated=Nz.eachItem=Nz.unescapeJsonPointer=Nz.escapeJsonPointer=Nz.escapeFragment=Nz.unescapeFragment=Nz.schemaRefOrVal=Nz.schemaHasRulesButRef=Nz.schemaHasRules=Nz.checkUnknownRules=Nz.alwaysValidSchema=Nz.toHash=void 0;var $1=c(),pw=a4();function dw(Q){let X={};for(let $ of Q)X[$]=!0;return X}Nz.toHash=dw;function iw(Q,X){if(typeof X=="boolean")return X;if(Object.keys(X).length===0)return!0;return Vz(Q,X),!qz(X,Q.self.RULES.all)}Nz.alwaysValidSchema=iw;function Vz(Q,X=Q.schema){let{opts:$,self:Y}=Q;if(!$.strictSchema)return;if(typeof X==="boolean")return;let G=Y.RULES.keywords;for(let J in X)if(!G[J])Fz(Q,`unknown keyword: "${J}"`)}Nz.checkUnknownRules=Vz;function qz(Q,X){if(typeof Q=="boolean")return!Q;for(let $ in Q)if(X[$])return!0;return!1}Nz.schemaHasRules=qz;function nw(Q,X){if(typeof Q=="boolean")return!Q;for(let $ in Q)if($!=="$ref"&&X.all[$])return!0;return!1}Nz.schemaHasRulesButRef=nw;function ow({topSchemaRef:Q,schemaPath:X},$,Y,G){if(!G){if(typeof $=="number"||typeof $=="boolean")return $;if(typeof $=="string")return $1._`${$}`}return $1._`${Q}${X}${(0,$1.getProperty)(Y)}`}Nz.schemaRefOrVal=ow;function rw(Q){return Uz(decodeURIComponent(Q))}Nz.unescapeFragment=rw;function tw(Q){return encodeURIComponent(DG(Q))}Nz.escapeFragment=tw;function DG(Q){if(typeof Q=="number")return`${Q}`;return Q.replace(/~/g,"~0").replace(/\//g,"~1")}Nz.escapeJsonPointer=DG;function Uz(Q){return Q.replace(/~1/g,"/").replace(/~0/g,"~")}Nz.unescapeJsonPointer=Uz;function aw(Q,X){if(Array.isArray(Q))for(let $ of Q)X($);else X(Q)}Nz.eachItem=aw;function Bz({mergeNames:Q,mergeToName:X,mergeValues:$,resultToName:Y}){return(G,J,W,H)=>{let z=W===void 0?J:W instanceof $1.Name?(J instanceof $1.Name?Q(G,J,W):X(G,J,W),W):J instanceof $1.Name?(X(G,W,J),J):$(J,W);return H===$1.Name&&!(z instanceof $1.Name)?Y(G,z):z}}Nz.mergeEvaluated={props:Bz({mergeNames:(Q,X,$)=>Q.if($1._`${$} !== true && ${X} !== undefined`,()=>{Q.if($1._`${X} === true`,()=>Q.assign($,!0),()=>Q.assign($,$1._`${$} || {}`).code($1._`Object.assign(${$}, ${X})`))}),mergeToName:(Q,X,$)=>Q.if($1._`${$} !== true`,()=>{if(X===!0)Q.assign($,!0);else Q.assign($,$1._`${$} || {}`),OG(Q,$,X)}),mergeValues:(Q,X)=>Q===!0?!0:{...Q,...X},resultToName:Lz}),items:Bz({mergeNames:(Q,X,$)=>Q.if($1._`${$} !== true && ${X} !== undefined`,()=>Q.assign($,$1._`${X} === true ? true : ${$} > ${X} ? ${$} : ${X}`)),mergeToName:(Q,X,$)=>Q.if($1._`${$} !== true`,()=>Q.assign($,X===!0?!0:$1._`${$} > ${X} ? ${$} : ${X}`)),mergeValues:(Q,X)=>Q===!0?!0:Math.max(Q,X),resultToName:(Q,X)=>Q.var("items",X)})};function Lz(Q,X){if(X===!0)return Q.var("props",!0);let $=Q.var("props",$1._`{}`);if(X!==void 0)OG(Q,$,X);return $}Nz.evaluatedPropsToName=Lz;function OG(Q,X,$){Object.keys($).forEach((Y)=>Q.assign($1._`${X}${(0,$1.getProperty)(Y)}`,!0))}Nz.setEvaluated=OG;var Kz={};function sw(Q,X){return Q.scopeValue("func",{ref:X,code:Kz[X.code]||(Kz[X.code]=new pw._Code(X.code))})}Nz.useFunc=sw;var NG;(function(Q){Q[Q.Num=0]="Num",Q[Q.Str=1]="Str"})(NG||(Nz.Type=NG={}));function ew(Q,X,$){if(Q instanceof $1.Name){let Y=X===NG.Num;return $?Y?$1._`"[" + ${Q} + "]"`:$1._`"['" + ${Q} + "']"`:Y?$1._`"/" + ${Q}`:$1._`"/" + ${Q}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return $?(0,$1.getProperty)(Q).toString():"/"+DG(Q)}Nz.getErrorPath=ew;function Fz(Q,X,$=Q.opts.strictSchema){if(!$)return;if(X=`strict mode: ${X}`,$===!0)throw Error(X);Q.self.logger.warn(X)}Nz.checkStrictMode=Fz});var R0=b((Oz)=>{Object.defineProperty(Oz,"__esModule",{value:!0});var P1=c(),Dj={data:new P1.Name("data"),valCxt:new P1.Name("valCxt"),instancePath:new P1.Name("instancePath"),parentData:new P1.Name("parentData"),parentDataProperty:new P1.Name("parentDataProperty"),rootData:new P1.Name("rootData"),dynamicAnchors:new P1.Name("dynamicAnchors"),vErrors:new P1.Name("vErrors"),errors:new P1.Name("errors"),this:new P1.Name("this"),self:new P1.Name("self"),scope:new P1.Name("scope"),json:new P1.Name("json"),jsonPos:new P1.Name("jsonPos"),jsonLen:new P1.Name("jsonLen"),jsonPart:new P1.Name("jsonPart")};Oz.default=Dj});var e4=b((jz)=>{Object.defineProperty(jz,"__esModule",{value:!0});jz.extendErrors=jz.resetErrorsCount=jz.reportExtraError=jz.reportError=jz.keyword$DataError=jz.keywordError=void 0;var t=c(),HQ=a(),k1=R0();jz.keywordError={message:({keyword:Q})=>t.str`must pass "${Q}" keyword validation`};jz.keyword$DataError={message:({keyword:Q,schemaType:X})=>X?t.str`"${Q}" keyword must be ${X} ($data)`:t.str`"${Q}" keyword is invalid ($data)`};function Mj(Q,X=jz.keywordError,$,Y){let{it:G}=Q,{gen:J,compositeRule:W,allErrors:H}=G,z=wz(Q,X,$);if(Y!==null&&Y!==void 0?Y:W||H)Mz(J,z);else Az(G,t._`[${z}]`)}jz.reportError=Mj;function Aj(Q,X=jz.keywordError,$){let{it:Y}=Q,{gen:G,compositeRule:J,allErrors:W}=Y,H=wz(Q,X,$);if(Mz(G,H),!(J||W))Az(Y,k1.default.vErrors)}jz.reportExtraError=Aj;function wj(Q,X){Q.assign(k1.default.errors,X),Q.if(t._`${k1.default.vErrors} !== null`,()=>Q.if(X,()=>Q.assign(t._`${k1.default.vErrors}.length`,X),()=>Q.assign(k1.default.vErrors,null)))}jz.resetErrorsCount=wj;function jj({gen:Q,keyword:X,schemaValue:$,data:Y,errsCount:G,it:J}){if(G===void 0)throw Error("ajv implementation error");let W=Q.name("err");Q.forRange("i",G,k1.default.errors,(H)=>{if(Q.const(W,t._`${k1.default.vErrors}[${H}]`),Q.if(t._`${W}.instancePath === undefined`,()=>Q.assign(t._`${W}.instancePath`,(0,t.strConcat)(k1.default.instancePath,J.errorPath))),Q.assign(t._`${W}.schemaPath`,t.str`${J.errSchemaPath}/${X}`),J.opts.verbose)Q.assign(t._`${W}.schema`,$),Q.assign(t._`${W}.data`,Y)})}jz.extendErrors=jj;function Mz(Q,X){let $=Q.const("err",X);Q.if(t._`${k1.default.vErrors} === null`,()=>Q.assign(k1.default.vErrors,t._`[${$}]`),t._`${k1.default.vErrors}.push(${$})`),Q.code(t._`${k1.default.errors}++`)}function Az(Q,X){let{gen:$,validateName:Y,schemaEnv:G}=Q;if(G.$async)$.throw(t._`new ${Q.ValidationError}(${X})`);else $.assign(t._`${Y}.errors`,X),$.return(!1)}var L6={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function wz(Q,X,$){let{createErrors:Y}=Q.it;if(Y===!1)return t._`{}`;return Ij(Q,X,$)}function Ij(Q,X,$={}){let{gen:Y,it:G}=Q,J=[bj(G,$),Rj(Q,$)];return Ej(Q,X,J),Y.object(...J)}function bj({errorPath:Q},{instancePath:X}){let $=X?t.str`${Q}${(0,HQ.getErrorPath)(X,HQ.Type.Str)}`:Q;return[k1.default.instancePath,(0,t.strConcat)(k1.default.instancePath,$)]}function Rj({keyword:Q,it:{errSchemaPath:X}},{schemaPath:$,parentSchema:Y}){let G=Y?X:t.str`${X}/${Q}`;if($)G=t.str`${G}${(0,HQ.getErrorPath)($,HQ.Type.Str)}`;return[L6.schemaPath,G]}function Ej(Q,{params:X,message:$},Y){let{keyword:G,data:J,schemaValue:W,it:H}=Q,{opts:z,propertyName:B,topSchemaRef:K,schemaPath:q}=H;if(Y.push([L6.keyword,G],[L6.params,typeof X=="function"?X(Q):X||t._`{}`]),z.messages)Y.push([L6.message,typeof $=="function"?$(Q):$]);if(z.verbose)Y.push([L6.schema,W],[L6.parentSchema,t._`${K}${q}`],[k1.default.data,J]);if(B)Y.push([L6.propertyName,B])}});var Pz=b((Rz)=>{Object.defineProperty(Rz,"__esModule",{value:!0});Rz.boolOrEmptySchema=Rz.topBoolOrEmptySchema=void 0;var _j=e4(),kj=c(),vj=R0(),Tj={message:"boolean schema is false"};function xj(Q){let{gen:X,schema:$,validateName:Y}=Q;if($===!1)bz(Q,!1);else if(typeof $=="object"&&$.$async===!0)X.return(vj.default.data);else X.assign(kj._`${Y}.errors`,null),X.return(!0)}Rz.topBoolOrEmptySchema=xj;function yj(Q,X){let{gen:$,schema:Y}=Q;if(Y===!1)$.var(X,!1),bz(Q);else $.var(X,!0)}Rz.boolOrEmptySchema=yj;function bz(Q,X){let{gen:$,data:Y}=Q,G={gen:$,keyword:"false schema",data:Y,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:Q};(0,_j.reportError)(G,Tj,void 0,X)}});var AG=b((Sz)=>{Object.defineProperty(Sz,"__esModule",{value:!0});Sz.getRules=Sz.isJSONType=void 0;var fj=["string","number","integer","boolean","null","object","array"],hj=new Set(fj);function uj(Q){return typeof Q=="string"&&hj.has(Q)}Sz.isJSONType=uj;function lj(){let Q={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...Q,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},Q.number,Q.string,Q.array,Q.object],post:{rules:[]},all:{},keywords:{}}}Sz.getRules=lj});var wG=b((kz)=>{Object.defineProperty(kz,"__esModule",{value:!0});kz.shouldUseRule=kz.shouldUseGroup=kz.schemaHasRulesForType=void 0;function cj({schema:Q,self:X},$){let Y=X.RULES.types[$];return Y&&Y!==!0&&Cz(Q,Y)}kz.schemaHasRulesForType=cj;function Cz(Q,X){return X.rules.some(($)=>_z(Q,$))}kz.shouldUseGroup=Cz;function _z(Q,X){var $;return Q[X.keyword]!==void 0||(($=X.definition.implements)===null||$===void 0?void 0:$.some((Y)=>Q[Y]!==void 0))}kz.shouldUseRule=_z});var Q8=b((gz)=>{Object.defineProperty(gz,"__esModule",{value:!0});gz.reportTypeError=gz.checkDataTypes=gz.checkDataType=gz.coerceAndCheckDataType=gz.getJSONTypes=gz.getSchemaTypes=gz.DataType=void 0;var ij=AG(),nj=wG(),oj=e4(),m=c(),Tz=a(),o6;(function(Q){Q[Q.Correct=0]="Correct",Q[Q.Wrong=1]="Wrong"})(o6||(gz.DataType=o6={}));function rj(Q){let X=xz(Q.type);if(X.includes("null")){if(Q.nullable===!1)throw Error("type: null contradicts nullable: false")}else{if(!X.length&&Q.nullable!==void 0)throw Error('"nullable" cannot be used without "type"');if(Q.nullable===!0)X.push("null")}return X}gz.getSchemaTypes=rj;function xz(Q){let X=Array.isArray(Q)?Q:Q?[Q]:[];if(X.every(ij.isJSONType))return X;throw Error("type must be JSONType or JSONType[]: "+X.join(","))}gz.getJSONTypes=xz;function tj(Q,X){let{gen:$,data:Y,opts:G}=Q,J=aj(X,G.coerceTypes),W=X.length>0&&!(J.length===0&&X.length===1&&(0,nj.schemaHasRulesForType)(Q,X[0]));if(W){let H=IG(X,Y,G.strictNumbers,o6.Wrong);$.if(H,()=>{if(J.length)sj(Q,X,J);else bG(Q)})}return W}gz.coerceAndCheckDataType=tj;var yz=new Set(["string","number","integer","boolean","null"]);function aj(Q,X){return X?Q.filter(($)=>yz.has($)||X==="array"&&$==="array"):[]}function sj(Q,X,$){let{gen:Y,data:G,opts:J}=Q,W=Y.let("dataType",m._`typeof ${G}`),H=Y.let("coerced",m._`undefined`);if(J.coerceTypes==="array")Y.if(m._`${W} == 'object' && Array.isArray(${G}) && ${G}.length == 1`,()=>Y.assign(G,m._`${G}[0]`).assign(W,m._`typeof ${G}`).if(IG(X,G,J.strictNumbers),()=>Y.assign(H,G)));Y.if(m._`${H} !== undefined`);for(let B of $)if(yz.has(B)||B==="array"&&J.coerceTypes==="array")z(B);Y.else(),bG(Q),Y.endIf(),Y.if(m._`${H} !== undefined`,()=>{Y.assign(G,H),ej(Q,H)});function z(B){switch(B){case"string":Y.elseIf(m._`${W} == "number" || ${W} == "boolean"`).assign(H,m._`"" + ${G}`).elseIf(m._`${G} === null`).assign(H,m._`""`);return;case"number":Y.elseIf(m._`${W} == "boolean" || ${G} === null
              || (${W} == "string" && ${G} && ${G} == +${G})`).assign(H,m._`+${G}`);return;case"integer":Y.elseIf(m._`${W} === "boolean" || ${G} === null
              || (${W} === "string" && ${G} && ${G} == +${G} && !(${G} % 1))`).assign(H,m._`+${G}`);return;case"boolean":Y.elseIf(m._`${G} === "false" || ${G} === 0 || ${G} === null`).assign(H,!1).elseIf(m._`${G} === "true" || ${G} === 1`).assign(H,!0);return;case"null":Y.elseIf(m._`${G} === "" || ${G} === 0 || ${G} === false`),Y.assign(H,null);return;case"array":Y.elseIf(m._`${W} === "string" || ${W} === "number"
              || ${W} === "boolean" || ${G} === null`).assign(H,m._`[${G}]`)}}}function ej({gen:Q,parentData:X,parentDataProperty:$},Y){Q.if(m._`${X} !== undefined`,()=>Q.assign(m._`${X}[${$}]`,Y))}function jG(Q,X,$,Y=o6.Correct){let G=Y===o6.Correct?m.operators.EQ:m.operators.NEQ,J;switch(Q){case"null":return m._`${X} ${G} null`;case"array":J=m._`Array.isArray(${X})`;break;case"object":J=m._`${X} && typeof ${X} == "object" && !Array.isArray(${X})`;break;case"integer":J=W(m._`!(${X} % 1) && !isNaN(${X})`);break;case"number":J=W();break;default:return m._`typeof ${X} ${G} ${Q}`}return Y===o6.Correct?J:(0,m.not)(J);function W(H=m.nil){return(0,m.and)(m._`typeof ${X} == "number"`,H,$?m._`isFinite(${X})`:m.nil)}}gz.checkDataType=jG;function IG(Q,X,$,Y){if(Q.length===1)return jG(Q[0],X,$,Y);let G,J=(0,Tz.toHash)(Q);if(J.array&&J.object){let W=m._`typeof ${X} != "object"`;G=J.null?W:m._`!${X} || ${W}`,delete J.null,delete J.array,delete J.object}else G=m.nil;if(J.number)delete J.integer;for(let W in J)G=(0,m.and)(G,jG(W,X,$,Y));return G}gz.checkDataTypes=IG;var QI={message:({schema:Q})=>`must be ${Q}`,params:({schema:Q,schemaValue:X})=>typeof Q=="string"?m._`{type: ${Q}}`:m._`{type: ${X}}`};function bG(Q){let X=XI(Q);(0,oj.reportError)(X,QI)}gz.reportTypeError=bG;function XI(Q){let{gen:X,data:$,schema:Y}=Q,G=(0,Tz.schemaRefOrVal)(Q,Y,"type");return{gen:X,keyword:"type",data:$,schema:Y.type,schemaCode:G,schemaValue:G,parentSchema:Y,params:{},it:Q}}});var mz=b((uz)=>{Object.defineProperty(uz,"__esModule",{value:!0});uz.assignDefaults=void 0;var r6=c(),zI=a();function BI(Q,X){let{properties:$,items:Y}=Q.schema;if(X==="object"&&$)for(let G in $)hz(Q,G,$[G].default);else if(X==="array"&&Array.isArray(Y))Y.forEach((G,J)=>hz(Q,J,G.default))}uz.assignDefaults=BI;function hz(Q,X,$){let{gen:Y,compositeRule:G,data:J,opts:W}=Q;if($===void 0)return;let H=r6._`${J}${(0,r6.getProperty)(X)}`;if(G){(0,zI.checkStrictMode)(Q,`default is ignored for: ${H}`);return}let z=r6._`${H} === undefined`;if(W.useDefaults==="empty")z=r6._`${z} || ${H} === null || ${H} === ""`;Y.if(z,r6._`${H} = ${(0,r6.stringify)($)}`)}});var o1=b((dz)=>{Object.defineProperty(dz,"__esModule",{value:!0});dz.validateUnion=dz.validateArray=dz.usePattern=dz.callValidateCode=dz.schemaProperties=dz.allSchemaProperties=dz.noPropertyInData=dz.propertyInData=dz.isOwnProperty=dz.hasPropFunc=dz.reportMissingProp=dz.checkMissingProp=dz.checkReportMissingProp=void 0;var H1=c(),RG=a(),i0=R0(),KI=a();function VI(Q,X){let{gen:$,data:Y,it:G}=Q;$.if(PG($,Y,X,G.opts.ownProperties),()=>{Q.setParams({missingProperty:H1._`${X}`},!0),Q.error()})}dz.checkReportMissingProp=VI;function qI({gen:Q,data:X,it:{opts:$}},Y,G){return(0,H1.or)(...Y.map((J)=>(0,H1.and)(PG(Q,X,J,$.ownProperties),H1._`${G} = ${J}`)))}dz.checkMissingProp=qI;function UI(Q,X){Q.setParams({missingProperty:X},!0),Q.error()}dz.reportMissingProp=UI;function cz(Q){return Q.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:H1._`Object.prototype.hasOwnProperty`})}dz.hasPropFunc=cz;function EG(Q,X,$){return H1._`${cz(Q)}.call(${X}, ${$})`}dz.isOwnProperty=EG;function LI(Q,X,$,Y){let G=H1._`${X}${(0,H1.getProperty)($)} !== undefined`;return Y?H1._`${G} && ${EG(Q,X,$)}`:G}dz.propertyInData=LI;function PG(Q,X,$,Y){let G=H1._`${X}${(0,H1.getProperty)($)} === undefined`;return Y?(0,H1.or)(G,(0,H1.not)(EG(Q,X,$))):G}dz.noPropertyInData=PG;function pz(Q){return Q?Object.keys(Q).filter((X)=>X!=="__proto__"):[]}dz.allSchemaProperties=pz;function FI(Q,X){return pz(X).filter(($)=>!(0,RG.alwaysValidSchema)(Q,X[$]))}dz.schemaProperties=FI;function NI({schemaCode:Q,data:X,it:{gen:$,topSchemaRef:Y,schemaPath:G,errorPath:J},it:W},H,z,B){let K=B?H1._`${Q}, ${X}, ${Y}${G}`:X,q=[[i0.default.instancePath,(0,H1.strConcat)(i0.default.instancePath,J)],[i0.default.parentData,W.parentData],[i0.default.parentDataProperty,W.parentDataProperty],[i0.default.rootData,i0.default.rootData]];if(W.opts.dynamicRef)q.push([i0.default.dynamicAnchors,i0.default.dynamicAnchors]);let U=H1._`${K}, ${$.object(...q)}`;return z!==H1.nil?H1._`${H}.call(${z}, ${U})`:H1._`${H}(${U})`}dz.callValidateCode=NI;var DI=H1._`new RegExp`;function OI({gen:Q,it:{opts:X}},$){let Y=X.unicodeRegExp?"u":"",{regExp:G}=X.code,J=G($,Y);return Q.scopeValue("pattern",{key:J.toString(),ref:J,code:H1._`${G.code==="new RegExp"?DI:(0,KI.useFunc)(Q,G)}(${$}, ${Y})`})}dz.usePattern=OI;function MI(Q){let{gen:X,data:$,keyword:Y,it:G}=Q,J=X.name("valid");if(G.allErrors){let H=X.let("valid",!0);return W(()=>X.assign(H,!1)),H}return X.var(J,!0),W(()=>X.break()),J;function W(H){let z=X.const("len",H1._`${$}.length`);X.forRange("i",0,z,(B)=>{Q.subschema({keyword:Y,dataProp:B,dataPropType:RG.Type.Num},J),X.if((0,H1.not)(J),H)})}}dz.validateArray=MI;function AI(Q){let{gen:X,schema:$,keyword:Y,it:G}=Q;if(!Array.isArray($))throw Error("ajv implementation error");if($.some((z)=>(0,RG.alwaysValidSchema)(G,z))&&!G.opts.unevaluated)return;let W=X.let("valid",!1),H=X.name("_valid");X.block(()=>$.forEach((z,B)=>{let K=Q.subschema({keyword:Y,schemaProp:B,compositeRule:!0},H);if(X.assign(W,H1._`${W} || ${H}`),!Q.mergeValidEvaluated(K,H))X.if((0,H1.not)(W))})),Q.result(W,()=>Q.reset(),()=>Q.error(!0))}dz.validateUnion=AI});var az=b((rz)=>{Object.defineProperty(rz,"__esModule",{value:!0});rz.validateKeywordUsage=rz.validSchemaType=rz.funcKeywordCode=rz.macroKeywordCode=void 0;var v1=c(),F6=R0(),vI=o1(),TI=e4();function xI(Q,X){let{gen:$,keyword:Y,schema:G,parentSchema:J,it:W}=Q,H=X.macro.call(W.self,G,J,W),z=oz($,Y,H);if(W.opts.validateSchema!==!1)W.self.validateSchema(H,!0);let B=$.name("valid");Q.subschema({schema:H,schemaPath:v1.nil,errSchemaPath:`${W.errSchemaPath}/${Y}`,topSchemaRef:z,compositeRule:!0},B),Q.pass(B,()=>Q.error(!0))}rz.macroKeywordCode=xI;function yI(Q,X){var $;let{gen:Y,keyword:G,schema:J,parentSchema:W,$data:H,it:z}=Q;fI(z,X);let B=!H&&X.compile?X.compile.call(z.self,J,W,z):X.validate,K=oz(Y,G,B),q=Y.let("valid");Q.block$data(q,U),Q.ok(($=X.valid)!==null&&$!==void 0?$:q);function U(){if(X.errors===!1){if(F(),X.modifying)nz(Q);M(()=>Q.error())}else{let O=X.async?V():L();if(X.modifying)nz(Q);M(()=>gI(Q,O))}}function V(){let O=Y.let("ruleErrs",null);return Y.try(()=>F(v1._`await `),(j)=>Y.assign(q,!1).if(v1._`${j} instanceof ${z.ValidationError}`,()=>Y.assign(O,v1._`${j}.errors`),()=>Y.throw(j))),O}function L(){let O=v1._`${K}.errors`;return Y.assign(O,null),F(v1.nil),O}function F(O=X.async?v1._`await `:v1.nil){let j=z.opts.passContext?F6.default.this:F6.default.self,I=!(("compile"in X)&&!H||X.schema===!1);Y.assign(q,v1._`${O}${(0,vI.callValidateCode)(Q,K,j,I)}`,X.modifying)}function M(O){var j;Y.if((0,v1.not)((j=X.valid)!==null&&j!==void 0?j:q),O)}}rz.funcKeywordCode=yI;function nz(Q){let{gen:X,data:$,it:Y}=Q;X.if(Y.parentData,()=>X.assign($,v1._`${Y.parentData}[${Y.parentDataProperty}]`))}function gI(Q,X){let{gen:$}=Q;$.if(v1._`Array.isArray(${X})`,()=>{$.assign(F6.default.vErrors,v1._`${F6.default.vErrors} === null ? ${X} : ${F6.default.vErrors}.concat(${X})`).assign(F6.default.errors,v1._`${F6.default.vErrors}.length`),(0,TI.extendErrors)(Q)},()=>Q.error())}function fI({schemaEnv:Q},X){if(X.async&&!Q.$async)throw Error("async keyword in sync schema")}function oz(Q,X,$){if($===void 0)throw Error(`keyword "${X}" failed to compile`);return Q.scopeValue("keyword",typeof $=="function"?{ref:$}:{ref:$,code:(0,v1.stringify)($)})}function hI(Q,X,$=!1){return!X.length||X.some((Y)=>Y==="array"?Array.isArray(Q):Y==="object"?Q&&typeof Q=="object"&&!Array.isArray(Q):typeof Q==Y||$&&typeof Q>"u")}rz.validSchemaType=hI;function uI({schema:Q,opts:X,self:$,errSchemaPath:Y},G,J){if(Array.isArray(G.keyword)?!G.keyword.includes(J):G.keyword!==J)throw Error("ajv implementation error");let W=G.dependencies;if(W===null||W===void 0?void 0:W.some((H)=>!Object.prototype.hasOwnProperty.call(Q,H)))throw Error(`parent schema must have dependencies of ${J}: ${W.join(",")}`);if(G.validateSchema){if(!G.validateSchema(Q[J])){let z=`keyword "${J}" value is invalid at path "${Y}": `+$.errorsText(G.validateSchema.errors);if(X.validateSchema==="log")$.logger.error(z);else throw Error(z)}}}rz.validateKeywordUsage=uI});var XB=b((ez)=>{Object.defineProperty(ez,"__esModule",{value:!0});ez.extendSubschemaMode=ez.extendSubschemaData=ez.getSubschema=void 0;var K0=c(),sz=a();function pI(Q,{keyword:X,schemaProp:$,schema:Y,schemaPath:G,errSchemaPath:J,topSchemaRef:W}){if(X!==void 0&&Y!==void 0)throw Error('both "keyword" and "schema" passed, only one allowed');if(X!==void 0){let H=Q.schema[X];return $===void 0?{schema:H,schemaPath:K0._`${Q.schemaPath}${(0,K0.getProperty)(X)}`,errSchemaPath:`${Q.errSchemaPath}/${X}`}:{schema:H[$],schemaPath:K0._`${Q.schemaPath}${(0,K0.getProperty)(X)}${(0,K0.getProperty)($)}`,errSchemaPath:`${Q.errSchemaPath}/${X}/${(0,sz.escapeFragment)($)}`}}if(Y!==void 0){if(G===void 0||J===void 0||W===void 0)throw Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:Y,schemaPath:G,topSchemaRef:W,errSchemaPath:J}}throw Error('either "keyword" or "schema" must be passed')}ez.getSubschema=pI;function dI(Q,X,{dataProp:$,dataPropType:Y,data:G,dataTypes:J,propertyName:W}){if(G!==void 0&&$!==void 0)throw Error('both "data" and "dataProp" passed, only one allowed');let{gen:H}=X;if($!==void 0){let{errorPath:B,dataPathArr:K,opts:q}=X,U=H.let("data",K0._`${X.data}${(0,K0.getProperty)($)}`,!0);z(U),Q.errorPath=K0.str`${B}${(0,sz.getErrorPath)($,Y,q.jsPropertySyntax)}`,Q.parentDataProperty=K0._`${$}`,Q.dataPathArr=[...K,Q.parentDataProperty]}if(G!==void 0){let B=G instanceof K0.Name?G:H.let("data",G,!0);if(z(B),W!==void 0)Q.propertyName=W}if(J)Q.dataTypes=J;function z(B){Q.data=B,Q.dataLevel=X.dataLevel+1,Q.dataTypes=[],X.definedProperties=new Set,Q.parentData=X.data,Q.dataNames=[...X.dataNames,B]}}ez.extendSubschemaData=dI;function iI(Q,{jtdDiscriminator:X,jtdMetadata:$,compositeRule:Y,createErrors:G,allErrors:J}){if(Y!==void 0)Q.compositeRule=Y;if(G!==void 0)Q.createErrors=G;if(J!==void 0)Q.allErrors=J;Q.jtdDiscriminator=X,Q.jtdMetadata=$}ez.extendSubschemaMode=iI});var SG=b((Gu,$B)=>{$B.exports=function Q(X,$){if(X===$)return!0;if(X&&$&&typeof X=="object"&&typeof $=="object"){if(X.constructor!==$.constructor)return!1;var Y,G,J;if(Array.isArray(X)){if(Y=X.length,Y!=$.length)return!1;for(G=Y;G--!==0;)if(!Q(X[G],$[G]))return!1;return!0}if(X.constructor===RegExp)return X.source===$.source&&X.flags===$.flags;if(X.valueOf!==Object.prototype.valueOf)return X.valueOf()===$.valueOf();if(X.toString!==Object.prototype.toString)return X.toString()===$.toString();if(J=Object.keys(X),Y=J.length,Y!==Object.keys($).length)return!1;for(G=Y;G--!==0;)if(!Object.prototype.hasOwnProperty.call($,J[G]))return!1;for(G=Y;G--!==0;){var W=J[G];if(!Q(X[W],$[W]))return!1}return!0}return X!==X&&$!==$}});var GB=b((Ju,YB)=>{var n0=YB.exports=function(Q,X,$){if(typeof X=="function")$=X,X={};$=X.cb||$;var Y=typeof $=="function"?$:$.pre||function(){},G=$.post||function(){};zQ(X,Y,G,Q,"",Q)};n0.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};n0.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};n0.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};n0.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function zQ(Q,X,$,Y,G,J,W,H,z,B){if(Y&&typeof Y=="object"&&!Array.isArray(Y)){X(Y,G,J,W,H,z,B);for(var K in Y){var q=Y[K];if(Array.isArray(q)){if(K in n0.arrayKeywords)for(var U=0;U<q.length;U++)zQ(Q,X,$,q[U],G+"/"+K+"/"+U,J,G,K,Y,U)}else if(K in n0.propsKeywords){if(q&&typeof q=="object")for(var V in q)zQ(Q,X,$,q[V],G+"/"+K+"/"+rI(V),J,G,K,Y,V)}else if(K in n0.keywords||Q.allKeys&&!(K in n0.skipKeywords))zQ(Q,X,$,q,G+"/"+K,J,G,K,Y)}$(Y,G,J,W,H,z,B)}}function rI(Q){return Q.replace(/~/g,"~0").replace(/\//g,"~1")}});var X8=b((zB)=>{Object.defineProperty(zB,"__esModule",{value:!0});zB.getSchemaRefs=zB.resolveUrl=zB.normalizeId=zB._getFullPath=zB.getFullPath=zB.inlineRef=void 0;var tI=a(),aI=SG(),sI=GB(),eI=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function Qb(Q,X=!0){if(typeof Q=="boolean")return!0;if(X===!0)return!ZG(Q);if(!X)return!1;return JB(Q)<=X}zB.inlineRef=Qb;var Xb=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function ZG(Q){for(let X in Q){if(Xb.has(X))return!0;let $=Q[X];if(Array.isArray($)&&$.some(ZG))return!0;if(typeof $=="object"&&ZG($))return!0}return!1}function JB(Q){let X=0;for(let $ in Q){if($==="$ref")return 1/0;if(X++,eI.has($))continue;if(typeof Q[$]=="object")(0,tI.eachItem)(Q[$],(Y)=>X+=JB(Y));if(X===1/0)return 1/0}return X}function WB(Q,X="",$){if($!==!1)X=t6(X);let Y=Q.parse(X);return HB(Q,Y)}zB.getFullPath=WB;function HB(Q,X){return Q.serialize(X).split("#")[0]+"#"}zB._getFullPath=HB;var $b=/#\/?$/;function t6(Q){return Q?Q.replace($b,""):""}zB.normalizeId=t6;function Yb(Q,X,$){return $=t6($),Q.resolve(X,$)}zB.resolveUrl=Yb;var Gb=/^[a-z_][-a-z0-9._]*$/i;function Jb(Q,X){if(typeof Q=="boolean")return{};let{schemaId:$,uriResolver:Y}=this.opts,G=t6(Q[$]||X),J={"":G},W=WB(Y,G,!1),H={},z=new Set;return sI(Q,{allKeys:!0},(q,U,V,L)=>{if(L===void 0)return;let F=W+U,M=J[L];if(typeof q[$]=="string")M=O.call(this,q[$]);j.call(this,q.$anchor),j.call(this,q.$dynamicAnchor),J[U]=M;function O(I){let v=this.opts.uriResolver.resolve;if(I=t6(M?v(M,I):I),z.has(I))throw K(I);z.add(I);let k=this.refs[I];if(typeof k=="string")k=this.refs[k];if(typeof k=="object")B(q,k.schema,I);else if(I!==t6(F))if(I[0]==="#")B(q,H[I],I),H[I]=q;else this.refs[I]=F;return I}function j(I){if(typeof I=="string"){if(!Gb.test(I))throw Error(`invalid anchor "${I}"`);O.call(this,`#${I}`)}}}),H;function B(q,U,V){if(U!==void 0&&!aI(q,U))throw K(V)}function K(q){return Error(`reference "${q}" resolves to more than one schema`)}}zB.getSchemaRefs=Jb});var G8=b((bB)=>{Object.defineProperty(bB,"__esModule",{value:!0});bB.getData=bB.KeywordCxt=bB.validateFunctionCode=void 0;var LB=Pz(),KB=Q8(),_G=wG(),BQ=Q8(),Vb=mz(),Y8=az(),CG=XB(),_=c(),h=R0(),qb=X8(),E0=a(),$8=e4();function Ub(Q){if(DB(Q)){if(OB(Q),NB(Q)){Nb(Q);return}}FB(Q,()=>(0,LB.topBoolOrEmptySchema)(Q))}bB.validateFunctionCode=Ub;function FB({gen:Q,validateName:X,schema:$,schemaEnv:Y,opts:G},J){if(G.code.es5)Q.func(X,_._`${h.default.data}, ${h.default.valCxt}`,Y.$async,()=>{Q.code(_._`"use strict"; ${VB($,G)}`),Fb(Q,G),Q.code(J)});else Q.func(X,_._`${h.default.data}, ${Lb(G)}`,Y.$async,()=>Q.code(VB($,G)).code(J))}function Lb(Q){return _._`{${h.default.instancePath}="", ${h.default.parentData}, ${h.default.parentDataProperty}, ${h.default.rootData}=${h.default.data}${Q.dynamicRef?_._`, ${h.default.dynamicAnchors}={}`:_.nil}}={}`}function Fb(Q,X){Q.if(h.default.valCxt,()=>{if(Q.var(h.default.instancePath,_._`${h.default.valCxt}.${h.default.instancePath}`),Q.var(h.default.parentData,_._`${h.default.valCxt}.${h.default.parentData}`),Q.var(h.default.parentDataProperty,_._`${h.default.valCxt}.${h.default.parentDataProperty}`),Q.var(h.default.rootData,_._`${h.default.valCxt}.${h.default.rootData}`),X.dynamicRef)Q.var(h.default.dynamicAnchors,_._`${h.default.valCxt}.${h.default.dynamicAnchors}`)},()=>{if(Q.var(h.default.instancePath,_._`""`),Q.var(h.default.parentData,_._`undefined`),Q.var(h.default.parentDataProperty,_._`undefined`),Q.var(h.default.rootData,h.default.data),X.dynamicRef)Q.var(h.default.dynamicAnchors,_._`{}`)})}function Nb(Q){let{schema:X,opts:$,gen:Y}=Q;FB(Q,()=>{if($.$comment&&X.$comment)AB(Q);if(wb(Q),Y.let(h.default.vErrors,null),Y.let(h.default.errors,0),$.unevaluated)Db(Q);MB(Q),bb(Q)});return}function Db(Q){let{gen:X,validateName:$}=Q;Q.evaluated=X.const("evaluated",_._`${$}.evaluated`),X.if(_._`${Q.evaluated}.dynamicProps`,()=>X.assign(_._`${Q.evaluated}.props`,_._`undefined`)),X.if(_._`${Q.evaluated}.dynamicItems`,()=>X.assign(_._`${Q.evaluated}.items`,_._`undefined`))}function VB(Q,X){let $=typeof Q=="object"&&Q[X.schemaId];return $&&(X.code.source||X.code.process)?_._`/*# sourceURL=${$} */`:_.nil}function Ob(Q,X){if(DB(Q)){if(OB(Q),NB(Q)){Mb(Q,X);return}}(0,LB.boolOrEmptySchema)(Q,X)}function NB({schema:Q,self:X}){if(typeof Q=="boolean")return!Q;for(let $ in Q)if(X.RULES.all[$])return!0;return!1}function DB(Q){return typeof Q.schema!="boolean"}function Mb(Q,X){let{schema:$,gen:Y,opts:G}=Q;if(G.$comment&&$.$comment)AB(Q);jb(Q),Ib(Q);let J=Y.const("_errs",h.default.errors);MB(Q,J),Y.var(X,_._`${J} === ${h.default.errors}`)}function OB(Q){(0,E0.checkUnknownRules)(Q),Ab(Q)}function MB(Q,X){if(Q.opts.jtd)return qB(Q,[],!1,X);let $=(0,KB.getSchemaTypes)(Q.schema),Y=(0,KB.coerceAndCheckDataType)(Q,$);qB(Q,$,!Y,X)}function Ab(Q){let{schema:X,errSchemaPath:$,opts:Y,self:G}=Q;if(X.$ref&&Y.ignoreKeywordsWithRef&&(0,E0.schemaHasRulesButRef)(X,G.RULES))G.logger.warn(`$ref: keywords ignored in schema at path "${$}"`)}function wb(Q){let{schema:X,opts:$}=Q;if(X.default!==void 0&&$.useDefaults&&$.strictSchema)(0,E0.checkStrictMode)(Q,"default is ignored in the schema root")}function jb(Q){let X=Q.schema[Q.opts.schemaId];if(X)Q.baseId=(0,qb.resolveUrl)(Q.opts.uriResolver,Q.baseId,X)}function Ib(Q){if(Q.schema.$async&&!Q.schemaEnv.$async)throw Error("async schema in sync schema")}function AB({gen:Q,schemaEnv:X,schema:$,errSchemaPath:Y,opts:G}){let J=$.$comment;if(G.$comment===!0)Q.code(_._`${h.default.self}.logger.log(${J})`);else if(typeof G.$comment=="function"){let W=_.str`${Y}/$comment`,H=Q.scopeValue("root",{ref:X.root});Q.code(_._`${h.default.self}.opts.$comment(${J}, ${W}, ${H}.schema)`)}}function bb(Q){let{gen:X,schemaEnv:$,validateName:Y,ValidationError:G,opts:J}=Q;if($.$async)X.if(_._`${h.default.errors} === 0`,()=>X.return(h.default.data),()=>X.throw(_._`new ${G}(${h.default.vErrors})`));else{if(X.assign(_._`${Y}.errors`,h.default.vErrors),J.unevaluated)Rb(Q);X.return(_._`${h.default.errors} === 0`)}}function Rb({gen:Q,evaluated:X,props:$,items:Y}){if($ instanceof _.Name)Q.assign(_._`${X}.props`,$);if(Y instanceof _.Name)Q.assign(_._`${X}.items`,Y)}function qB(Q,X,$,Y){let{gen:G,schema:J,data:W,allErrors:H,opts:z,self:B}=Q,{RULES:K}=B;if(J.$ref&&(z.ignoreKeywordsWithRef||!(0,E0.schemaHasRulesButRef)(J,K))){G.block(()=>jB(Q,"$ref",K.all.$ref.definition));return}if(!z.jtd)Eb(Q,X);G.block(()=>{for(let U of K.rules)q(U);q(K.post)});function q(U){if(!(0,_G.shouldUseGroup)(J,U))return;if(U.type){if(G.if((0,BQ.checkDataType)(U.type,W,z.strictNumbers)),UB(Q,U),X.length===1&&X[0]===U.type&&$)G.else(),(0,BQ.reportTypeError)(Q);G.endIf()}else UB(Q,U);if(!H)G.if(_._`${h.default.errors} === ${Y||0}`)}}function UB(Q,X){let{gen:$,schema:Y,opts:{useDefaults:G}}=Q;if(G)(0,Vb.assignDefaults)(Q,X.type);$.block(()=>{for(let J of X.rules)if((0,_G.shouldUseRule)(Y,J))jB(Q,J.keyword,J.definition,X.type)})}function Eb(Q,X){if(Q.schemaEnv.meta||!Q.opts.strictTypes)return;if(Pb(Q,X),!Q.opts.allowUnionTypes)Sb(Q,X);Zb(Q,Q.dataTypes)}function Pb(Q,X){if(!X.length)return;if(!Q.dataTypes.length){Q.dataTypes=X;return}X.forEach(($)=>{if(!wB(Q.dataTypes,$))kG(Q,`type "${$}" not allowed by context "${Q.dataTypes.join(",")}"`)}),_b(Q,X)}function Sb(Q,X){if(X.length>1&&!(X.length===2&&X.includes("null")))kG(Q,"use allowUnionTypes to allow union type keyword")}function Zb(Q,X){let $=Q.self.RULES.all;for(let Y in $){let G=$[Y];if(typeof G=="object"&&(0,_G.shouldUseRule)(Q.schema,G)){let{type:J}=G.definition;if(J.length&&!J.some((W)=>Cb(X,W)))kG(Q,`missing type "${J.join(",")}" for keyword "${Y}"`)}}}function Cb(Q,X){return Q.includes(X)||X==="number"&&Q.includes("integer")}function wB(Q,X){return Q.includes(X)||X==="integer"&&Q.includes("number")}function _b(Q,X){let $=[];for(let Y of Q.dataTypes)if(wB(X,Y))$.push(Y);else if(X.includes("integer")&&Y==="number")$.push("integer");Q.dataTypes=$}function kG(Q,X){let $=Q.schemaEnv.baseId+Q.errSchemaPath;X+=` at "${$}" (strictTypes)`,(0,E0.checkStrictMode)(Q,X,Q.opts.strictTypes)}class vG{constructor(Q,X,$){if((0,Y8.validateKeywordUsage)(Q,X,$),this.gen=Q.gen,this.allErrors=Q.allErrors,this.keyword=$,this.data=Q.data,this.schema=Q.schema[$],this.$data=X.$data&&Q.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,E0.schemaRefOrVal)(Q,this.schema,$,this.$data),this.schemaType=X.schemaType,this.parentSchema=Q.schema,this.params={},this.it=Q,this.def=X,this.$data)this.schemaCode=Q.gen.const("vSchema",IB(this.$data,Q));else if(this.schemaCode=this.schemaValue,!(0,Y8.validSchemaType)(this.schema,X.schemaType,X.allowUndefined))throw Error(`${$} value must be ${JSON.stringify(X.schemaType)}`);if("code"in X?X.trackErrors:X.errors!==!1)this.errsCount=Q.gen.const("_errs",h.default.errors)}result(Q,X,$){this.failResult((0,_.not)(Q),X,$)}failResult(Q,X,$){if(this.gen.if(Q),$)$();else this.error();if(X){if(this.gen.else(),X(),this.allErrors)this.gen.endIf()}else if(this.allErrors)this.gen.endIf();else this.gen.else()}pass(Q,X){this.failResult((0,_.not)(Q),void 0,X)}fail(Q){if(Q===void 0){if(this.error(),!this.allErrors)this.gen.if(!1);return}if(this.gen.if(Q),this.error(),this.allErrors)this.gen.endIf();else this.gen.else()}fail$data(Q){if(!this.$data)return this.fail(Q);let{schemaCode:X}=this;this.fail(_._`${X} !== undefined && (${(0,_.or)(this.invalid$data(),Q)})`)}error(Q,X,$){if(X){this.setParams(X),this._error(Q,$),this.setParams({});return}this._error(Q,$)}_error(Q,X){(Q?$8.reportExtraError:$8.reportError)(this,this.def.error,X)}$dataError(){(0,$8.reportError)(this,this.def.$dataError||$8.keyword$DataError)}reset(){if(this.errsCount===void 0)throw Error('add "trackErrors" to keyword definition');(0,$8.resetErrorsCount)(this.gen,this.errsCount)}ok(Q){if(!this.allErrors)this.gen.if(Q)}setParams(Q,X){if(X)Object.assign(this.params,Q);else this.params=Q}block$data(Q,X,$=_.nil){this.gen.block(()=>{this.check$data(Q,$),X()})}check$data(Q=_.nil,X=_.nil){if(!this.$data)return;let{gen:$,schemaCode:Y,schemaType:G,def:J}=this;if($.if((0,_.or)(_._`${Y} === undefined`,X)),Q!==_.nil)$.assign(Q,!0);if(G.length||J.validateSchema){if($.elseIf(this.invalid$data()),this.$dataError(),Q!==_.nil)$.assign(Q,!1)}$.else()}invalid$data(){let{gen:Q,schemaCode:X,schemaType:$,def:Y,it:G}=this;return(0,_.or)(J(),W());function J(){if($.length){if(!(X instanceof _.Name))throw Error("ajv implementation error");let H=Array.isArray($)?$:[$];return _._`${(0,BQ.checkDataTypes)(H,X,G.opts.strictNumbers,BQ.DataType.Wrong)}`}return _.nil}function W(){if(Y.validateSchema){let H=Q.scopeValue("validate$data",{ref:Y.validateSchema});return _._`!${H}(${X})`}return _.nil}}subschema(Q,X){let $=(0,CG.getSubschema)(this.it,Q);(0,CG.extendSubschemaData)($,this.it,Q),(0,CG.extendSubschemaMode)($,Q);let Y={...this.it,...$,items:void 0,props:void 0};return Ob(Y,X),Y}mergeEvaluated(Q,X){let{it:$,gen:Y}=this;if(!$.opts.unevaluated)return;if($.props!==!0&&Q.props!==void 0)$.props=E0.mergeEvaluated.props(Y,Q.props,$.props,X);if($.items!==!0&&Q.items!==void 0)$.items=E0.mergeEvaluated.items(Y,Q.items,$.items,X)}mergeValidEvaluated(Q,X){let{it:$,gen:Y}=this;if($.opts.unevaluated&&($.props!==!0||$.items!==!0))return Y.if(X,()=>this.mergeEvaluated(Q,_.Name)),!0}}bB.KeywordCxt=vG;function jB(Q,X,$,Y){let G=new vG(Q,$,X);if("code"in $)$.code(G,Y);else if(G.$data&&$.validate)(0,Y8.funcKeywordCode)(G,$);else if("macro"in $)(0,Y8.macroKeywordCode)(G,$);else if($.compile||$.validate)(0,Y8.funcKeywordCode)(G,$)}var kb=/^\/(?:[^~]|~0|~1)*$/,vb=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function IB(Q,{dataLevel:X,dataNames:$,dataPathArr:Y}){let G,J;if(Q==="")return h.default.rootData;if(Q[0]==="/"){if(!kb.test(Q))throw Error(`Invalid JSON-pointer: ${Q}`);G=Q,J=h.default.rootData}else{let B=vb.exec(Q);if(!B)throw Error(`Invalid JSON-pointer: ${Q}`);let K=+B[1];if(G=B[2],G==="#"){if(K>=X)throw Error(z("property/index",K));return Y[X-K]}if(K>X)throw Error(z("data",K));if(J=$[X-K],!G)return J}let W=J,H=G.split("/");for(let B of H)if(B)J=_._`${J}${(0,_.getProperty)((0,E0.unescapeJsonPointer)(B))}`,W=_._`${W} && ${J}`;return W;function z(B,K){return`Cannot access ${B} ${K} levels up, current level is ${X}`}}bB.getData=IB});var KQ=b((PB)=>{Object.defineProperty(PB,"__esModule",{value:!0});class EB extends Error{constructor(Q){super("validation failed");this.errors=Q,this.ajv=this.validation=!0}}PB.default=EB});var J8=b((ZB)=>{Object.defineProperty(ZB,"__esModule",{value:!0});var TG=X8();class SB extends Error{constructor(Q,X,$,Y){super(Y||`can't resolve reference ${$} from id ${X}`);this.missingRef=(0,TG.resolveUrl)(Q,X,$),this.missingSchema=(0,TG.normalizeId)((0,TG.getFullPath)(Q,this.missingRef))}}ZB.default=SB});var qQ=b((kB)=>{Object.defineProperty(kB,"__esModule",{value:!0});kB.resolveSchema=kB.getCompilingSchema=kB.resolveRef=kB.compileSchema=kB.SchemaEnv=void 0;var $0=c(),fb=KQ(),N6=R0(),Y0=X8(),CB=a(),hb=G8();class W8{constructor(Q){var X;this.refs={},this.dynamicAnchors={};let $;if(typeof Q.schema=="object")$=Q.schema;this.schema=Q.schema,this.schemaId=Q.schemaId,this.root=Q.root||this,this.baseId=(X=Q.baseId)!==null&&X!==void 0?X:(0,Y0.normalizeId)($===null||$===void 0?void 0:$[Q.schemaId||"$id"]),this.schemaPath=Q.schemaPath,this.localRefs=Q.localRefs,this.meta=Q.meta,this.$async=$===null||$===void 0?void 0:$.$async,this.refs={}}}kB.SchemaEnv=W8;function yG(Q){let X=_B.call(this,Q);if(X)return X;let $=(0,Y0.getFullPath)(this.opts.uriResolver,Q.root.baseId),{es5:Y,lines:G}=this.opts.code,{ownProperties:J}=this.opts,W=new $0.CodeGen(this.scope,{es5:Y,lines:G,ownProperties:J}),H;if(Q.$async)H=W.scopeValue("Error",{ref:fb.default,code:$0._`require("ajv/dist/runtime/validation_error").default`});let z=W.scopeName("validate");Q.validateName=z;let B={gen:W,allErrors:this.opts.allErrors,data:N6.default.data,parentData:N6.default.parentData,parentDataProperty:N6.default.parentDataProperty,dataNames:[N6.default.data],dataPathArr:[$0.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:W.scopeValue("schema",this.opts.code.source===!0?{ref:Q.schema,code:(0,$0.stringify)(Q.schema)}:{ref:Q.schema}),validateName:z,ValidationError:H,schema:Q.schema,schemaEnv:Q,rootId:$,baseId:Q.baseId||$,schemaPath:$0.nil,errSchemaPath:Q.schemaPath||(this.opts.jtd?"":"#"),errorPath:$0._`""`,opts:this.opts,self:this},K;try{this._compilations.add(Q),(0,hb.validateFunctionCode)(B),W.optimize(this.opts.code.optimize);let q=W.toString();if(K=`${W.scopeRefs(N6.default.scope)}return ${q}`,this.opts.code.process)K=this.opts.code.process(K,Q);let V=Function(`${N6.default.self}`,`${N6.default.scope}`,K)(this,this.scope.get());if(this.scope.value(z,{ref:V}),V.errors=null,V.schema=Q.schema,V.schemaEnv=Q,Q.$async)V.$async=!0;if(this.opts.code.source===!0)V.source={validateName:z,validateCode:q,scopeValues:W._values};if(this.opts.unevaluated){let{props:L,items:F}=B;if(V.evaluated={props:L instanceof $0.Name?void 0:L,items:F instanceof $0.Name?void 0:F,dynamicProps:L instanceof $0.Name,dynamicItems:F instanceof $0.Name},V.source)V.source.evaluated=(0,$0.stringify)(V.evaluated)}return Q.validate=V,Q}catch(q){if(delete Q.validate,delete Q.validateName,K)this.logger.error("Error compiling schema, function code:",K);throw q}finally{this._compilations.delete(Q)}}kB.compileSchema=yG;function ub(Q,X,$){var Y;$=(0,Y0.resolveUrl)(this.opts.uriResolver,X,$);let G=Q.refs[$];if(G)return G;let J=cb.call(this,Q,$);if(J===void 0){let W=(Y=Q.localRefs)===null||Y===void 0?void 0:Y[$],{schemaId:H}=this.opts;if(W)J=new W8({schema:W,schemaId:H,root:Q,baseId:X})}if(J===void 0)return;return Q.refs[$]=lb.call(this,J)}kB.resolveRef=ub;function lb(Q){if((0,Y0.inlineRef)(Q.schema,this.opts.inlineRefs))return Q.schema;return Q.validate?Q:yG.call(this,Q)}function _B(Q){for(let X of this._compilations)if(mb(X,Q))return X}kB.getCompilingSchema=_B;function mb(Q,X){return Q.schema===X.schema&&Q.root===X.root&&Q.baseId===X.baseId}function cb(Q,X){let $;while(typeof($=this.refs[X])=="string")X=$;return $||this.schemas[X]||VQ.call(this,Q,X)}function VQ(Q,X){let $=this.opts.uriResolver.parse(X),Y=(0,Y0._getFullPath)(this.opts.uriResolver,$),G=(0,Y0.getFullPath)(this.opts.uriResolver,Q.baseId,void 0);if(Object.keys(Q.schema).length>0&&Y===G)return xG.call(this,$,Q);let J=(0,Y0.normalizeId)(Y),W=this.refs[J]||this.schemas[J];if(typeof W=="string"){let H=VQ.call(this,Q,W);if(typeof(H===null||H===void 0?void 0:H.schema)!=="object")return;return xG.call(this,$,H)}if(typeof(W===null||W===void 0?void 0:W.schema)!=="object")return;if(!W.validate)yG.call(this,W);if(J===(0,Y0.normalizeId)(X)){let{schema:H}=W,{schemaId:z}=this.opts,B=H[z];if(B)G=(0,Y0.resolveUrl)(this.opts.uriResolver,G,B);return new W8({schema:H,schemaId:z,root:Q,baseId:G})}return xG.call(this,$,W)}kB.resolveSchema=VQ;var pb=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function xG(Q,{baseId:X,schema:$,root:Y}){var G;if(((G=Q.fragment)===null||G===void 0?void 0:G[0])!=="/")return;for(let H of Q.fragment.slice(1).split("/")){if(typeof $==="boolean")return;let z=$[(0,CB.unescapeFragment)(H)];if(z===void 0)return;$=z;let B=typeof $==="object"&&$[this.opts.schemaId];if(!pb.has(H)&&B)X=(0,Y0.resolveUrl)(this.opts.uriResolver,X,B)}let J;if(typeof $!="boolean"&&$.$ref&&!(0,CB.schemaHasRulesButRef)($,this.RULES)){let H=(0,Y0.resolveUrl)(this.opts.uriResolver,X,$.$ref);J=VQ.call(this,Y,H)}let{schemaId:W}=this.opts;if(J=J||new W8({schema:$,schemaId:W,root:Y,baseId:X}),J.schema!==J.root.schema)return J;return}});var TB=b((Vu,rb)=>{rb.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var yB=b((qu,xB)=>{var tb={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};xB.exports={HEX:tb}});var pB=b((Uu,cB)=>{var{HEX:ab}=yB(),sb=/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u;function uB(Q){if(mB(Q,".")<3)return{host:Q,isIPV4:!1};let X=Q.match(sb)||[],[$]=X;if($)return{host:QR($,"."),isIPV4:!0};else return{host:Q,isIPV4:!1}}function gG(Q,X=!1){let $="",Y=!0;for(let G of Q){if(ab[G]===void 0)return;if(G!=="0"&&Y===!0)Y=!1;if(!Y)$+=G}if(X&&$.length===0)$="0";return $}function eb(Q){let X=0,$={error:!1,address:"",zone:""},Y=[],G=[],J=!1,W=!1,H=!1;function z(){if(G.length){if(J===!1){let B=gG(G);if(B!==void 0)Y.push(B);else return $.error=!0,!1}G.length=0}return!0}for(let B=0;B<Q.length;B++){let K=Q[B];if(K==="["||K==="]")continue;if(K===":"){if(W===!0)H=!0;if(!z())break;if(X++,Y.push(":"),X>7){$.error=!0;break}if(B-1>=0&&Q[B-1]===":")W=!0;continue}else if(K==="%"){if(!z())break;J=!0}else{G.push(K);continue}}if(G.length)if(J)$.zone=G.join("");else if(H)Y.push(G.join(""));else Y.push(gG(G));return $.address=Y.join(""),$}function lB(Q){if(mB(Q,":")<2)return{host:Q,isIPV6:!1};let X=eb(Q);if(!X.error){let{address:$,address:Y}=X;if(X.zone)$+="%"+X.zone,Y+="%25"+X.zone;return{host:$,escapedHost:Y,isIPV6:!0}}else return{host:Q,isIPV6:!1}}function QR(Q,X){let $="",Y=!0,G=Q.length;for(let J=0;J<G;J++){let W=Q[J];if(W==="0"&&Y){if(J+1<=G&&Q[J+1]===X||J+1===G)$+=W,Y=!1}else{if(W===X)Y=!0;else Y=!1;$+=W}}return $}function mB(Q,X){let $=0;for(let Y=0;Y<Q.length;Y++)if(Q[Y]===X)$++;return $}var gB=/^\.\.?\//u,fB=/^\/\.(?:\/|$)/u,hB=/^\/\.\.(?:\/|$)/u,XR=/^\/?(?:.|\n)*?(?=\/|$)/u;function $R(Q){let X=[];while(Q.length)if(Q.match(gB))Q=Q.replace(gB,"");else if(Q.match(fB))Q=Q.replace(fB,"/");else if(Q.match(hB))Q=Q.replace(hB,"/"),X.pop();else if(Q==="."||Q==="..")Q="";else{let $=Q.match(XR);if($){let Y=$[0];Q=Q.slice(Y.length),X.push(Y)}else throw Error("Unexpected dot segment condition")}return X.join("")}function YR(Q,X){let $=X!==!0?escape:unescape;if(Q.scheme!==void 0)Q.scheme=$(Q.scheme);if(Q.userinfo!==void 0)Q.userinfo=$(Q.userinfo);if(Q.host!==void 0)Q.host=$(Q.host);if(Q.path!==void 0)Q.path=$(Q.path);if(Q.query!==void 0)Q.query=$(Q.query);if(Q.fragment!==void 0)Q.fragment=$(Q.fragment);return Q}function GR(Q){let X=[];if(Q.userinfo!==void 0)X.push(Q.userinfo),X.push("@");if(Q.host!==void 0){let $=unescape(Q.host),Y=uB($);if(Y.isIPV4)$=Y.host;else{let G=lB(Y.host);if(G.isIPV6===!0)$=`[${G.escapedHost}]`;else $=Q.host}X.push($)}if(typeof Q.port==="number"||typeof Q.port==="string")X.push(":"),X.push(String(Q.port));return X.length?X.join(""):void 0}cB.exports={recomposeAuthority:GR,normalizeComponentEncoding:YR,removeDotSegments:$R,normalizeIPv4:uB,normalizeIPv6:lB,stringArrayToHexStripped:gG}});var tB=b((Lu,rB)=>{var JR=/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu,WR=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu;function dB(Q){return typeof Q.secure==="boolean"?Q.secure:String(Q.scheme).toLowerCase()==="wss"}function iB(Q){if(!Q.host)Q.error=Q.error||"HTTP URIs must have a host.";return Q}function nB(Q){let X=String(Q.scheme).toLowerCase()==="https";if(Q.port===(X?443:80)||Q.port==="")Q.port=void 0;if(!Q.path)Q.path="/";return Q}function HR(Q){return Q.secure=dB(Q),Q.resourceName=(Q.path||"/")+(Q.query?"?"+Q.query:""),Q.path=void 0,Q.query=void 0,Q}function zR(Q){if(Q.port===(dB(Q)?443:80)||Q.port==="")Q.port=void 0;if(typeof Q.secure==="boolean")Q.scheme=Q.secure?"wss":"ws",Q.secure=void 0;if(Q.resourceName){let[X,$]=Q.resourceName.split("?");Q.path=X&&X!=="/"?X:void 0,Q.query=$,Q.resourceName=void 0}return Q.fragment=void 0,Q}function BR(Q,X){if(!Q.path)return Q.error="URN can not be parsed",Q;let $=Q.path.match(WR);if($){let Y=X.scheme||Q.scheme||"urn";Q.nid=$[1].toLowerCase(),Q.nss=$[2];let G=`${Y}:${X.nid||Q.nid}`,J=fG[G];if(Q.path=void 0,J)Q=J.parse(Q,X)}else Q.error=Q.error||"URN can not be parsed.";return Q}function KR(Q,X){let $=X.scheme||Q.scheme||"urn",Y=Q.nid.toLowerCase(),G=`${$}:${X.nid||Y}`,J=fG[G];if(J)Q=J.serialize(Q,X);let W=Q,H=Q.nss;return W.path=`${Y||X.nid}:${H}`,X.skipEscape=!0,W}function VR(Q,X){let $=Q;if($.uuid=$.nss,$.nss=void 0,!X.tolerant&&(!$.uuid||!JR.test($.uuid)))$.error=$.error||"UUID is not valid.";return $}function qR(Q){let X=Q;return X.nss=(Q.uuid||"").toLowerCase(),X}var oB={scheme:"http",domainHost:!0,parse:iB,serialize:nB},UR={scheme:"https",domainHost:oB.domainHost,parse:iB,serialize:nB},UQ={scheme:"ws",domainHost:!0,parse:HR,serialize:zR},LR={scheme:"wss",domainHost:UQ.domainHost,parse:UQ.parse,serialize:UQ.serialize},FR={scheme:"urn",parse:BR,serialize:KR,skipNormalize:!0},NR={scheme:"urn:uuid",parse:VR,serialize:qR,skipNormalize:!0},fG={http:oB,https:UR,ws:UQ,wss:LR,urn:FR,"urn:uuid":NR};rB.exports=fG});var sB=b((Fu,FQ)=>{var{normalizeIPv6:DR,normalizeIPv4:OR,removeDotSegments:H8,recomposeAuthority:MR,normalizeComponentEncoding:LQ}=pB(),hG=tB();function AR(Q,X){if(typeof Q==="string")Q=V0(P0(Q,X),X);else if(typeof Q==="object")Q=P0(V0(Q,X),X);return Q}function wR(Q,X,$){let Y=Object.assign({scheme:"null"},$),G=aB(P0(Q,Y),P0(X,Y),Y,!0);return V0(G,{...Y,skipEscape:!0})}function aB(Q,X,$,Y){let G={};if(!Y)Q=P0(V0(Q,$),$),X=P0(V0(X,$),$);if($=$||{},!$.tolerant&&X.scheme)G.scheme=X.scheme,G.userinfo=X.userinfo,G.host=X.host,G.port=X.port,G.path=H8(X.path||""),G.query=X.query;else{if(X.userinfo!==void 0||X.host!==void 0||X.port!==void 0)G.userinfo=X.userinfo,G.host=X.host,G.port=X.port,G.path=H8(X.path||""),G.query=X.query;else{if(!X.path)if(G.path=Q.path,X.query!==void 0)G.query=X.query;else G.query=Q.query;else{if(X.path.charAt(0)==="/")G.path=H8(X.path);else{if((Q.userinfo!==void 0||Q.host!==void 0||Q.port!==void 0)&&!Q.path)G.path="/"+X.path;else if(!Q.path)G.path=X.path;else G.path=Q.path.slice(0,Q.path.lastIndexOf("/")+1)+X.path;G.path=H8(G.path)}G.query=X.query}G.userinfo=Q.userinfo,G.host=Q.host,G.port=Q.port}G.scheme=Q.scheme}return G.fragment=X.fragment,G}function jR(Q,X,$){if(typeof Q==="string")Q=unescape(Q),Q=V0(LQ(P0(Q,$),!0),{...$,skipEscape:!0});else if(typeof Q==="object")Q=V0(LQ(Q,!0),{...$,skipEscape:!0});if(typeof X==="string")X=unescape(X),X=V0(LQ(P0(X,$),!0),{...$,skipEscape:!0});else if(typeof X==="object")X=V0(LQ(X,!0),{...$,skipEscape:!0});return Q.toLowerCase()===X.toLowerCase()}function V0(Q,X){let $={host:Q.host,scheme:Q.scheme,userinfo:Q.userinfo,port:Q.port,path:Q.path,query:Q.query,nid:Q.nid,nss:Q.nss,uuid:Q.uuid,fragment:Q.fragment,reference:Q.reference,resourceName:Q.resourceName,secure:Q.secure,error:""},Y=Object.assign({},X),G=[],J=hG[(Y.scheme||$.scheme||"").toLowerCase()];if(J&&J.serialize)J.serialize($,Y);if($.path!==void 0)if(!Y.skipEscape){if($.path=escape($.path),$.scheme!==void 0)$.path=$.path.split("%3A").join(":")}else $.path=unescape($.path);if(Y.reference!=="suffix"&&$.scheme)G.push($.scheme,":");let W=MR($);if(W!==void 0){if(Y.reference!=="suffix")G.push("//");if(G.push(W),$.path&&$.path.charAt(0)!=="/")G.push("/")}if($.path!==void 0){let H=$.path;if(!Y.absolutePath&&(!J||!J.absolutePath))H=H8(H);if(W===void 0)H=H.replace(/^\/\//u,"/%2F");G.push(H)}if($.query!==void 0)G.push("?",$.query);if($.fragment!==void 0)G.push("#",$.fragment);return G.join("")}var IR=Array.from({length:127},(Q,X)=>/[^!"$&'()*+,\-.;=_`a-z{}~]/u.test(String.fromCharCode(X)));function bR(Q){let X=0;for(let $=0,Y=Q.length;$<Y;++$)if(X=Q.charCodeAt($),X>126||IR[X])return!0;return!1}var RR=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function P0(Q,X){let $=Object.assign({},X),Y={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},G=Q.indexOf("%")!==-1,J=!1;if($.reference==="suffix")Q=($.scheme?$.scheme+":":"")+"//"+Q;let W=Q.match(RR);if(W){if(Y.scheme=W[1],Y.userinfo=W[3],Y.host=W[4],Y.port=parseInt(W[5],10),Y.path=W[6]||"",Y.query=W[7],Y.fragment=W[8],isNaN(Y.port))Y.port=W[5];if(Y.host){let z=OR(Y.host);if(z.isIPV4===!1){let B=DR(z.host);Y.host=B.host.toLowerCase(),J=B.isIPV6}else Y.host=z.host,J=!0}if(Y.scheme===void 0&&Y.userinfo===void 0&&Y.host===void 0&&Y.port===void 0&&Y.query===void 0&&!Y.path)Y.reference="same-document";else if(Y.scheme===void 0)Y.reference="relative";else if(Y.fragment===void 0)Y.reference="absolute";else Y.reference="uri";if($.reference&&$.reference!=="suffix"&&$.reference!==Y.reference)Y.error=Y.error||"URI is not a "+$.reference+" reference.";let H=hG[($.scheme||Y.scheme||"").toLowerCase()];if(!$.unicodeSupport&&(!H||!H.unicodeSupport)){if(Y.host&&($.domainHost||H&&H.domainHost)&&J===!1&&bR(Y.host))try{Y.host=URL.domainToASCII(Y.host.toLowerCase())}catch(z){Y.error=Y.error||"Host's domain name can not be converted to ASCII: "+z}}if(!H||H&&!H.skipNormalize){if(G&&Y.scheme!==void 0)Y.scheme=unescape(Y.scheme);if(G&&Y.host!==void 0)Y.host=unescape(Y.host);if(Y.path)Y.path=escape(unescape(Y.path));if(Y.fragment)Y.fragment=encodeURI(decodeURIComponent(Y.fragment))}if(H&&H.parse)H.parse(Y,$)}else Y.error=Y.error||"URI can not be parsed.";return Y}var uG={SCHEMES:hG,normalize:AR,resolve:wR,resolveComponents:aB,equal:jR,serialize:V0,parse:P0};FQ.exports=uG;FQ.exports.default=uG;FQ.exports.fastUri=uG});var XK=b((QK)=>{Object.defineProperty(QK,"__esModule",{value:!0});var eB=sB();eB.code='require("ajv/dist/runtime/uri").default';QK.default=eB});var BK=b((S0)=>{Object.defineProperty(S0,"__esModule",{value:!0});S0.CodeGen=S0.Name=S0.nil=S0.stringify=S0.str=S0._=S0.KeywordCxt=void 0;var PR=G8();Object.defineProperty(S0,"KeywordCxt",{enumerable:!0,get:function(){return PR.KeywordCxt}});var a6=c();Object.defineProperty(S0,"_",{enumerable:!0,get:function(){return a6._}});Object.defineProperty(S0,"str",{enumerable:!0,get:function(){return a6.str}});Object.defineProperty(S0,"stringify",{enumerable:!0,get:function(){return a6.stringify}});Object.defineProperty(S0,"nil",{enumerable:!0,get:function(){return a6.nil}});Object.defineProperty(S0,"Name",{enumerable:!0,get:function(){return a6.Name}});Object.defineProperty(S0,"CodeGen",{enumerable:!0,get:function(){return a6.CodeGen}});var SR=KQ(),WK=J8(),ZR=AG(),z8=qQ(),CR=c(),B8=X8(),NQ=Q8(),mG=a(),$K=TB(),_R=XK(),HK=(Q,X)=>new RegExp(Q,X);HK.code="new RegExp";var kR=["removeAdditional","useDefaults","coerceTypes"],vR=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),TR={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},xR={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},YK=200;function yR(Q){var X,$,Y,G,J,W,H,z,B,K,q,U,V,L,F,M,O,j,I,v,k,q1,F1,c1,a0;let U0=Q.strict,s0=(X=Q.code)===null||X===void 0?void 0:X.optimize,Z0=s0===!0||s0===void 0?1:s0||0,e0=(Y=($=Q.code)===null||$===void 0?void 0:$.regExp)!==null&&Y!==void 0?Y:HK,u=(G=Q.uriResolver)!==null&&G!==void 0?G:_R.default;return{strictSchema:(W=(J=Q.strictSchema)!==null&&J!==void 0?J:U0)!==null&&W!==void 0?W:!0,strictNumbers:(z=(H=Q.strictNumbers)!==null&&H!==void 0?H:U0)!==null&&z!==void 0?z:!0,strictTypes:(K=(B=Q.strictTypes)!==null&&B!==void 0?B:U0)!==null&&K!==void 0?K:"log",strictTuples:(U=(q=Q.strictTuples)!==null&&q!==void 0?q:U0)!==null&&U!==void 0?U:"log",strictRequired:(L=(V=Q.strictRequired)!==null&&V!==void 0?V:U0)!==null&&L!==void 0?L:!1,code:Q.code?{...Q.code,optimize:Z0,regExp:e0}:{optimize:Z0,regExp:e0},loopRequired:(F=Q.loopRequired)!==null&&F!==void 0?F:YK,loopEnum:(M=Q.loopEnum)!==null&&M!==void 0?M:YK,meta:(O=Q.meta)!==null&&O!==void 0?O:!0,messages:(j=Q.messages)!==null&&j!==void 0?j:!0,inlineRefs:(I=Q.inlineRefs)!==null&&I!==void 0?I:!0,schemaId:(v=Q.schemaId)!==null&&v!==void 0?v:"$id",addUsedSchema:(k=Q.addUsedSchema)!==null&&k!==void 0?k:!0,validateSchema:(q1=Q.validateSchema)!==null&&q1!==void 0?q1:!0,validateFormats:(F1=Q.validateFormats)!==null&&F1!==void 0?F1:!0,unicodeRegExp:(c1=Q.unicodeRegExp)!==null&&c1!==void 0?c1:!0,int32range:(a0=Q.int32range)!==null&&a0!==void 0?a0:!0,uriResolver:u}}class DQ{constructor(Q={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,Q=this.opts={...Q,...yR(Q)};let{es5:X,lines:$}=this.opts.code;this.scope=new CR.ValueScope({scope:{},prefixes:vR,es5:X,lines:$}),this.logger=mR(Q.logger);let Y=Q.validateFormats;if(Q.validateFormats=!1,this.RULES=(0,ZR.getRules)(),GK.call(this,TR,Q,"NOT SUPPORTED"),GK.call(this,xR,Q,"DEPRECATED","warn"),this._metaOpts=uR.call(this),Q.formats)fR.call(this);if(this._addVocabularies(),this._addDefaultMetaSchema(),Q.keywords)hR.call(this,Q.keywords);if(typeof Q.meta=="object")this.addMetaSchema(Q.meta);gR.call(this),Q.validateFormats=Y}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:Q,meta:X,schemaId:$}=this.opts,Y=$K;if($==="id")Y={...$K},Y.id=Y.$id,delete Y.$id;if(X&&Q)this.addMetaSchema(Y,Y[$],!1)}defaultMeta(){let{meta:Q,schemaId:X}=this.opts;return this.opts.defaultMeta=typeof Q=="object"?Q[X]||Q:void 0}validate(Q,X){let $;if(typeof Q=="string"){if($=this.getSchema(Q),!$)throw Error(`no schema with key or ref "${Q}"`)}else $=this.compile(Q);let Y=$(X);if(!("$async"in $))this.errors=$.errors;return Y}compile(Q,X){let $=this._addSchema(Q,X);return $.validate||this._compileSchemaEnv($)}compileAsync(Q,X){if(typeof this.opts.loadSchema!="function")throw Error("options.loadSchema should be a function");let{loadSchema:$}=this.opts;return Y.call(this,Q,X);async function Y(B,K){await G.call(this,B.$schema);let q=this._addSchema(B,K);return q.validate||J.call(this,q)}async function G(B){if(B&&!this.getSchema(B))await Y.call(this,{$ref:B},!0)}async function J(B){try{return this._compileSchemaEnv(B)}catch(K){if(!(K instanceof WK.default))throw K;return W.call(this,K),await H.call(this,K.missingSchema),J.call(this,B)}}function W({missingSchema:B,missingRef:K}){if(this.refs[B])throw Error(`AnySchema ${B} is loaded but ${K} cannot be resolved`)}async function H(B){let K=await z.call(this,B);if(!this.refs[B])await G.call(this,K.$schema);if(!this.refs[B])this.addSchema(K,B,X)}async function z(B){let K=this._loading[B];if(K)return K;try{return await(this._loading[B]=$(B))}finally{delete this._loading[B]}}}addSchema(Q,X,$,Y=this.opts.validateSchema){if(Array.isArray(Q)){for(let J of Q)this.addSchema(J,void 0,$,Y);return this}let G;if(typeof Q==="object"){let{schemaId:J}=this.opts;if(G=Q[J],G!==void 0&&typeof G!="string")throw Error(`schema ${J} must be string`)}return X=(0,B8.normalizeId)(X||G),this._checkUnique(X),this.schemas[X]=this._addSchema(Q,$,X,Y,!0),this}addMetaSchema(Q,X,$=this.opts.validateSchema){return this.addSchema(Q,X,!0,$),this}validateSchema(Q,X){if(typeof Q=="boolean")return!0;let $;if($=Q.$schema,$!==void 0&&typeof $!="string")throw Error("$schema must be a string");if($=$||this.opts.defaultMeta||this.defaultMeta(),!$)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let Y=this.validate($,Q);if(!Y&&X){let G="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(G);else throw Error(G)}return Y}getSchema(Q){let X;while(typeof(X=JK.call(this,Q))=="string")Q=X;if(X===void 0){let{schemaId:$}=this.opts,Y=new z8.SchemaEnv({schema:{},schemaId:$});if(X=z8.resolveSchema.call(this,Y,Q),!X)return;this.refs[Q]=X}return X.validate||this._compileSchemaEnv(X)}removeSchema(Q){if(Q instanceof RegExp)return this._removeAllSchemas(this.schemas,Q),this._removeAllSchemas(this.refs,Q),this;switch(typeof Q){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let X=JK.call(this,Q);if(typeof X=="object")this._cache.delete(X.schema);return delete this.schemas[Q],delete this.refs[Q],this}case"object":{let X=Q;this._cache.delete(X);let $=Q[this.opts.schemaId];if($)$=(0,B8.normalizeId)($),delete this.schemas[$],delete this.refs[$];return this}default:throw Error("ajv.removeSchema: invalid parameter")}}addVocabulary(Q){for(let X of Q)this.addKeyword(X);return this}addKeyword(Q,X){let $;if(typeof Q=="string"){if($=Q,typeof X=="object")this.logger.warn("these parameters are deprecated, see docs for addKeyword"),X.keyword=$}else if(typeof Q=="object"&&X===void 0){if(X=Q,$=X.keyword,Array.isArray($)&&!$.length)throw Error("addKeywords: keyword must be string or non-empty array")}else throw Error("invalid addKeywords parameters");if(pR.call(this,$,X),!X)return(0,mG.eachItem)($,(G)=>lG.call(this,G)),this;iR.call(this,X);let Y={...X,type:(0,NQ.getJSONTypes)(X.type),schemaType:(0,NQ.getJSONTypes)(X.schemaType)};return(0,mG.eachItem)($,Y.type.length===0?(G)=>lG.call(this,G,Y):(G)=>Y.type.forEach((J)=>lG.call(this,G,Y,J))),this}getKeyword(Q){let X=this.RULES.all[Q];return typeof X=="object"?X.definition:!!X}removeKeyword(Q){let{RULES:X}=this;delete X.keywords[Q],delete X.all[Q];for(let $ of X.rules){let Y=$.rules.findIndex((G)=>G.keyword===Q);if(Y>=0)$.rules.splice(Y,1)}return this}addFormat(Q,X){if(typeof X=="string")X=new RegExp(X);return this.formats[Q]=X,this}errorsText(Q=this.errors,{separator:X=", ",dataVar:$="data"}={}){if(!Q||Q.length===0)return"No errors";return Q.map((Y)=>`${$}${Y.instancePath} ${Y.message}`).reduce((Y,G)=>Y+X+G)}$dataMetaSchema(Q,X){let $=this.RULES.all;Q=JSON.parse(JSON.stringify(Q));for(let Y of X){let G=Y.split("/").slice(1),J=Q;for(let W of G)J=J[W];for(let W in $){let H=$[W];if(typeof H!="object")continue;let{$data:z}=H.definition,B=J[W];if(z&&B)J[W]=zK(B)}}return Q}_removeAllSchemas(Q,X){for(let $ in Q){let Y=Q[$];if(!X||X.test($)){if(typeof Y=="string")delete Q[$];else if(Y&&!Y.meta)this._cache.delete(Y.schema),delete Q[$]}}}_addSchema(Q,X,$,Y=this.opts.validateSchema,G=this.opts.addUsedSchema){let J,{schemaId:W}=this.opts;if(typeof Q=="object")J=Q[W];else if(this.opts.jtd)throw Error("schema must be object");else if(typeof Q!="boolean")throw Error("schema must be object or boolean");let H=this._cache.get(Q);if(H!==void 0)return H;$=(0,B8.normalizeId)(J||$);let z=B8.getSchemaRefs.call(this,Q,$);if(H=new z8.SchemaEnv({schema:Q,schemaId:W,meta:X,baseId:$,localRefs:z}),this._cache.set(H.schema,H),G&&!$.startsWith("#")){if($)this._checkUnique($);this.refs[$]=H}if(Y)this.validateSchema(Q,!0);return H}_checkUnique(Q){if(this.schemas[Q]||this.refs[Q])throw Error(`schema with key or id "${Q}" already exists`)}_compileSchemaEnv(Q){if(Q.meta)this._compileMetaSchema(Q);else z8.compileSchema.call(this,Q);if(!Q.validate)throw Error("ajv implementation error");return Q.validate}_compileMetaSchema(Q){let X=this.opts;this.opts=this._metaOpts;try{z8.compileSchema.call(this,Q)}finally{this.opts=X}}}DQ.ValidationError=SR.default;DQ.MissingRefError=WK.default;S0.default=DQ;function GK(Q,X,$,Y="error"){for(let G in Q){let J=G;if(J in X)this.logger[Y](`${$}: option ${G}. ${Q[J]}`)}}function JK(Q){return Q=(0,B8.normalizeId)(Q),this.schemas[Q]||this.refs[Q]}function gR(){let Q=this.opts.schemas;if(!Q)return;if(Array.isArray(Q))this.addSchema(Q);else for(let X in Q)this.addSchema(Q[X],X)}function fR(){for(let Q in this.opts.formats){let X=this.opts.formats[Q];if(X)this.addFormat(Q,X)}}function hR(Q){if(Array.isArray(Q)){this.addVocabulary(Q);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let X in Q){let $=Q[X];if(!$.keyword)$.keyword=X;this.addKeyword($)}}function uR(){let Q={...this.opts};for(let X of kR)delete Q[X];return Q}var lR={log(){},warn(){},error(){}};function mR(Q){if(Q===!1)return lR;if(Q===void 0)return console;if(Q.log&&Q.warn&&Q.error)return Q;throw Error("logger must implement log, warn and error methods")}var cR=/^[a-z_$][a-z0-9_$:-]*$/i;function pR(Q,X){let{RULES:$}=this;if((0,mG.eachItem)(Q,(Y)=>{if($.keywords[Y])throw Error(`Keyword ${Y} is already defined`);if(!cR.test(Y))throw Error(`Keyword ${Y} has invalid name`)}),!X)return;if(X.$data&&!(("code"in X)||("validate"in X)))throw Error('$data keyword must have "code" or "validate" function')}function lG(Q,X,$){var Y;let G=X===null||X===void 0?void 0:X.post;if($&&G)throw Error('keyword with "post" flag cannot have "type"');let{RULES:J}=this,W=G?J.post:J.rules.find(({type:z})=>z===$);if(!W)W={type:$,rules:[]},J.rules.push(W);if(J.keywords[Q]=!0,!X)return;let H={keyword:Q,definition:{...X,type:(0,NQ.getJSONTypes)(X.type),schemaType:(0,NQ.getJSONTypes)(X.schemaType)}};if(X.before)dR.call(this,W,H,X.before);else W.rules.push(H);J.all[Q]=H,(Y=X.implements)===null||Y===void 0||Y.forEach((z)=>this.addKeyword(z))}function dR(Q,X,$){let Y=Q.rules.findIndex((G)=>G.keyword===$);if(Y>=0)Q.rules.splice(Y,0,X);else Q.rules.push(X),this.logger.warn(`rule ${$} is not defined`)}function iR(Q){let{metaSchema:X}=Q;if(X===void 0)return;if(Q.$data&&this.opts.$data)X=zK(X);Q.validateSchema=this.compile(X,!0)}var nR={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function zK(Q){return{anyOf:[Q,nR]}}});var VK=b((KK)=>{Object.defineProperty(KK,"__esModule",{value:!0});var tR={keyword:"id",code(){throw Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};KK.default=tR});var DK=b((FK)=>{Object.defineProperty(FK,"__esModule",{value:!0});FK.callRef=FK.getValidate=void 0;var sR=J8(),qK=o1(),g1=c(),s6=R0(),UK=qQ(),OQ=a(),eR={keyword:"$ref",schemaType:"string",code(Q){let{gen:X,schema:$,it:Y}=Q,{baseId:G,schemaEnv:J,validateName:W,opts:H,self:z}=Y,{root:B}=J;if(($==="#"||$==="#/")&&G===B.baseId)return q();let K=UK.resolveRef.call(z,B,G,$);if(K===void 0)throw new sR.default(Y.opts.uriResolver,G,$);if(K instanceof UK.SchemaEnv)return U(K);return V(K);function q(){if(J===B)return MQ(Q,W,J,J.$async);let L=X.scopeValue("root",{ref:B});return MQ(Q,g1._`${L}.validate`,B,B.$async)}function U(L){let F=LK(Q,L);MQ(Q,F,L,L.$async)}function V(L){let F=X.scopeValue("schema",H.code.source===!0?{ref:L,code:(0,g1.stringify)(L)}:{ref:L}),M=X.name("valid"),O=Q.subschema({schema:L,dataTypes:[],schemaPath:g1.nil,topSchemaRef:F,errSchemaPath:$},M);Q.mergeEvaluated(O),Q.ok(M)}}};function LK(Q,X){let{gen:$}=Q;return X.validate?$.scopeValue("validate",{ref:X.validate}):g1._`${$.scopeValue("wrapper",{ref:X})}.validate`}FK.getValidate=LK;function MQ(Q,X,$,Y){let{gen:G,it:J}=Q,{allErrors:W,schemaEnv:H,opts:z}=J,B=z.passContext?s6.default.this:g1.nil;if(Y)K();else q();function K(){if(!H.$async)throw Error("async schema referenced by sync schema");let L=G.let("valid");G.try(()=>{if(G.code(g1._`await ${(0,qK.callValidateCode)(Q,X,B)}`),V(X),!W)G.assign(L,!0)},(F)=>{if(G.if(g1._`!(${F} instanceof ${J.ValidationError})`,()=>G.throw(F)),U(F),!W)G.assign(L,!1)}),Q.ok(L)}function q(){Q.result((0,qK.callValidateCode)(Q,X,B),()=>V(X),()=>U(X))}function U(L){let F=g1._`${L}.errors`;G.assign(s6.default.vErrors,g1._`${s6.default.vErrors} === null ? ${F} : ${s6.default.vErrors}.concat(${F})`),G.assign(s6.default.errors,g1._`${s6.default.vErrors}.length`)}function V(L){var F;if(!J.opts.unevaluated)return;let M=(F=$===null||$===void 0?void 0:$.validate)===null||F===void 0?void 0:F.evaluated;if(J.props!==!0)if(M&&!M.dynamicProps){if(M.props!==void 0)J.props=OQ.mergeEvaluated.props(G,M.props,J.props)}else{let O=G.var("props",g1._`${L}.evaluated.props`);J.props=OQ.mergeEvaluated.props(G,O,J.props,g1.Name)}if(J.items!==!0)if(M&&!M.dynamicItems){if(M.items!==void 0)J.items=OQ.mergeEvaluated.items(G,M.items,J.items)}else{let O=G.var("items",g1._`${L}.evaluated.items`);J.items=OQ.mergeEvaluated.items(G,O,J.items,g1.Name)}}}FK.callRef=MQ;FK.default=eR});var MK=b((OK)=>{Object.defineProperty(OK,"__esModule",{value:!0});var $2=VK(),Y2=DK(),G2=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",$2.default,Y2.default];OK.default=G2});var wK=b((AK)=>{Object.defineProperty(AK,"__esModule",{value:!0});var AQ=c(),o0=AQ.operators,wQ={maximum:{okStr:"<=",ok:o0.LTE,fail:o0.GT},minimum:{okStr:">=",ok:o0.GTE,fail:o0.LT},exclusiveMaximum:{okStr:"<",ok:o0.LT,fail:o0.GTE},exclusiveMinimum:{okStr:">",ok:o0.GT,fail:o0.LTE}},W2={message:({keyword:Q,schemaCode:X})=>AQ.str`must be ${wQ[Q].okStr} ${X}`,params:({keyword:Q,schemaCode:X})=>AQ._`{comparison: ${wQ[Q].okStr}, limit: ${X}}`},H2={keyword:Object.keys(wQ),type:"number",schemaType:"number",$data:!0,error:W2,code(Q){let{keyword:X,data:$,schemaCode:Y}=Q;Q.fail$data(AQ._`${$} ${wQ[X].fail} ${Y} || isNaN(${$})`)}};AK.default=H2});var IK=b((jK)=>{Object.defineProperty(jK,"__esModule",{value:!0});var K8=c(),B2={message:({schemaCode:Q})=>K8.str`must be multiple of ${Q}`,params:({schemaCode:Q})=>K8._`{multipleOf: ${Q}}`},K2={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:B2,code(Q){let{gen:X,data:$,schemaCode:Y,it:G}=Q,J=G.opts.multipleOfPrecision,W=X.let("res"),H=J?K8._`Math.abs(Math.round(${W}) - ${W}) > 1e-${J}`:K8._`${W} !== parseInt(${W})`;Q.fail$data(K8._`(${Y} === 0 || (${W} = ${$}/${Y}, ${H}))`)}};jK.default=K2});var EK=b((RK)=>{Object.defineProperty(RK,"__esModule",{value:!0});function bK(Q){let X=Q.length,$=0,Y=0,G;while(Y<X)if($++,G=Q.charCodeAt(Y++),G>=55296&&G<=56319&&Y<X){if(G=Q.charCodeAt(Y),(G&64512)===56320)Y++}return $}RK.default=bK;bK.code='require("ajv/dist/runtime/ucs2length").default'});var SK=b((PK)=>{Object.defineProperty(PK,"__esModule",{value:!0});var D6=c(),U2=a(),L2=EK(),F2={message({keyword:Q,schemaCode:X}){let $=Q==="maxLength"?"more":"fewer";return D6.str`must NOT have ${$} than ${X} characters`},params:({schemaCode:Q})=>D6._`{limit: ${Q}}`},N2={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:F2,code(Q){let{keyword:X,data:$,schemaCode:Y,it:G}=Q,J=X==="maxLength"?D6.operators.GT:D6.operators.LT,W=G.opts.unicode===!1?D6._`${$}.length`:D6._`${(0,U2.useFunc)(Q.gen,L2.default)}(${$})`;Q.fail$data(D6._`${W} ${J} ${Y}`)}};PK.default=N2});var CK=b((ZK)=>{Object.defineProperty(ZK,"__esModule",{value:!0});var O2=o1(),jQ=c(),M2={message:({schemaCode:Q})=>jQ.str`must match pattern "${Q}"`,params:({schemaCode:Q})=>jQ._`{pattern: ${Q}}`},A2={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:M2,code(Q){let{data:X,$data:$,schema:Y,schemaCode:G,it:J}=Q,W=J.opts.unicodeRegExp?"u":"",H=$?jQ._`(new RegExp(${G}, ${W}))`:(0,O2.usePattern)(Q,Y);Q.fail$data(jQ._`!${H}.test(${X})`)}};ZK.default=A2});var kK=b((_K)=>{Object.defineProperty(_K,"__esModule",{value:!0});var V8=c(),j2={message({keyword:Q,schemaCode:X}){let $=Q==="maxProperties"?"more":"fewer";return V8.str`must NOT have ${$} than ${X} properties`},params:({schemaCode:Q})=>V8._`{limit: ${Q}}`},I2={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:j2,code(Q){let{keyword:X,data:$,schemaCode:Y}=Q,G=X==="maxProperties"?V8.operators.GT:V8.operators.LT;Q.fail$data(V8._`Object.keys(${$}).length ${G} ${Y}`)}};_K.default=I2});var TK=b((vK)=>{Object.defineProperty(vK,"__esModule",{value:!0});var q8=o1(),U8=c(),R2=a(),E2={message:({params:{missingProperty:Q}})=>U8.str`must have required property '${Q}'`,params:({params:{missingProperty:Q}})=>U8._`{missingProperty: ${Q}}`},P2={keyword:"required",type:"object",schemaType:"array",$data:!0,error:E2,code(Q){let{gen:X,schema:$,schemaCode:Y,data:G,$data:J,it:W}=Q,{opts:H}=W;if(!J&&$.length===0)return;let z=$.length>=H.loopRequired;if(W.allErrors)B();else K();if(H.strictRequired){let V=Q.parentSchema.properties,{definedProperties:L}=Q.it;for(let F of $)if((V===null||V===void 0?void 0:V[F])===void 0&&!L.has(F)){let M=W.schemaEnv.baseId+W.errSchemaPath,O=`required property "${F}" is not defined at "${M}" (strictRequired)`;(0,R2.checkStrictMode)(W,O,W.opts.strictRequired)}}function B(){if(z||J)Q.block$data(U8.nil,q);else for(let V of $)(0,q8.checkReportMissingProp)(Q,V)}function K(){let V=X.let("missing");if(z||J){let L=X.let("valid",!0);Q.block$data(L,()=>U(V,L)),Q.ok(L)}else X.if((0,q8.checkMissingProp)(Q,$,V)),(0,q8.reportMissingProp)(Q,V),X.else()}function q(){X.forOf("prop",Y,(V)=>{Q.setParams({missingProperty:V}),X.if((0,q8.noPropertyInData)(X,G,V,H.ownProperties),()=>Q.error())})}function U(V,L){Q.setParams({missingProperty:V}),X.forOf(V,Y,()=>{X.assign(L,(0,q8.propertyInData)(X,G,V,H.ownProperties)),X.if((0,U8.not)(L),()=>{Q.error(),X.break()})},U8.nil)}}};vK.default=P2});var yK=b((xK)=>{Object.defineProperty(xK,"__esModule",{value:!0});var L8=c(),Z2={message({keyword:Q,schemaCode:X}){let $=Q==="maxItems"?"more":"fewer";return L8.str`must NOT have ${$} than ${X} items`},params:({schemaCode:Q})=>L8._`{limit: ${Q}}`},C2={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:Z2,code(Q){let{keyword:X,data:$,schemaCode:Y}=Q,G=X==="maxItems"?L8.operators.GT:L8.operators.LT;Q.fail$data(L8._`${$}.length ${G} ${Y}`)}};xK.default=C2});var IQ=b((fK)=>{Object.defineProperty(fK,"__esModule",{value:!0});var gK=SG();gK.code='require("ajv/dist/runtime/equal").default';fK.default=gK});var uK=b((hK)=>{Object.defineProperty(hK,"__esModule",{value:!0});var cG=Q8(),b1=c(),v2=a(),T2=IQ(),x2={message:({params:{i:Q,j:X}})=>b1.str`must NOT have duplicate items (items ## ${X} and ${Q} are identical)`,params:({params:{i:Q,j:X}})=>b1._`{i: ${Q}, j: ${X}}`},y2={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:x2,code(Q){let{gen:X,data:$,$data:Y,schema:G,parentSchema:J,schemaCode:W,it:H}=Q;if(!Y&&!G)return;let z=X.let("valid"),B=J.items?(0,cG.getSchemaTypes)(J.items):[];Q.block$data(z,K,b1._`${W} === false`),Q.ok(z);function K(){let L=X.let("i",b1._`${$}.length`),F=X.let("j");Q.setParams({i:L,j:F}),X.assign(z,!0),X.if(b1._`${L} > 1`,()=>(q()?U:V)(L,F))}function q(){return B.length>0&&!B.some((L)=>L==="object"||L==="array")}function U(L,F){let M=X.name("item"),O=(0,cG.checkDataTypes)(B,M,H.opts.strictNumbers,cG.DataType.Wrong),j=X.const("indices",b1._`{}`);X.for(b1._`;${L}--;`,()=>{if(X.let(M,b1._`${$}[${L}]`),X.if(O,b1._`continue`),B.length>1)X.if(b1._`typeof ${M} == "string"`,b1._`${M} += "_"`);X.if(b1._`typeof ${j}[${M}] == "number"`,()=>{X.assign(F,b1._`${j}[${M}]`),Q.error(),X.assign(z,!1).break()}).code(b1._`${j}[${M}] = ${L}`)})}function V(L,F){let M=(0,v2.useFunc)(X,T2.default),O=X.name("outer");X.label(O).for(b1._`;${L}--;`,()=>X.for(b1._`${F} = ${L}; ${F}--;`,()=>X.if(b1._`${M}(${$}[${L}], ${$}[${F}])`,()=>{Q.error(),X.assign(z,!1).break(O)})))}}};hK.default=y2});var mK=b((lK)=>{Object.defineProperty(lK,"__esModule",{value:!0});var pG=c(),f2=a(),h2=IQ(),u2={message:"must be equal to constant",params:({schemaCode:Q})=>pG._`{allowedValue: ${Q}}`},l2={keyword:"const",$data:!0,error:u2,code(Q){let{gen:X,data:$,$data:Y,schemaCode:G,schema:J}=Q;if(Y||J&&typeof J=="object")Q.fail$data(pG._`!${(0,f2.useFunc)(X,h2.default)}(${$}, ${G})`);else Q.fail(pG._`${J} !== ${$}`)}};lK.default=l2});var pK=b((cK)=>{Object.defineProperty(cK,"__esModule",{value:!0});var F8=c(),c2=a(),p2=IQ(),d2={message:"must be equal to one of the allowed values",params:({schemaCode:Q})=>F8._`{allowedValues: ${Q}}`},i2={keyword:"enum",schemaType:"array",$data:!0,error:d2,code(Q){let{gen:X,data:$,$data:Y,schema:G,schemaCode:J,it:W}=Q;if(!Y&&G.length===0)throw Error("enum must have non-empty array");let H=G.length>=W.opts.loopEnum,z,B=()=>z!==null&&z!==void 0?z:z=(0,c2.useFunc)(X,p2.default),K;if(H||Y)K=X.let("valid"),Q.block$data(K,q);else{if(!Array.isArray(G))throw Error("ajv implementation error");let V=X.const("vSchema",J);K=(0,F8.or)(...G.map((L,F)=>U(V,F)))}Q.pass(K);function q(){X.assign(K,!1),X.forOf("v",J,(V)=>X.if(F8._`${B()}(${$}, ${V})`,()=>X.assign(K,!0).break()))}function U(V,L){let F=G[L];return typeof F==="object"&&F!==null?F8._`${B()}(${$}, ${V}[${L}])`:F8._`${$} === ${F}`}}};cK.default=i2});var iK=b((dK)=>{Object.defineProperty(dK,"__esModule",{value:!0});var o2=wK(),r2=IK(),t2=SK(),a2=CK(),s2=kK(),e2=TK(),QE=yK(),XE=uK(),$E=mK(),YE=pK(),GE=[o2.default,r2.default,t2.default,a2.default,s2.default,e2.default,QE.default,XE.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},$E.default,YE.default];dK.default=GE});var iG=b((oK)=>{Object.defineProperty(oK,"__esModule",{value:!0});oK.validateAdditionalItems=void 0;var O6=c(),dG=a(),WE={message:({params:{len:Q}})=>O6.str`must NOT have more than ${Q} items`,params:({params:{len:Q}})=>O6._`{limit: ${Q}}`},HE={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:WE,code(Q){let{parentSchema:X,it:$}=Q,{items:Y}=X;if(!Array.isArray(Y)){(0,dG.checkStrictMode)($,'"additionalItems" is ignored when "items" is not an array of schemas');return}nK(Q,Y)}};function nK(Q,X){let{gen:$,schema:Y,data:G,keyword:J,it:W}=Q;W.items=!0;let H=$.const("len",O6._`${G}.length`);if(Y===!1)Q.setParams({len:X.length}),Q.pass(O6._`${H} <= ${X.length}`);else if(typeof Y=="object"&&!(0,dG.alwaysValidSchema)(W,Y)){let B=$.var("valid",O6._`${H} <= ${X.length}`);$.if((0,O6.not)(B),()=>z(B)),Q.ok(B)}function z(B){$.forRange("i",X.length,H,(K)=>{if(Q.subschema({keyword:J,dataProp:K,dataPropType:dG.Type.Num},B),!W.allErrors)$.if((0,O6.not)(B),()=>$.break())})}}oK.validateAdditionalItems=nK;oK.default=HE});var nG=b((sK)=>{Object.defineProperty(sK,"__esModule",{value:!0});sK.validateTuple=void 0;var tK=c(),bQ=a(),BE=o1(),KE={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(Q){let{schema:X,it:$}=Q;if(Array.isArray(X))return aK(Q,"additionalItems",X);if($.items=!0,(0,bQ.alwaysValidSchema)($,X))return;Q.ok((0,BE.validateArray)(Q))}};function aK(Q,X,$=Q.schema){let{gen:Y,parentSchema:G,data:J,keyword:W,it:H}=Q;if(K(G),H.opts.unevaluated&&$.length&&H.items!==!0)H.items=bQ.mergeEvaluated.items(Y,$.length,H.items);let z=Y.name("valid"),B=Y.const("len",tK._`${J}.length`);$.forEach((q,U)=>{if((0,bQ.alwaysValidSchema)(H,q))return;Y.if(tK._`${B} > ${U}`,()=>Q.subschema({keyword:W,schemaProp:U,dataProp:U},z)),Q.ok(z)});function K(q){let{opts:U,errSchemaPath:V}=H,L=$.length,F=L===q.minItems&&(L===q.maxItems||q[X]===!1);if(U.strictTuples&&!F){let M=`"${W}" is ${L}-tuple, but minItems or maxItems/${X} are not specified or different at path "${V}"`;(0,bQ.checkStrictMode)(H,M,U.strictTuples)}}}sK.validateTuple=aK;sK.default=KE});var XV=b((QV)=>{Object.defineProperty(QV,"__esModule",{value:!0});var qE=nG(),UE={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:(Q)=>(0,qE.validateTuple)(Q,"items")};QV.default=UE});var GV=b((YV)=>{Object.defineProperty(YV,"__esModule",{value:!0});var $V=c(),FE=a(),NE=o1(),DE=iG(),OE={message:({params:{len:Q}})=>$V.str`must NOT have more than ${Q} items`,params:({params:{len:Q}})=>$V._`{limit: ${Q}}`},ME={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:OE,code(Q){let{schema:X,parentSchema:$,it:Y}=Q,{prefixItems:G}=$;if(Y.items=!0,(0,FE.alwaysValidSchema)(Y,X))return;if(G)(0,DE.validateAdditionalItems)(Q,G);else Q.ok((0,NE.validateArray)(Q))}};YV.default=ME});var WV=b((JV)=>{Object.defineProperty(JV,"__esModule",{value:!0});var r1=c(),RQ=a(),wE={message:({params:{min:Q,max:X}})=>X===void 0?r1.str`must contain at least ${Q} valid item(s)`:r1.str`must contain at least ${Q} and no more than ${X} valid item(s)`,params:({params:{min:Q,max:X}})=>X===void 0?r1._`{minContains: ${Q}}`:r1._`{minContains: ${Q}, maxContains: ${X}}`},jE={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:wE,code(Q){let{gen:X,schema:$,parentSchema:Y,data:G,it:J}=Q,W,H,{minContains:z,maxContains:B}=Y;if(J.opts.next)W=z===void 0?1:z,H=B;else W=1;let K=X.const("len",r1._`${G}.length`);if(Q.setParams({min:W,max:H}),H===void 0&&W===0){(0,RQ.checkStrictMode)(J,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(H!==void 0&&W>H){(0,RQ.checkStrictMode)(J,'"minContains" > "maxContains" is always invalid'),Q.fail();return}if((0,RQ.alwaysValidSchema)(J,$)){let F=r1._`${K} >= ${W}`;if(H!==void 0)F=r1._`${F} && ${K} <= ${H}`;Q.pass(F);return}J.items=!0;let q=X.name("valid");if(H===void 0&&W===1)V(q,()=>X.if(q,()=>X.break()));else if(W===0){if(X.let(q,!0),H!==void 0)X.if(r1._`${G}.length > 0`,U)}else X.let(q,!1),U();Q.result(q,()=>Q.reset());function U(){let F=X.name("_valid"),M=X.let("count",0);V(F,()=>X.if(F,()=>L(M)))}function V(F,M){X.forRange("i",0,K,(O)=>{Q.subschema({keyword:"contains",dataProp:O,dataPropType:RQ.Type.Num,compositeRule:!0},F),M()})}function L(F){if(X.code(r1._`${F}++`),H===void 0)X.if(r1._`${F} >= ${W}`,()=>X.assign(q,!0).break());else if(X.if(r1._`${F} > ${H}`,()=>X.assign(q,!1).break()),W===1)X.assign(q,!0);else X.if(r1._`${F} >= ${W}`,()=>X.assign(q,!0))}}};JV.default=jE});var qV=b((BV)=>{Object.defineProperty(BV,"__esModule",{value:!0});BV.validateSchemaDeps=BV.validatePropertyDeps=BV.error=void 0;var oG=c(),bE=a(),N8=o1();BV.error={message:({params:{property:Q,depsCount:X,deps:$}})=>{let Y=X===1?"property":"properties";return oG.str`must have ${Y} ${$} when property ${Q} is present`},params:({params:{property:Q,depsCount:X,deps:$,missingProperty:Y}})=>oG._`{property: ${Q},
    missingProperty: ${Y},
    depsCount: ${X},
    deps: ${$}}`};var RE={keyword:"dependencies",type:"object",schemaType:"object",error:BV.error,code(Q){let[X,$]=EE(Q);HV(Q,X),zV(Q,$)}};function EE({schema:Q}){let X={},$={};for(let Y in Q){if(Y==="__proto__")continue;let G=Array.isArray(Q[Y])?X:$;G[Y]=Q[Y]}return[X,$]}function HV(Q,X=Q.schema){let{gen:$,data:Y,it:G}=Q;if(Object.keys(X).length===0)return;let J=$.let("missing");for(let W in X){let H=X[W];if(H.length===0)continue;let z=(0,N8.propertyInData)($,Y,W,G.opts.ownProperties);if(Q.setParams({property:W,depsCount:H.length,deps:H.join(", ")}),G.allErrors)$.if(z,()=>{for(let B of H)(0,N8.checkReportMissingProp)(Q,B)});else $.if(oG._`${z} && (${(0,N8.checkMissingProp)(Q,H,J)})`),(0,N8.reportMissingProp)(Q,J),$.else()}}BV.validatePropertyDeps=HV;function zV(Q,X=Q.schema){let{gen:$,data:Y,keyword:G,it:J}=Q,W=$.name("valid");for(let H in X){if((0,bE.alwaysValidSchema)(J,X[H]))continue;$.if((0,N8.propertyInData)($,Y,H,J.opts.ownProperties),()=>{let z=Q.subschema({keyword:G,schemaProp:H},W);Q.mergeValidEvaluated(z,W)},()=>$.var(W,!0)),Q.ok(W)}}BV.validateSchemaDeps=zV;BV.default=RE});var FV=b((LV)=>{Object.defineProperty(LV,"__esModule",{value:!0});var UV=c(),ZE=a(),CE={message:"property name must be valid",params:({params:Q})=>UV._`{propertyName: ${Q.propertyName}}`},_E={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:CE,code(Q){let{gen:X,schema:$,data:Y,it:G}=Q;if((0,ZE.alwaysValidSchema)(G,$))return;let J=X.name("valid");X.forIn("key",Y,(W)=>{Q.setParams({propertyName:W}),Q.subschema({keyword:"propertyNames",data:W,dataTypes:["string"],propertyName:W,compositeRule:!0},J),X.if((0,UV.not)(J),()=>{if(Q.error(!0),!G.allErrors)X.break()})}),Q.ok(J)}};LV.default=_E});var rG=b((NV)=>{Object.defineProperty(NV,"__esModule",{value:!0});var EQ=o1(),G0=c(),vE=R0(),PQ=a(),TE={message:"must NOT have additional properties",params:({params:Q})=>G0._`{additionalProperty: ${Q.additionalProperty}}`},xE={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:TE,code(Q){let{gen:X,schema:$,parentSchema:Y,data:G,errsCount:J,it:W}=Q;if(!J)throw Error("ajv implementation error");let{allErrors:H,opts:z}=W;if(W.props=!0,z.removeAdditional!=="all"&&(0,PQ.alwaysValidSchema)(W,$))return;let B=(0,EQ.allSchemaProperties)(Y.properties),K=(0,EQ.allSchemaProperties)(Y.patternProperties);q(),Q.ok(G0._`${J} === ${vE.default.errors}`);function q(){X.forIn("key",G,(M)=>{if(!B.length&&!K.length)L(M);else X.if(U(M),()=>L(M))})}function U(M){let O;if(B.length>8){let j=(0,PQ.schemaRefOrVal)(W,Y.properties,"properties");O=(0,EQ.isOwnProperty)(X,j,M)}else if(B.length)O=(0,G0.or)(...B.map((j)=>G0._`${M} === ${j}`));else O=G0.nil;if(K.length)O=(0,G0.or)(O,...K.map((j)=>G0._`${(0,EQ.usePattern)(Q,j)}.test(${M})`));return(0,G0.not)(O)}function V(M){X.code(G0._`delete ${G}[${M}]`)}function L(M){if(z.removeAdditional==="all"||z.removeAdditional&&$===!1){V(M);return}if($===!1){if(Q.setParams({additionalProperty:M}),Q.error(),!H)X.break();return}if(typeof $=="object"&&!(0,PQ.alwaysValidSchema)(W,$)){let O=X.name("valid");if(z.removeAdditional==="failing")F(M,O,!1),X.if((0,G0.not)(O),()=>{Q.reset(),V(M)});else if(F(M,O),!H)X.if((0,G0.not)(O),()=>X.break())}}function F(M,O,j){let I={keyword:"additionalProperties",dataProp:M,dataPropType:PQ.Type.Str};if(j===!1)Object.assign(I,{compositeRule:!0,createErrors:!1,allErrors:!1});Q.subschema(I,O)}}};NV.default=xE});var AV=b((MV)=>{Object.defineProperty(MV,"__esModule",{value:!0});var gE=G8(),DV=o1(),tG=a(),OV=rG(),fE={keyword:"properties",type:"object",schemaType:"object",code(Q){let{gen:X,schema:$,parentSchema:Y,data:G,it:J}=Q;if(J.opts.removeAdditional==="all"&&Y.additionalProperties===void 0)OV.default.code(new gE.KeywordCxt(J,OV.default,"additionalProperties"));let W=(0,DV.allSchemaProperties)($);for(let q of W)J.definedProperties.add(q);if(J.opts.unevaluated&&W.length&&J.props!==!0)J.props=tG.mergeEvaluated.props(X,(0,tG.toHash)(W),J.props);let H=W.filter((q)=>!(0,tG.alwaysValidSchema)(J,$[q]));if(H.length===0)return;let z=X.name("valid");for(let q of H){if(B(q))K(q);else{if(X.if((0,DV.propertyInData)(X,G,q,J.opts.ownProperties)),K(q),!J.allErrors)X.else().var(z,!0);X.endIf()}Q.it.definedProperties.add(q),Q.ok(z)}function B(q){return J.opts.useDefaults&&!J.compositeRule&&$[q].default!==void 0}function K(q){Q.subschema({keyword:"properties",schemaProp:q,dataProp:q},z)}}};MV.default=fE});var RV=b((bV)=>{Object.defineProperty(bV,"__esModule",{value:!0});var wV=o1(),SQ=c(),jV=a(),IV=a(),uE={keyword:"patternProperties",type:"object",schemaType:"object",code(Q){let{gen:X,schema:$,data:Y,parentSchema:G,it:J}=Q,{opts:W}=J,H=(0,wV.allSchemaProperties)($),z=H.filter((F)=>(0,jV.alwaysValidSchema)(J,$[F]));if(H.length===0||z.length===H.length&&(!J.opts.unevaluated||J.props===!0))return;let B=W.strictSchema&&!W.allowMatchingProperties&&G.properties,K=X.name("valid");if(J.props!==!0&&!(J.props instanceof SQ.Name))J.props=(0,IV.evaluatedPropsToName)(X,J.props);let{props:q}=J;U();function U(){for(let F of H){if(B)V(F);if(J.allErrors)L(F);else X.var(K,!0),L(F),X.if(K)}}function V(F){for(let M in B)if(new RegExp(F).test(M))(0,jV.checkStrictMode)(J,`property ${M} matches pattern ${F} (use allowMatchingProperties)`)}function L(F){X.forIn("key",Y,(M)=>{X.if(SQ._`${(0,wV.usePattern)(Q,F)}.test(${M})`,()=>{let O=z.includes(F);if(!O)Q.subschema({keyword:"patternProperties",schemaProp:F,dataProp:M,dataPropType:IV.Type.Str},K);if(J.opts.unevaluated&&q!==!0)X.assign(SQ._`${q}[${M}]`,!0);else if(!O&&!J.allErrors)X.if((0,SQ.not)(K),()=>X.break())})})}}};bV.default=uE});var PV=b((EV)=>{Object.defineProperty(EV,"__esModule",{value:!0});var mE=a(),cE={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(Q){let{gen:X,schema:$,it:Y}=Q;if((0,mE.alwaysValidSchema)(Y,$)){Q.fail();return}let G=X.name("valid");Q.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},G),Q.failResult(G,()=>Q.reset(),()=>Q.error())},error:{message:"must NOT be valid"}};EV.default=cE});var ZV=b((SV)=>{Object.defineProperty(SV,"__esModule",{value:!0});var dE=o1(),iE={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:dE.validateUnion,error:{message:"must match a schema in anyOf"}};SV.default=iE});var _V=b((CV)=>{Object.defineProperty(CV,"__esModule",{value:!0});var ZQ=c(),oE=a(),rE={message:"must match exactly one schema in oneOf",params:({params:Q})=>ZQ._`{passingSchemas: ${Q.passing}}`},tE={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:rE,code(Q){let{gen:X,schema:$,parentSchema:Y,it:G}=Q;if(!Array.isArray($))throw Error("ajv implementation error");if(G.opts.discriminator&&Y.discriminator)return;let J=$,W=X.let("valid",!1),H=X.let("passing",null),z=X.name("_valid");Q.setParams({passing:H}),X.block(B),Q.result(W,()=>Q.reset(),()=>Q.error(!0));function B(){J.forEach((K,q)=>{let U;if((0,oE.alwaysValidSchema)(G,K))X.var(z,!0);else U=Q.subschema({keyword:"oneOf",schemaProp:q,compositeRule:!0},z);if(q>0)X.if(ZQ._`${z} && ${W}`).assign(W,!1).assign(H,ZQ._`[${H}, ${q}]`).else();X.if(z,()=>{if(X.assign(W,!0),X.assign(H,q),U)Q.mergeEvaluated(U,ZQ.Name)})})}}};CV.default=tE});var vV=b((kV)=>{Object.defineProperty(kV,"__esModule",{value:!0});var sE=a(),eE={keyword:"allOf",schemaType:"array",code(Q){let{gen:X,schema:$,it:Y}=Q;if(!Array.isArray($))throw Error("ajv implementation error");let G=X.name("valid");$.forEach((J,W)=>{if((0,sE.alwaysValidSchema)(Y,J))return;let H=Q.subschema({keyword:"allOf",schemaProp:W},G);Q.ok(G),Q.mergeEvaluated(H)})}};kV.default=eE});var gV=b((yV)=>{Object.defineProperty(yV,"__esModule",{value:!0});var CQ=c(),xV=a(),XP={message:({params:Q})=>CQ.str`must match "${Q.ifClause}" schema`,params:({params:Q})=>CQ._`{failingKeyword: ${Q.ifClause}}`},$P={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:XP,code(Q){let{gen:X,parentSchema:$,it:Y}=Q;if($.then===void 0&&$.else===void 0)(0,xV.checkStrictMode)(Y,'"if" without "then" and "else" is ignored');let G=TV(Y,"then"),J=TV(Y,"else");if(!G&&!J)return;let W=X.let("valid",!0),H=X.name("_valid");if(z(),Q.reset(),G&&J){let K=X.let("ifClause");Q.setParams({ifClause:K}),X.if(H,B("then",K),B("else",K))}else if(G)X.if(H,B("then"));else X.if((0,CQ.not)(H),B("else"));Q.pass(W,()=>Q.error(!0));function z(){let K=Q.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},H);Q.mergeEvaluated(K)}function B(K,q){return()=>{let U=Q.subschema({keyword:K},H);if(X.assign(W,H),Q.mergeValidEvaluated(U,W),q)X.assign(q,CQ._`${K}`);else Q.setParams({ifClause:K})}}}};function TV(Q,X){let $=Q.schema[X];return $!==void 0&&!(0,xV.alwaysValidSchema)(Q,$)}yV.default=$P});var hV=b((fV)=>{Object.defineProperty(fV,"__esModule",{value:!0});var GP=a(),JP={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:Q,parentSchema:X,it:$}){if(X.if===void 0)(0,GP.checkStrictMode)($,`"${Q}" without "if" is ignored`)}};fV.default=JP});var lV=b((uV)=>{Object.defineProperty(uV,"__esModule",{value:!0});var HP=iG(),zP=XV(),BP=nG(),KP=GV(),VP=WV(),qP=qV(),UP=FV(),LP=rG(),FP=AV(),NP=RV(),DP=PV(),OP=ZV(),MP=_V(),AP=vV(),wP=gV(),jP=hV();function IP(Q=!1){let X=[DP.default,OP.default,MP.default,AP.default,wP.default,jP.default,UP.default,LP.default,qP.default,FP.default,NP.default];if(Q)X.push(zP.default,KP.default);else X.push(HP.default,BP.default);return X.push(VP.default),X}uV.default=IP});var cV=b((mV)=>{Object.defineProperty(mV,"__esModule",{value:!0});var D1=c(),RP={message:({schemaCode:Q})=>D1.str`must match format "${Q}"`,params:({schemaCode:Q})=>D1._`{format: ${Q}}`},EP={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:RP,code(Q,X){let{gen:$,data:Y,$data:G,schema:J,schemaCode:W,it:H}=Q,{opts:z,errSchemaPath:B,schemaEnv:K,self:q}=H;if(!z.validateFormats)return;if(G)U();else V();function U(){let L=$.scopeValue("formats",{ref:q.formats,code:z.code.formats}),F=$.const("fDef",D1._`${L}[${W}]`),M=$.let("fType"),O=$.let("format");$.if(D1._`typeof ${F} == "object" && !(${F} instanceof RegExp)`,()=>$.assign(M,D1._`${F}.type || "string"`).assign(O,D1._`${F}.validate`),()=>$.assign(M,D1._`"string"`).assign(O,F)),Q.fail$data((0,D1.or)(j(),I()));function j(){if(z.strictSchema===!1)return D1.nil;return D1._`${W} && !${O}`}function I(){let v=K.$async?D1._`(${F}.async ? await ${O}(${Y}) : ${O}(${Y}))`:D1._`${O}(${Y})`,k=D1._`(typeof ${O} == "function" ? ${v} : ${O}.test(${Y}))`;return D1._`${O} && ${O} !== true && ${M} === ${X} && !${k}`}}function V(){let L=q.formats[J];if(!L){j();return}if(L===!0)return;let[F,M,O]=I(L);if(F===X)Q.pass(v());function j(){if(z.strictSchema===!1){q.logger.warn(k());return}throw Error(k());function k(){return`unknown format "${J}" ignored in schema at path "${B}"`}}function I(k){let q1=k instanceof RegExp?(0,D1.regexpCode)(k):z.code.formats?D1._`${z.code.formats}${(0,D1.getProperty)(J)}`:void 0,F1=$.scopeValue("formats",{key:J,ref:k,code:q1});if(typeof k=="object"&&!(k instanceof RegExp))return[k.type||"string",k.validate,D1._`${F1}.validate`];return["string",k,F1]}function v(){if(typeof L=="object"&&!(L instanceof RegExp)&&L.async){if(!K.$async)throw Error("async format in sync schema");return D1._`await ${O}(${Y})`}return typeof M=="function"?D1._`${O}(${Y})`:D1._`${O}.test(${Y})`}}}};mV.default=EP});var dV=b((pV)=>{Object.defineProperty(pV,"__esModule",{value:!0});var SP=cV(),ZP=[SP.default];pV.default=ZP});var oV=b((iV)=>{Object.defineProperty(iV,"__esModule",{value:!0});iV.contentVocabulary=iV.metadataVocabulary=void 0;iV.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];iV.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var aV=b((tV)=>{Object.defineProperty(tV,"__esModule",{value:!0});var kP=MK(),vP=iK(),TP=lV(),xP=dV(),rV=oV(),yP=[kP.default,vP.default,(0,TP.default)(),xP.default,rV.metadataVocabulary,rV.contentVocabulary];tV.default=yP});var Xq=b((eV)=>{Object.defineProperty(eV,"__esModule",{value:!0});eV.DiscrError=void 0;var sV;(function(Q){Q.Tag="tag",Q.Mapping="mapping"})(sV||(eV.DiscrError=sV={}))});var Gq=b((Yq)=>{Object.defineProperty(Yq,"__esModule",{value:!0});var e6=c(),aG=Xq(),$q=qQ(),fP=J8(),hP=a(),uP={message:({params:{discrError:Q,tagName:X}})=>Q===aG.DiscrError.Tag?`tag "${X}" must be string`:`value of tag "${X}" must be in oneOf`,params:({params:{discrError:Q,tag:X,tagName:$}})=>e6._`{error: ${Q}, tag: ${$}, tagValue: ${X}}`},lP={keyword:"discriminator",type:"object",schemaType:"object",error:uP,code(Q){let{gen:X,data:$,schema:Y,parentSchema:G,it:J}=Q,{oneOf:W}=G;if(!J.opts.discriminator)throw Error("discriminator: requires discriminator option");let H=Y.propertyName;if(typeof H!="string")throw Error("discriminator: requires propertyName");if(Y.mapping)throw Error("discriminator: mapping is not supported");if(!W)throw Error("discriminator: requires oneOf keyword");let z=X.let("valid",!1),B=X.const("tag",e6._`${$}${(0,e6.getProperty)(H)}`);X.if(e6._`typeof ${B} == "string"`,()=>K(),()=>Q.error(!1,{discrError:aG.DiscrError.Tag,tag:B,tagName:H})),Q.ok(z);function K(){let V=U();X.if(!1);for(let L in V)X.elseIf(e6._`${B} === ${L}`),X.assign(z,q(V[L]));X.else(),Q.error(!1,{discrError:aG.DiscrError.Mapping,tag:B,tagName:H}),X.endIf()}function q(V){let L=X.name("valid"),F=Q.subschema({keyword:"oneOf",schemaProp:V},L);return Q.mergeEvaluated(F,e6.Name),L}function U(){var V;let L={},F=O(G),M=!0;for(let v=0;v<W.length;v++){let k=W[v];if((k===null||k===void 0?void 0:k.$ref)&&!(0,hP.schemaHasRulesButRef)(k,J.self.RULES)){let F1=k.$ref;if(k=$q.resolveRef.call(J.self,J.schemaEnv.root,J.baseId,F1),k instanceof $q.SchemaEnv)k=k.schema;if(k===void 0)throw new fP.default(J.opts.uriResolver,J.baseId,F1)}let q1=(V=k===null||k===void 0?void 0:k.properties)===null||V===void 0?void 0:V[H];if(typeof q1!="object")throw Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${H}"`);M=M&&(F||O(k)),j(q1,v)}if(!M)throw Error(`discriminator: "${H}" must be required`);return L;function O({required:v}){return Array.isArray(v)&&v.includes(H)}function j(v,k){if(v.const)I(v.const,k);else if(v.enum)for(let q1 of v.enum)I(q1,k);else throw Error(`discriminator: "properties/${H}" must have "const" or "enum"`)}function I(v,k){if(typeof v!="string"||v in L)throw Error(`discriminator: "${H}" values must be unique strings`);L[v]=k}}}};Yq.default=lP});var Jq=b((Bl,cP)=>{cP.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var eG=b((f1,sG)=>{Object.defineProperty(f1,"__esModule",{value:!0});f1.MissingRefError=f1.ValidationError=f1.CodeGen=f1.Name=f1.nil=f1.stringify=f1.str=f1._=f1.KeywordCxt=f1.Ajv=void 0;var pP=BK(),dP=aV(),iP=Gq(),Wq=Jq(),nP=["/properties"],_Q="http://json-schema.org/draft-07/schema";class D8 extends pP.default{_addVocabularies(){if(super._addVocabularies(),dP.default.forEach((Q)=>this.addVocabulary(Q)),this.opts.discriminator)this.addKeyword(iP.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let Q=this.opts.$data?this.$dataMetaSchema(Wq,nP):Wq;this.addMetaSchema(Q,_Q,!1),this.refs["http://json-schema.org/schema"]=_Q}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(_Q)?_Q:void 0)}}f1.Ajv=D8;sG.exports=f1=D8;sG.exports.Ajv=D8;Object.defineProperty(f1,"__esModule",{value:!0});f1.default=D8;var oP=G8();Object.defineProperty(f1,"KeywordCxt",{enumerable:!0,get:function(){return oP.KeywordCxt}});var Q4=c();Object.defineProperty(f1,"_",{enumerable:!0,get:function(){return Q4._}});Object.defineProperty(f1,"str",{enumerable:!0,get:function(){return Q4.str}});Object.defineProperty(f1,"stringify",{enumerable:!0,get:function(){return Q4.stringify}});Object.defineProperty(f1,"nil",{enumerable:!0,get:function(){return Q4.nil}});Object.defineProperty(f1,"Name",{enumerable:!0,get:function(){return Q4.Name}});Object.defineProperty(f1,"CodeGen",{enumerable:!0,get:function(){return Q4.CodeGen}});var rP=KQ();Object.defineProperty(f1,"ValidationError",{enumerable:!0,get:function(){return rP.default}});var tP=J8();Object.defineProperty(f1,"MissingRefError",{enumerable:!0,get:function(){return tP.default}})});var Nq=b((Lq)=>{Object.defineProperty(Lq,"__esModule",{value:!0});Lq.formatNames=Lq.fastFormats=Lq.fullFormats=void 0;function q0(Q,X){return{validate:Q,compare:X}}Lq.fullFormats={date:q0(Kq,Y7),time:q0(X7(!0),G7),"date-time":q0(Hq(!0),qq),"iso-time":q0(X7(),Vq),"iso-date-time":q0(Hq(),Uq),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:GS,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:VS,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:JS,int32:{type:"number",validate:zS},int64:{type:"number",validate:BS},float:{type:"number",validate:Bq},double:{type:"number",validate:Bq},password:!0,binary:!0};Lq.fastFormats={...Lq.fullFormats,date:q0(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,Y7),time:q0(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,G7),"date-time":q0(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,qq),"iso-time":q0(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,Vq),"iso-date-time":q0(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,Uq),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};Lq.formatNames=Object.keys(Lq.fullFormats);function eP(Q){return Q%4===0&&(Q%100!==0||Q%400===0)}var QS=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,XS=[0,31,28,31,30,31,30,31,31,30,31,30,31];function Kq(Q){let X=QS.exec(Q);if(!X)return!1;let $=+X[1],Y=+X[2],G=+X[3];return Y>=1&&Y<=12&&G>=1&&G<=(Y===2&&eP($)?29:XS[Y])}function Y7(Q,X){if(!(Q&&X))return;if(Q>X)return 1;if(Q<X)return-1;return 0}var Q7=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function X7(Q){return function($){let Y=Q7.exec($);if(!Y)return!1;let G=+Y[1],J=+Y[2],W=+Y[3],H=Y[4],z=Y[5]==="-"?-1:1,B=+(Y[6]||0),K=+(Y[7]||0);if(B>23||K>59||Q&&!H)return!1;if(G<=23&&J<=59&&W<60)return!0;let q=J-K*z,U=G-B*z-(q<0?1:0);return(U===23||U===-1)&&(q===59||q===-1)&&W<61}}function G7(Q,X){if(!(Q&&X))return;let $=new Date("2020-01-01T"+Q).valueOf(),Y=new Date("2020-01-01T"+X).valueOf();if(!($&&Y))return;return $-Y}function Vq(Q,X){if(!(Q&&X))return;let $=Q7.exec(Q),Y=Q7.exec(X);if(!($&&Y))return;if(Q=$[1]+$[2]+$[3],X=Y[1]+Y[2]+Y[3],Q>X)return 1;if(Q<X)return-1;return 0}var $7=/t|\s/i;function Hq(Q){let X=X7(Q);return function(Y){let G=Y.split($7);return G.length===2&&Kq(G[0])&&X(G[1])}}function qq(Q,X){if(!(Q&&X))return;let $=new Date(Q).valueOf(),Y=new Date(X).valueOf();if(!($&&Y))return;return $-Y}function Uq(Q,X){if(!(Q&&X))return;let[$,Y]=Q.split($7),[G,J]=X.split($7),W=Y7($,G);if(W===void 0)return;return W||G7(Y,J)}var $S=/\/|:/,YS=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function GS(Q){return $S.test(Q)&&YS.test(Q)}var zq=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function JS(Q){return zq.lastIndex=0,zq.test(Q)}var WS=-2147483648,HS=2147483647;function zS(Q){return Number.isInteger(Q)&&Q<=HS&&Q>=WS}function BS(Q){return Number.isInteger(Q)}function Bq(){return!0}var KS=/[^\\]\\Z/;function VS(Q){if(KS.test(Q))return!1;try{return new RegExp(Q),!0}catch(X){return!1}}});var Oq=b((Dq)=>{Object.defineProperty(Dq,"__esModule",{value:!0});Dq.formatLimitDefinition=void 0;var US=eG(),J0=c(),r0=J0.operators,kQ={formatMaximum:{okStr:"<=",ok:r0.LTE,fail:r0.GT},formatMinimum:{okStr:">=",ok:r0.GTE,fail:r0.LT},formatExclusiveMaximum:{okStr:"<",ok:r0.LT,fail:r0.GTE},formatExclusiveMinimum:{okStr:">",ok:r0.GT,fail:r0.LTE}},LS={message:({keyword:Q,schemaCode:X})=>J0.str`should be ${kQ[Q].okStr} ${X}`,params:({keyword:Q,schemaCode:X})=>J0._`{comparison: ${kQ[Q].okStr}, limit: ${X}}`};Dq.formatLimitDefinition={keyword:Object.keys(kQ),type:"string",schemaType:"string",$data:!0,error:LS,code(Q){let{gen:X,data:$,schemaCode:Y,keyword:G,it:J}=Q,{opts:W,self:H}=J;if(!W.validateFormats)return;let z=new US.KeywordCxt(J,H.RULES.all.format.definition,"format");if(z.$data)B();else K();function B(){let U=X.scopeValue("formats",{ref:H.formats,code:W.code.formats}),V=X.const("fmt",J0._`${U}[${z.schemaCode}]`);Q.fail$data((0,J0.or)(J0._`typeof ${V} != "object"`,J0._`${V} instanceof RegExp`,J0._`typeof ${V}.compare != "function"`,q(V)))}function K(){let U=z.schema,V=H.formats[U];if(!V||V===!0)return;if(typeof V!="object"||V instanceof RegExp||typeof V.compare!="function")throw Error(`"${G}": format "${U}" does not define "compare" function`);let L=X.scopeValue("formats",{key:U,ref:V,code:W.code.formats?J0._`${W.code.formats}${(0,J0.getProperty)(U)}`:void 0});Q.fail$data(q(L))}function q(U){return J0._`${U}.compare(${$}, ${Y}) ${kQ[G].fail} 0`}},dependencies:["format"]};var FS=(Q)=>{return Q.addKeyword(Dq.formatLimitDefinition),Q};Dq.default=FS});var jq=b((O8,wq)=>{Object.defineProperty(O8,"__esModule",{value:!0});var X4=Nq(),DS=Oq(),H7=c(),Mq=new H7.Name("fullFormats"),OS=new H7.Name("fastFormats"),z7=(Q,X={keywords:!0})=>{if(Array.isArray(X))return Aq(Q,X,X4.fullFormats,Mq),Q;let[$,Y]=X.mode==="fast"?[X4.fastFormats,OS]:[X4.fullFormats,Mq],G=X.formats||X4.formatNames;if(Aq(Q,G,$,Y),X.keywords)(0,DS.default)(Q);return Q};z7.get=(Q,X="full")=>{let Y=(X==="fast"?X4.fastFormats:X4.fullFormats)[Q];if(!Y)throw Error(`Unknown format "${Q}"`);return Y};function Aq(Q,X,$,Y){var G,J;(G=(J=Q.opts.code).formats)!==null&&G!==void 0||(J.formats=H7._`require("ajv-formats/dist/formats").${Y}`);for(let W of X)Q.addFormat(W,$[W])}wq.exports=O8=z7;Object.defineProperty(O8,"__esModule",{value:!0});O8.default=z7});import{setMaxListeners as aq}from"events";var sq=50;function w6(Q=sq){let X=new AbortController;return aq(Q,X.signal),X}import{spawn as cL}from"child_process";import{createInterface as pL}from"readline";import*as f from"fs";import{stat as EL,readdir as PL,readFile as q5,unlink as SL,rmdir as ZL,rm as CL,mkdir as _L,rename as kL,open as vL}from"fs/promises";var eq=typeof global=="object"&&global&&global.Object===Object&&global,j7=eq;var QU=typeof self=="object"&&self&&self.Object===Object&&self,XU=j7||QU||Function("return this")(),j6=XU;var $U=j6.Symbol,I6=$U;var I7=Object.prototype,YU=I7.hasOwnProperty,GU=I7.toString,G4=I6?I6.toStringTag:void 0;function JU(Q){var X=YU.call(Q,G4),$=Q[G4];try{Q[G4]=void 0;var Y=!0}catch(J){}var G=GU.call(Q);if(Y)if(X)Q[G4]=$;else delete Q[G4];return G}var b7=JU;var WU=Object.prototype,HU=WU.toString;function zU(Q){return HU.call(Q)}var R7=zU;var BU="[object Null]",KU="[object Undefined]",E7=I6?I6.toStringTag:void 0;function VU(Q){if(Q==null)return Q===void 0?KU:BU;return E7&&E7 in Object(Q)?b7(Q):R7(Q)}var P7=VU;function qU(Q){var X=typeof Q;return Q!=null&&(X=="object"||X=="function")}var R8=qU;var UU="[object AsyncFunction]",LU="[object Function]",FU="[object GeneratorFunction]",NU="[object Proxy]";function DU(Q){if(!R8(Q))return!1;var X=P7(Q);return X==LU||X==FU||X==UU||X==NU}var S7=DU;var OU=j6["__core-js_shared__"],E8=OU;var Z7=function(){var Q=/[^.]+$/.exec(E8&&E8.keys&&E8.keys.IE_PROTO||"");return Q?"Symbol(src)_1."+Q:""}();function MU(Q){return!!Z7&&Z7 in Q}var C7=MU;var AU=Function.prototype,wU=AU.toString;function jU(Q){if(Q!=null){try{return wU.call(Q)}catch(X){}try{return Q+""}catch(X){}}return""}var _7=jU;var IU=/[\\^$.*+?()[\]{}|]/g,bU=/^\[object .+?Constructor\]$/,RU=Function.prototype,EU=Object.prototype,PU=RU.toString,SU=EU.hasOwnProperty,ZU=RegExp("^"+PU.call(SU).replace(IU,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function CU(Q){if(!R8(Q)||C7(Q))return!1;var X=S7(Q)?ZU:bU;return X.test(_7(Q))}var k7=CU;function _U(Q,X){return Q==null?void 0:Q[X]}var v7=_U;function kU(Q,X){var $=v7(Q,X);return k7($)?$:void 0}var P8=kU;var vU=P8(Object,"create"),F0=vU;function TU(){this.__data__=F0?F0(null):{},this.size=0}var T7=TU;function xU(Q){var X=this.has(Q)&&delete this.__data__[Q];return this.size-=X?1:0,X}var x7=xU;var yU="__lodash_hash_undefined__",gU=Object.prototype,fU=gU.hasOwnProperty;function hU(Q){var X=this.__data__;if(F0){var $=X[Q];return $===yU?void 0:$}return fU.call(X,Q)?X[Q]:void 0}var y7=hU;var uU=Object.prototype,lU=uU.hasOwnProperty;function mU(Q){var X=this.__data__;return F0?X[Q]!==void 0:lU.call(X,Q)}var g7=mU;var cU="__lodash_hash_undefined__";function pU(Q,X){var $=this.__data__;return this.size+=this.has(Q)?0:1,$[Q]=F0&&X===void 0?cU:X,this}var f7=pU;function b6(Q){var X=-1,$=Q==null?0:Q.length;this.clear();while(++X<$){var Y=Q[X];this.set(Y[0],Y[1])}}b6.prototype.clear=T7;b6.prototype.delete=x7;b6.prototype.get=y7;b6.prototype.has=g7;b6.prototype.set=f7;var yQ=b6;function dU(){this.__data__=[],this.size=0}var h7=dU;function iU(Q,X){return Q===X||Q!==Q&&X!==X}var u7=iU;function nU(Q,X){var $=Q.length;while($--)if(u7(Q[$][0],X))return $;return-1}var _0=nU;var oU=Array.prototype,rU=oU.splice;function tU(Q){var X=this.__data__,$=_0(X,Q);if($<0)return!1;var Y=X.length-1;if($==Y)X.pop();else rU.call(X,$,1);return--this.size,!0}var l7=tU;function aU(Q){var X=this.__data__,$=_0(X,Q);return $<0?void 0:X[$][1]}var m7=aU;function sU(Q){return _0(this.__data__,Q)>-1}var c7=sU;function eU(Q,X){var $=this.__data__,Y=_0($,Q);if(Y<0)++this.size,$.push([Q,X]);else $[Y][1]=X;return this}var p7=eU;function R6(Q){var X=-1,$=Q==null?0:Q.length;this.clear();while(++X<$){var Y=Q[X];this.set(Y[0],Y[1])}}R6.prototype.clear=h7;R6.prototype.delete=l7;R6.prototype.get=m7;R6.prototype.has=c7;R6.prototype.set=p7;var d7=R6;var QL=P8(j6,"Map"),i7=QL;function XL(){this.size=0,this.__data__={hash:new yQ,map:new(i7||d7),string:new yQ}}var n7=XL;function $L(Q){var X=typeof Q;return X=="string"||X=="number"||X=="symbol"||X=="boolean"?Q!=="__proto__":Q===null}var o7=$L;function YL(Q,X){var $=Q.__data__;return o7(X)?$[typeof X=="string"?"string":"hash"]:$.map}var k0=YL;function GL(Q){var X=k0(this,Q).delete(Q);return this.size-=X?1:0,X}var r7=GL;function JL(Q){return k0(this,Q).get(Q)}var t7=JL;function WL(Q){return k0(this,Q).has(Q)}var a7=WL;function HL(Q,X){var $=k0(this,Q),Y=$.size;return $.set(Q,X),this.size+=$.size==Y?0:1,this}var s7=HL;function E6(Q){var X=-1,$=Q==null?0:Q.length;this.clear();while(++X<$){var Y=Q[X];this.set(Y[0],Y[1])}}E6.prototype.clear=n7;E6.prototype.delete=r7;E6.prototype.get=t7;E6.prototype.has=a7;E6.prototype.set=s7;var gQ=E6;var zL="Expected a function";function fQ(Q,X){if(typeof Q!="function"||X!=null&&typeof X!="function")throw TypeError(zL);var $=function(){var Y=arguments,G=X?X.apply(this,Y):Y[0],J=$.cache;if(J.has(G))return J.get(G);var W=Q.apply(this,Y);return $.cache=J.set(G,W)||J,W};return $.cache=new(fQ.Cache||gQ),$}fQ.Cache=gQ;var v0=fQ;function BL(Q,X){if(Q.destroyed)return;Q.write(X)}function e7(Q){BL(process.stderr,Q)}var Q5=v0((Q)=>{if(!Q||Q.trim()==="")return null;let X=Q.split(",").map((J)=>J.trim()).filter(Boolean);if(X.length===0)return null;let $=X.some((J)=>J.startsWith("!")),Y=X.some((J)=>!J.startsWith("!"));if($&&Y)return null;let G=X.map((J)=>J.replace(/^!/,"").toLowerCase());return{include:$?[]:G,exclude:$?G:[],isExclusive:$}});function KL(Q){let X=[],$=Q.match(/^MCP server ["']([^"']+)["']/);if($&&$[1])X.push("mcp"),X.push($[1].toLowerCase());else{let J=Q.match(/^([^:[]+):/);if(J&&J[1])X.push(J[1].trim().toLowerCase())}let Y=Q.match(/^\[([^\]]+)]/);if(Y&&Y[1])X.push(Y[1].trim().toLowerCase());if(Q.toLowerCase().includes("1p event:"))X.push("1p");let G=Q.match(/:\s*([^:]+?)(?:\s+(?:type|mode|status|event))?:/);if(G&&G[1]){let J=G[1].trim().toLowerCase();if(J.length<30&&!J.includes(" "))X.push(J)}return Array.from(new Set(X))}function VL(Q,X){if(!X)return!0;if(Q.length===0)return!1;if(X.isExclusive)return!Q.some(($)=>X.exclude.includes($));else return Q.some(($)=>X.include.includes($))}function X5(Q,X){if(!X)return!0;let $=KL(Q);return VL($,X)}import{join as qL}from"path";import{homedir as UL}from"os";function S8(){return(process.env.CLAUDE_CONFIG_DIR??qL(UL(),".claude")).normalize("NFC")}function Z8(Q){if(!Q)return!1;if(typeof Q==="boolean")return Q;let X=Q.toLowerCase().trim();return["1","true","yes","on"].includes(X)}import{dirname as H5,join as z5}from"path";import{cwd as LL}from"process";import{realpathSync as $5}from"fs";import{randomUUID as FL}from"crypto";function NL(){let Q="";if(typeof process<"u"&&typeof process.cwd==="function"&&typeof $5==="function")Q=$5(LL()).normalize("NFC");return{originalCwd:Q,projectRoot:Q,totalCostUSD:0,totalAPIDuration:0,totalAPIDurationWithoutRetries:0,totalToolDuration:0,turnHookDurationMs:0,startTime:Date.now(),lastInteractionTime:Date.now(),totalLinesAdded:0,totalLinesRemoved:0,hasUnknownModelCost:!1,cwd:Q,modelUsage:{},mainLoopModelOverride:void 0,initialMainLoopModel:null,modelStrings:null,isInteractive:!1,clientType:"cli",sessionSource:void 0,sessionIngressToken:void 0,oauthTokenFromFd:void 0,apiKeyFromFd:void 0,flagSettingsPath:void 0,flagSettingsInline:null,allowedSettingSources:["userSettings","projectSettings","localSettings","flagSettings","policySettings"],meter:null,sessionCounter:null,locCounter:null,prCounter:null,commitCounter:null,costCounter:null,tokenCounter:null,codeEditToolDecisionCounter:null,activeTimeCounter:null,statsStore:null,sessionId:FL(),parentSessionId:void 0,loggerProvider:null,eventLogger:null,meterProvider:null,tracerProvider:null,agentColorMap:new Map,agentColorIndex:0,lastAPIRequest:null,inMemoryErrorLog:[],inlinePlugins:[],chromeFlagOverride:void 0,useCoworkPlugins:!1,sessionBypassPermissionsMode:!1,sessionTrustAccepted:!1,sessionPersistenceDisabled:!1,hasExitedPlanMode:!1,needsPlanModeExitAttachment:!1,lspRecommendationShownThisSession:!1,initJsonSchema:null,registeredHooks:null,planSlugCache:new Map,teleportedSessionInfo:null,invokedSkills:new Map,slowOperations:[],promptCacheBreaks:[],sdkBetas:void 0,mainThreadAgentType:void 0,isRemoteMode:!1,directConnectServerUrl:void 0,systemPromptSectionCache:new Map,lastEmittedDate:null,additionalDirectoriesForClaudeMd:[],resumedTranscriptPath:null,promptCache1hAllowlist:null,promptId:null}}var DL=NL();function Y5(){return DL.sessionId}function G5({writeFn:Q,flushIntervalMs:X=1000,maxBufferSize:$=100,immediateMode:Y=!1}){let G=[],J=null;function W(){if(J)clearTimeout(J),J=null}function H(){if(G.length===0)return;Q(G.join("")),G=[],W()}function z(){if(!J)J=setTimeout(H,X)}return{write(B){if(Y){Q(B);return}if(G.push(B),z(),G.length>=$)H()},flush:H,dispose(){H()}}}var J5=new Set;function W5(Q){return J5.add(Q),()=>J5.delete(Q)}var OL=v0(()=>{return Z8(process.env.DEBUG)||Z8(process.env.DEBUG_SDK)||process.argv.includes("--debug")||process.argv.includes("-d")||B5()||process.argv.some((Q)=>Q.startsWith("--debug="))||K5()!==null}),ML=v0(()=>{let Q=process.argv.find(($)=>$.startsWith("--debug="));if(!Q)return null;let X=Q.substring(8);return Q5(X)}),B5=v0(()=>{return process.argv.includes("--debug-to-stderr")||process.argv.includes("-d2e")}),K5=v0(()=>{for(let Q=0;Q<process.argv.length;Q++){let X=process.argv[Q];if(X.startsWith("--debug-file="))return X.substring(13);if(X==="--debug-file"&&Q+1<process.argv.length)return process.argv[Q+1]}return null});function AL(Q){if(typeof process>"u"||typeof process.versions>"u"||typeof process.versions.node>"u")return!1;let X=ML();return X5(Q,X)}var wL=!1;var C8=null;function jL(){if(!C8){let Q=null;C8=G5({writeFn:(X)=>{let $=V5(),Y=H5($);if(Q!==Y){try{W0().mkdirSync(Y)}catch{}Q=Y}W0().appendFileSync($,X),IL()},flushIntervalMs:1000,maxBufferSize:100,immediateMode:OL()}),W5(async()=>C8?.dispose())}return C8}function N0(Q,{level:X}={level:"debug"}){if(!AL(Q))return;if(wL&&Q.includes(`
`))Q=S1(Q);let Y=`${new Date().toISOString()} [${X.toUpperCase()}] ${Q.trim()}
`;if(B5()){e7(Y);return}jL().write(Y)}function V5(){return K5()??process.env.CLAUDE_CODE_DEBUG_LOGS_DIR??z5(S8(),"debug",`${Y5()}.txt`)}var IL=v0(()=>{if(process.argv[2]==="--ripgrep")return;try{let Q=V5(),X=H5(Q),$=z5(X,"latest");if(!W0().existsSync(X))W0().mkdirSync(X);if(W0().existsSync($))try{W0().unlinkSync($)}catch{}W0().symlinkSync(Q,$)}catch{}});var eC=(()=>{let Q=process.env.CLAUDE_CODE_SLOW_OPERATION_THRESHOLD_MS;if(Q!==void 0){let X=Number(Q);if(!Number.isNaN(X)&&X>=0)return X}return 1/0})();var bL={[Symbol.dispose](){}};function RL(){return bL}var W1=RL;function S1(Q,X,$){let G=[];try{const Y=e(G,W1`JSON.stringify(${Q})`,0);return JSON.stringify(Q,X,$)}catch(J){var W=J,H=1}finally{Q1(G,W,H)}}var _8=(Q,X)=>{let Y=[];try{const $=e(Y,W1`JSON.parse(${Q})`,0);return typeof X>"u"?JSON.parse(Q):JSON.parse(Q,X)}catch(G){var J=G,W=1}finally{Q1(Y,J,W)}};var TL={cwd(){return process.cwd()},existsSync(Q){let $=[];try{const X=e($,W1`fs.existsSync(${Q})`,0);return f.existsSync(Q)}catch(Y){var G=Y,J=1}finally{Q1($,G,J)}},async stat(Q){return EL(Q)},async readdir(Q){return PL(Q,{withFileTypes:!0})},async unlink(Q){return SL(Q)},async rmdir(Q){return ZL(Q)},async rm(Q,X){return CL(Q,X)},async mkdir(Q,X){await _L(Q,{recursive:!0,...X})},async readFile(Q,X){return q5(Q,{encoding:X.encoding})},async rename(Q,X){return kL(Q,X)},statSync(Q){let $=[];try{const X=e($,W1`fs.statSync(${Q})`,0);return f.statSync(Q)}catch(Y){var G=Y,J=1}finally{Q1($,G,J)}},lstatSync(Q){let $=[];try{const X=e($,W1`fs.lstatSync(${Q})`,0);return f.lstatSync(Q)}catch(Y){var G=Y,J=1}finally{Q1($,G,J)}},readFileSync(Q,X){let Y=[];try{const $=e(Y,W1`fs.readFileSync(${Q})`,0);return f.readFileSync(Q,{encoding:X.encoding})}catch(G){var J=G,W=1}finally{Q1(Y,J,W)}},readFileBytesSync(Q){let $=[];try{const X=e($,W1`fs.readFileBytesSync(${Q})`,0);return f.readFileSync(Q)}catch(Y){var G=Y,J=1}finally{Q1($,G,J)}},readSync(Q,X){let G=[];try{const $=e(G,W1`fs.readSync(${Q}, ${X.length} bytes)`,0);let Y=void 0;try{Y=f.openSync(Q,"r");let z=Buffer.alloc(X.length),B=f.readSync(Y,z,0,X.length,0);return{buffer:z,bytesRead:B}}finally{if(Y)f.closeSync(Y)}}catch(J){var W=J,H=1}finally{Q1(G,W,H)}},appendFileSync(Q,X,$){let G=[];try{const Y=e(G,W1`fs.appendFileSync(${Q}, ${X.length} chars)`,0);if(!f.existsSync(Q)&&$?.mode!==void 0){let z=f.openSync(Q,"a",$.mode);try{f.appendFileSync(z,X)}finally{f.closeSync(z)}}else f.appendFileSync(Q,X)}catch(J){var W=J,H=1}finally{Q1(G,W,H)}},copyFileSync(Q,X){let Y=[];try{const $=e(Y,W1`fs.copyFileSync(${Q}  ${X})`,0);f.copyFileSync(Q,X)}catch(G){var J=G,W=1}finally{Q1(Y,J,W)}},unlinkSync(Q){let $=[];try{const X=e($,W1`fs.unlinkSync(${Q})`,0);f.unlinkSync(Q)}catch(Y){var G=Y,J=1}finally{Q1($,G,J)}},renameSync(Q,X){let Y=[];try{const $=e(Y,W1`fs.renameSync(${Q}  ${X})`,0);f.renameSync(Q,X)}catch(G){var J=G,W=1}finally{Q1(Y,J,W)}},linkSync(Q,X){let Y=[];try{const $=e(Y,W1`fs.linkSync(${Q}  ${X})`,0);f.linkSync(Q,X)}catch(G){var J=G,W=1}finally{Q1(Y,J,W)}},symlinkSync(Q,X,$){let G=[];try{const Y=e(G,W1`fs.symlinkSync(${Q}  ${X})`,0);f.symlinkSync(Q,X,$)}catch(J){var W=J,H=1}finally{Q1(G,W,H)}},readlinkSync(Q){let $=[];try{const X=e($,W1`fs.readlinkSync(${Q})`,0);return f.readlinkSync(Q)}catch(Y){var G=Y,J=1}finally{Q1($,G,J)}},realpathSync(Q){let $=[];try{const X=e($,W1`fs.realpathSync(${Q})`,0);return f.realpathSync(Q).normalize("NFC")}catch(Y){var G=Y,J=1}finally{Q1($,G,J)}},mkdirSync(Q,X){let Y=[];try{const $=e(Y,W1`fs.mkdirSync(${Q})`,0);if(!f.existsSync(Q)){let H={recursive:!0};if(X?.mode!==void 0)H.mode=X.mode;f.mkdirSync(Q,H)}}catch(G){var J=G,W=1}finally{Q1(Y,J,W)}},readdirSync(Q){let $=[];try{const X=e($,W1`fs.readdirSync(${Q})`,0);return f.readdirSync(Q,{withFileTypes:!0})}catch(Y){var G=Y,J=1}finally{Q1($,G,J)}},readdirStringSync(Q){let $=[];try{const X=e($,W1`fs.readdirStringSync(${Q})`,0);return f.readdirSync(Q)}catch(Y){var G=Y,J=1}finally{Q1($,G,J)}},isDirEmptySync(Q){let Y=[];try{const X=e(Y,W1`fs.isDirEmptySync(${Q})`,0);let $=this.readdirSync(Q);return $.length===0}catch(G){var J=G,W=1}finally{Q1(Y,J,W)}},rmdirSync(Q){let $=[];try{const X=e($,W1`fs.rmdirSync(${Q})`,0);f.rmdirSync(Q)}catch(Y){var G=Y,J=1}finally{Q1($,G,J)}},rmSync(Q,X){let Y=[];try{const $=e(Y,W1`fs.rmSync(${Q})`,0);f.rmSync(Q,X)}catch(G){var J=G,W=1}finally{Q1(Y,J,W)}},createWriteStream(Q){return f.createWriteStream(Q)},async readFileBytes(Q,X){if(X===void 0)return q5(Q);let $=await vL(Q,"r");try{let{size:Y}=await $.stat(),G=Math.min(Y,X),J=Buffer.allocUnsafe(G),W=0;while(W<G){let{bytesRead:H}=await $.read(J,W,G-W,W);if(H===0)break;W+=H}return W<G?J.subarray(0,W):J}finally{await $.close()}}},xL=TL;function W0(){return xL}var yL=["PreToolUse","PostToolUse","PostToolUseFailure","Notification","UserPromptSubmit","SessionStart","SessionEnd","Stop","SubagentStart","SubagentStop","PreCompact","PermissionRequest","Setup","TeammateIdle","TaskCompleted","ConfigChange","WorktreeCreate","WorktreeRemove"],gL=["clear","logout","prompt_input_exit","other","bypass_permissions_disabled"];class D0 extends Error{}function P6(){return process.versions.bun!==void 0}import{randomUUID as fL}from"crypto";import{appendFileSync as hL,existsSync as uL,mkdirSync as lL}from"fs";import{join as U5}from"path";var k8=null,L5=!1;function mL(){if(L5)return k8;if(L5=!0,!process.env.DEBUG_CLAUDE_AGENT_SDK)return null;let Q=U5(S8(),"debug");if(k8=U5(Q,`sdk-${fL()}.txt`),!uL(Q))lL(Q,{recursive:!0});return process.stderr.write(`SDK debug logs: ${k8}
`),k8}function O0(Q){let X=mL();if(!X)return;let Y=`${new Date().toISOString()} ${Q}
`;hL(X,Y)}function F5(Q,X){let $={...Q};if(X){let Y={sandbox:X};if($.settings)try{Y={..._8($.settings),sandbox:X}}catch{}$.settings=S1(Y)}return $}class J4{options;process;processStdin;processStdout;ready=!1;abortController;exitError;exitListeners=[];processExitHandler;abortHandler;constructor(Q){this.options=Q;this.abortController=Q.abortController||w6(),this.initialize()}getDefaultExecutable(){return P6()?"bun":"node"}spawnLocalProcess(Q){let{command:X,args:$,cwd:Y,env:G,signal:J}=Q,W=G.DEBUG_CLAUDE_AGENT_SDK||this.options.stderr?"pipe":"ignore",H=cL(X,$,{cwd:Y,stdio:["pipe","pipe",W],signal:J,env:G,windowsHide:!0});if(G.DEBUG_CLAUDE_AGENT_SDK||this.options.stderr)H.stderr.on("data",(B)=>{let K=B.toString();if(O0(K),this.options.stderr)this.options.stderr(K)});return{stdin:H.stdin,stdout:H.stdout,get killed(){return H.killed},get exitCode(){return H.exitCode},kill:H.kill.bind(H),on:H.on.bind(H),once:H.once.bind(H),off:H.off.bind(H)}}initialize(){try{let{additionalDirectories:Q=[],agent:X,betas:$,cwd:Y,executable:G=this.getDefaultExecutable(),executableArgs:J=[],extraArgs:W={},pathToClaudeCodeExecutable:H,env:z={...process.env},thinkingConfig:B,maxTurns:K,maxBudgetUsd:q,model:U,fallbackModel:V,jsonSchema:L,permissionMode:F,allowDangerouslySkipPermissions:M,permissionPromptToolName:O,continueConversation:j,resume:I,settingSources:v,allowedTools:k=[],disallowedTools:q1=[],tools:F1,mcpServers:c1,strictMcpConfig:a0,canUseTool:U0,includePartialMessages:s0,plugins:Z0,sandbox:e0}=this.options,u=["--output-format","stream-json","--verbose","--input-format","stream-json"];if(B)switch(B.type){case"enabled":if(B.budgetTokens===void 0)u.push("--thinking","adaptive");else u.push("--max-thinking-tokens",B.budgetTokens.toString());break;case"disabled":u.push("--thinking","disabled");break;case"adaptive":u.push("--thinking","adaptive");break}if(this.options.effort)u.push("--effort",this.options.effort);if(K)u.push("--max-turns",K.toString());if(q!==void 0)u.push("--max-budget-usd",q.toString());if(U)u.push("--model",U);if(X)u.push("--agent",X);if($&&$.length>0)u.push("--betas",$.join(","));if(L)u.push("--json-schema",S1(L));if(this.options.debugFile)u.push("--debug-file",this.options.debugFile);else if(this.options.debug)u.push("--debug");if(z.DEBUG_CLAUDE_AGENT_SDK)u.push("--debug-to-stderr");if(U0){if(O)throw Error("canUseTool callback cannot be used with permissionPromptToolName. Please use one or the other.");u.push("--permission-prompt-tool","stdio")}else if(O)u.push("--permission-prompt-tool",O);if(j)u.push("--continue");if(I)u.push("--resume",I);if(k.length>0)u.push("--allowedTools",k.join(","));if(q1.length>0)u.push("--disallowedTools",q1.join(","));if(F1!==void 0)if(Array.isArray(F1))if(F1.length===0)u.push("--tools","");else u.push("--tools",F1.join(","));else u.push("--tools","default");if(c1&&Object.keys(c1).length>0)u.push("--mcp-config",S1({mcpServers:c1}));if(v)u.push("--setting-sources",v.join(","));if(a0)u.push("--strict-mcp-config");if(F)u.push("--permission-mode",F);if(M)u.push("--allow-dangerously-skip-permissions");if(V){if(U&&V===U)throw Error("Fallback model cannot be the same as the main model. Please specify a different model for fallbackModel option.");u.push("--fallback-model",V)}if(s0)u.push("--include-partial-messages");for(let R1 of Q)u.push("--add-dir",R1);if(Z0&&Z0.length>0)for(let R1 of Z0)if(R1.type==="local")u.push("--plugin-dir",R1.path);else throw Error(`Unsupported plugin type: ${R1.type}`);if(this.options.forkSession)u.push("--fork-session");if(this.options.resumeSessionAt)u.push("--resume-session-at",this.options.resumeSessionAt);if(this.options.sessionId)u.push("--session-id",this.options.sessionId);if(this.options.persistSession===!1)u.push("--no-session-persistence");let vQ=F5(W??{},e0);for(let[R1,C0]of Object.entries(vQ))if(C0===null)u.push(`--${R1}`);else u.push(`--${R1}`,C0);if(!z.CLAUDE_CODE_ENTRYPOINT)z.CLAUDE_CODE_ENTRYPOINT="sdk-ts";if(delete z.NODE_OPTIONS,z.DEBUG_CLAUDE_AGENT_SDK)z.DEBUG="1";else delete z.DEBUG;let Q6=dL(H),$4=Q6?H:G,X6=Q6?[...J,...u]:[...J,H,...u],A8={command:$4,args:X6,cwd:Y,env:z,signal:this.abortController.signal};if(this.options.spawnClaudeCodeProcess)O0(`Spawning Claude Code (custom): ${$4} ${X6.join(" ")}`),this.process=this.options.spawnClaudeCodeProcess(A8);else{if(!W0().existsSync(H)){let C0=Q6?`Claude Code native binary not found at ${H}. Please ensure Claude Code is installed via native installer or specify a valid path with options.pathToClaudeCodeExecutable.`:`Claude Code executable not found at ${H}. Is options.pathToClaudeCodeExecutable set?`;throw ReferenceError(C0)}O0(`Spawning Claude Code: ${$4} ${X6.join(" ")}`),this.process=this.spawnLocalProcess(A8)}this.processStdin=this.process.stdin,this.processStdout=this.process.stdout;let w8=()=>{if(this.process&&!this.process.killed)this.process.kill("SIGTERM")};this.processExitHandler=w8,this.abortHandler=w8,process.on("exit",this.processExitHandler),this.abortController.signal.addEventListener("abort",this.abortHandler),this.process.on("error",(R1)=>{if(this.ready=!1,this.abortController.signal.aborted)this.exitError=new D0("Claude Code process aborted by user");else this.exitError=Error(`Failed to spawn Claude Code process: ${R1.message}`),O0(this.exitError.message)}),this.process.on("exit",(R1,C0)=>{if(this.ready=!1,this.abortController.signal.aborted)this.exitError=new D0("Claude Code process aborted by user");else{let M6=this.getProcessExitError(R1,C0);if(M6)this.exitError=M6,O0(M6.message)}}),this.ready=!0}catch(Q){throw this.ready=!1,Q}}getProcessExitError(Q,X){if(Q!==0&&Q!==null)return Error(`Claude Code process exited with code ${Q}`);else if(X)return Error(`Claude Code process terminated by signal ${X}`);return}write(Q){if(this.abortController.signal.aborted)throw new D0("Operation aborted");if(!this.ready||!this.processStdin)throw Error("ProcessTransport is not ready for writing");if(this.process?.killed||this.process?.exitCode!==null)throw Error("Cannot write to terminated process");if(this.exitError)throw Error(`Cannot write to process that exited with error: ${this.exitError.message}`);O0(`[ProcessTransport] Writing to stdin: ${Q.substring(0,100)}`);try{if(!this.processStdin.write(Q))O0("[ProcessTransport] Write buffer full, data queued")}catch(X){throw this.ready=!1,Error(`Failed to write to process stdin: ${X.message}`)}}close(){if(this.processStdin)this.processStdin.end(),this.processStdin=void 0;if(this.abortHandler)this.abortController.signal.removeEventListener("abort",this.abortHandler),this.abortHandler=void 0;for(let{handler:Q}of this.exitListeners)this.process?.off("exit",Q);if(this.exitListeners=[],this.process&&!this.process.killed)this.process.kill("SIGTERM"),setTimeout(()=>{if(this.process&&!this.process.killed)this.process.kill("SIGKILL")},5000);if(this.ready=!1,this.processExitHandler)process.off("exit",this.processExitHandler),this.processExitHandler=void 0}isReady(){return this.ready}async*readMessages(){if(!this.processStdout)throw Error("ProcessTransport output stream not available");let Q=pL({input:this.processStdout});try{for await(let X of Q)if(X.trim())try{yield _8(X)}catch($){throw O0(`Non-JSON stdout: ${X}`),Error(`CLI output was not valid JSON. This may indicate an error during startup. Output: ${X.slice(0,200)}${X.length>200?"...":""}`)}await this.waitForExit()}catch(X){throw X}finally{Q.close()}}endInput(){if(this.processStdin)this.processStdin.end()}getInputStream(){return this.processStdin}onExit(Q){if(!this.process)return()=>{};let X=($,Y)=>{let G=this.getProcessExitError($,Y);Q(G)};return this.process.on("exit",X),this.exitListeners.push({callback:Q,handler:X}),()=>{if(this.process)this.process.off("exit",X);let $=this.exitListeners.findIndex((Y)=>Y.handler===X);if($!==-1)this.exitListeners.splice($,1)}}async waitForExit(){if(!this.process){if(this.exitError)throw this.exitError;return}if(this.process.exitCode!==null||this.process.killed){if(this.exitError)throw this.exitError;return}return new Promise((Q,X)=>{let $=(G,J)=>{if(this.abortController.signal.aborted){X(new D0("Operation aborted"));return}let W=this.getProcessExitError(G,J);if(W)X(W);else Q()};this.process.once("exit",$);let Y=(G)=>{this.process.off("exit",$),X(G)};this.process.once("error",Y),this.process.once("exit",()=>{this.process.off("error",Y)})})}}function dL(Q){return![".js",".mjs",".tsx",".ts",".jsx"].some(($)=>Q.endsWith($))}class W4{returned;queue=[];readResolve;readReject;isDone=!1;hasError;started=!1;constructor(Q){this.returned=Q}[Symbol.asyncIterator](){if(this.started)throw Error("Stream can only be iterated once");return this.started=!0,this}next(){if(this.queue.length>0)return Promise.resolve({done:!1,value:this.queue.shift()});if(this.isDone)return Promise.resolve({done:!0,value:void 0});if(this.hasError)return Promise.reject(this.hasError);return new Promise((Q,X)=>{this.readResolve=Q,this.readReject=X})}enqueue(Q){if(this.readResolve){let X=this.readResolve;this.readResolve=void 0,this.readReject=void 0,X({done:!1,value:Q})}else this.queue.push(Q)}done(){if(this.isDone=!0,this.readResolve){let Q=this.readResolve;this.readResolve=void 0,this.readReject=void 0,Q({done:!0,value:void 0})}}error(Q){if(this.hasError=Q,this.readReject){let X=this.readReject;this.readResolve=void 0,this.readReject=void 0,X(Q)}}return(){if(this.isDone=!0,this.returned)this.returned();return Promise.resolve({done:!0,value:void 0})}}class hQ{sendMcpMessage;isClosed=!1;constructor(Q){this.sendMcpMessage=Q}onclose;onerror;onmessage;async start(){}async send(Q){if(this.isClosed)throw Error("Transport is closed");this.sendMcpMessage(Q)}async close(){if(this.isClosed)return;this.isClosed=!0,this.onclose?.()}}import{randomUUID as iL}from"crypto";class H4{transport;isSingleUserTurn;canUseTool;hooks;abortController;jsonSchema;initConfig;pendingControlResponses=new Map;cleanupPerformed=!1;sdkMessages;inputStream=new W4;initialization;cancelControllers=new Map;hookCallbacks=new Map;nextCallbackId=0;sdkMcpTransports=new Map;sdkMcpServerInstances=new Map;pendingMcpResponses=new Map;firstResultReceivedResolve;firstResultReceived=!1;hasBidirectionalNeeds(){return this.sdkMcpTransports.size>0||this.hooks!==void 0&&Object.keys(this.hooks).length>0||this.canUseTool!==void 0}constructor(Q,X,$,Y,G,J=new Map,W,H){this.transport=Q;this.isSingleUserTurn=X;this.canUseTool=$;this.hooks=Y;this.abortController=G;this.jsonSchema=W;this.initConfig=H;for(let[z,B]of J)this.connectSdkMcpServer(z,B);this.sdkMessages=this.readSdkMessages(),this.readMessages(),this.initialization=this.initialize(),this.initialization.catch(()=>{})}setError(Q){this.inputStream.error(Q)}async stopTask(Q){await this.request({subtype:"stop_task",task_id:Q})}close(){this.cleanup()}cleanup(Q){if(this.cleanupPerformed)return;this.cleanupPerformed=!0;try{this.transport.close();let X=Error("Query closed before response received");for(let{reject:$}of this.pendingControlResponses.values())$(X);this.pendingControlResponses.clear();for(let{reject:$}of this.pendingMcpResponses.values())$(X);this.pendingMcpResponses.clear(),this.cancelControllers.clear(),this.hookCallbacks.clear();for(let $ of this.sdkMcpTransports.values())try{$.close()}catch{}if(this.sdkMcpTransports.clear(),Q)this.inputStream.error(Q);else this.inputStream.done()}catch(X){}}next(...[Q]){return this.sdkMessages.next(...[Q])}return(Q){return this.sdkMessages.return(Q)}throw(Q){return this.sdkMessages.throw(Q)}[Symbol.asyncIterator](){return this.sdkMessages}[Symbol.asyncDispose](){return this.sdkMessages[Symbol.asyncDispose]()}async readMessages(){try{for await(let Q of this.transport.readMessages()){if(Q.type==="control_response"){let X=this.pendingControlResponses.get(Q.response.request_id);if(X)X.handler(Q.response);continue}else if(Q.type==="control_request"){this.handleControlRequest(Q);continue}else if(Q.type==="control_cancel_request"){this.handleControlCancelRequest(Q);continue}else if(Q.type==="keep_alive")continue;if(Q.type==="streamlined_text"||Q.type==="streamlined_tool_use_summary")continue;if(Q.type==="result"){if(this.firstResultReceived=!0,this.firstResultReceivedResolve)this.firstResultReceivedResolve();if(this.isSingleUserTurn)N0("[Query.readMessages] First result received for single-turn query, closing stdin"),this.transport.endInput()}this.inputStream.enqueue(Q)}if(this.firstResultReceivedResolve)this.firstResultReceivedResolve();this.inputStream.done(),this.cleanup()}catch(Q){if(this.firstResultReceivedResolve)this.firstResultReceivedResolve();this.inputStream.error(Q),this.cleanup(Q)}}async handleControlRequest(Q){let X=new AbortController;this.cancelControllers.set(Q.request_id,X);try{let $=await this.processControlRequest(Q,X.signal),Y={type:"control_response",response:{subtype:"success",request_id:Q.request_id,response:$}};await Promise.resolve(this.transport.write(S1(Y)+`
`))}catch($){let Y={type:"control_response",response:{subtype:"error",request_id:Q.request_id,error:$.message||String($)}};await Promise.resolve(this.transport.write(S1(Y)+`
`))}finally{this.cancelControllers.delete(Q.request_id)}}handleControlCancelRequest(Q){let X=this.cancelControllers.get(Q.request_id);if(X)X.abort(),this.cancelControllers.delete(Q.request_id)}async processControlRequest(Q,X){if(Q.request.subtype==="can_use_tool"){if(!this.canUseTool)throw Error("canUseTool callback is not provided.");return{...await this.canUseTool(Q.request.tool_name,Q.request.input,{signal:X,suggestions:Q.request.permission_suggestions,blockedPath:Q.request.blocked_path,decisionReason:Q.request.decision_reason,toolUseID:Q.request.tool_use_id,agentID:Q.request.agent_id}),toolUseID:Q.request.tool_use_id}}else if(Q.request.subtype==="hook_callback")return await this.handleHookCallbacks(Q.request.callback_id,Q.request.input,Q.request.tool_use_id,X);else if(Q.request.subtype==="mcp_message"){let $=Q.request,Y=this.sdkMcpTransports.get($.server_name);if(!Y)throw Error(`SDK MCP server not found: ${$.server_name}`);if("method"in $.message&&"id"in $.message&&$.message.id!==null)return{mcp_response:await this.handleMcpControlRequest($.server_name,$,Y)};else{if(Y.onmessage)Y.onmessage($.message);return{mcp_response:{jsonrpc:"2.0",result:{},id:0}}}}throw Error("Unsupported control request subtype: "+Q.request.subtype)}async*readSdkMessages(){for await(let Q of this.inputStream)yield Q}async initialize(){let Q;if(this.hooks){Q={};for(let[G,J]of Object.entries(this.hooks))if(J.length>0)Q[G]=J.map((W)=>{let H=[];for(let z of W.hooks){let B=`hook_${this.nextCallbackId++}`;this.hookCallbacks.set(B,z),H.push(B)}return{matcher:W.matcher,hookCallbackIds:H,timeout:W.timeout}})}let X=this.sdkMcpTransports.size>0?Array.from(this.sdkMcpTransports.keys()):void 0,$={subtype:"initialize",hooks:Q,sdkMcpServers:X,jsonSchema:this.jsonSchema,systemPrompt:this.initConfig?.systemPrompt,appendSystemPrompt:this.initConfig?.appendSystemPrompt,agents:this.initConfig?.agents,promptSuggestions:this.initConfig?.promptSuggestions};return(await this.request($)).response}async interrupt(){await this.request({subtype:"interrupt"})}async setPermissionMode(Q){await this.request({subtype:"set_permission_mode",mode:Q})}async setModel(Q){await this.request({subtype:"set_model",model:Q})}async setMaxThinkingTokens(Q){await this.request({subtype:"set_max_thinking_tokens",max_thinking_tokens:Q})}async applyFlagSettings(Q){await this.request({subtype:"apply_flag_settings",settings:Q})}async rewindFiles(Q,X){return(await this.request({subtype:"rewind_files",user_message_id:Q,dry_run:X?.dryRun})).response}async processPendingPermissionRequests(Q){for(let X of Q)if(X.request.subtype==="can_use_tool")this.handleControlRequest(X).catch(()=>{})}request(Q){let X=Math.random().toString(36).substring(2,15),$={request_id:X,type:"control_request",request:Q};return new Promise((Y,G)=>{this.pendingControlResponses.set(X,{handler:(J)=>{if(this.pendingControlResponses.delete(X),J.subtype==="success")Y(J);else if(G(Error(J.error)),J.pending_permission_requests)this.processPendingPermissionRequests(J.pending_permission_requests)},reject:G}),Promise.resolve(this.transport.write(S1($)+`
`))})}async initializationResult(){return this.initialization}async supportedCommands(){return(await this.initialization).commands}async supportedModels(){return(await this.initialization).models}async reconnectMcpServer(Q){await this.request({subtype:"mcp_reconnect",serverName:Q})}async toggleMcpServer(Q,X){await this.request({subtype:"mcp_toggle",serverName:Q,enabled:X})}async mcpServerStatus(){return(await this.request({subtype:"mcp_status"})).response.mcpServers}async setMcpServers(Q){let X={},$={};for(let[H,z]of Object.entries(Q))if(z.type==="sdk"&&"instance"in z)X[H]=z.instance;else $[H]=z;let Y=new Set(this.sdkMcpServerInstances.keys()),G=new Set(Object.keys(X));for(let H of Y)if(!G.has(H))await this.disconnectSdkMcpServer(H);for(let[H,z]of Object.entries(X))if(!Y.has(H))this.connectSdkMcpServer(H,z);let J={};for(let H of Object.keys(X))J[H]={type:"sdk",name:H};return(await this.request({subtype:"mcp_set_servers",servers:{...$,...J}})).response}async accountInfo(){return(await this.initialization).account}async streamInput(Q){N0("[Query.streamInput] Starting to process input stream");try{let X=0;for await(let $ of Q){if(X++,N0(`[Query.streamInput] Processing message ${X}: ${$.type}`),this.abortController?.signal.aborted)break;await Promise.resolve(this.transport.write(S1($)+`
`))}if(N0(`[Query.streamInput] Finished processing ${X} messages from input stream`),X>0&&this.hasBidirectionalNeeds())N0("[Query.streamInput] Has bidirectional needs, waiting for first result"),await this.waitForFirstResult();N0("[Query] Calling transport.endInput() to close stdin to CLI process"),this.transport.endInput()}catch(X){if(!(X instanceof D0))throw X}}waitForFirstResult(){if(this.firstResultReceived)return N0("[Query.waitForFirstResult] Result already received, returning immediately"),Promise.resolve();return new Promise((Q)=>{if(this.abortController?.signal.aborted){Q();return}this.abortController?.signal.addEventListener("abort",()=>Q(),{once:!0}),this.firstResultReceivedResolve=Q})}handleHookCallbacks(Q,X,$,Y){let G=this.hookCallbacks.get(Q);if(!G)throw Error(`No hook callback found for ID: ${Q}`);return G(X,$,{signal:Y})}connectSdkMcpServer(Q,X){let $=new hQ((Y)=>this.sendMcpServerMessageToCli(Q,Y));this.sdkMcpTransports.set(Q,$),this.sdkMcpServerInstances.set(Q,X),X.connect($)}async disconnectSdkMcpServer(Q){let X=this.sdkMcpTransports.get(Q);if(X)await X.close(),this.sdkMcpTransports.delete(Q);this.sdkMcpServerInstances.delete(Q)}sendMcpServerMessageToCli(Q,X){if("id"in X&&X.id!==null&&X.id!==void 0){let Y=`${Q}:${X.id}`,G=this.pendingMcpResponses.get(Y);if(G){G.resolve(X),this.pendingMcpResponses.delete(Y);return}}let $={type:"control_request",request_id:iL(),request:{subtype:"mcp_message",server_name:Q,message:X}};this.transport.write(S1($)+`
`)}handleMcpControlRequest(Q,X,$){let Y="id"in X.message?X.message.id:null,G=`${Q}:${Y}`;return new Promise((J,W)=>{let H=()=>{this.pendingMcpResponses.delete(G)},z=(K)=>{H(),J(K)},B=(K)=>{H(),W(K)};if(this.pendingMcpResponses.set(G,{resolve:z,reject:B}),$.onmessage)$.onmessage(X.message);else{H(),W(Error("No message handler registered"));return}})}}import{fileURLToPath as dN}from"url";import{dirname as iN,join as i8}from"path";import{readFileSync as nN,writeFileSync as oN,chmodSync as rN,mkdirSync as tN}from"fs";import{tmpdir as aN}from"os";var iJ=b8(YJ(),1);import{Buffer as gN}from"node:buffer";import fN from"node:path";import OX from"node:child_process";import d8 from"node:process";function rQ(Q){let X=typeof Q==="string"?`
`:`
`.charCodeAt(),$=typeof Q==="string"?"\r":"\r".charCodeAt();if(Q[Q.length-1]===X)Q=Q.slice(0,-1);if(Q[Q.length-1]===$)Q=Q.slice(0,-1);return Q}import x8 from"node:process";import z4 from"node:path";import{fileURLToPath as GJ}from"node:url";function T8(Q={}){let{env:X=process.env,platform:$=process.platform}=Q;if($!=="win32")return"PATH";return Object.keys(X).reverse().find((Y)=>Y.toUpperCase()==="PATH")||"Path"}var jF=({cwd:Q=x8.cwd(),path:X=x8.env[T8()],preferLocal:$=!0,execPath:Y=x8.execPath,addExecPath:G=!0}={})=>{let J=Q instanceof URL?GJ(Q):Q,W=z4.resolve(J),H=[];if($)IF(H,W);if(G)bF(H,Y,W);return[...H,X].join(z4.delimiter)},IF=(Q,X)=>{let $;while($!==X)Q.push(z4.join(X,"node_modules/.bin")),$=X,X=z4.resolve(X,"..")},bF=(Q,X,$)=>{let Y=X instanceof URL?GJ(X):X;Q.push(z4.resolve($,Y,".."))},JJ=({env:Q=x8.env,...X}={})=>{Q={...Q};let $=T8({env:Q});return X.path=Q[$],Q[$]=jF(X),Q};var RF=(Q,X,$,Y)=>{if($==="length"||$==="prototype")return;if($==="arguments"||$==="caller")return;let G=Object.getOwnPropertyDescriptor(Q,$),J=Object.getOwnPropertyDescriptor(X,$);if(!EF(G,J)&&Y)return;Object.defineProperty(Q,$,J)},EF=function(Q,X){return Q===void 0||Q.configurable||Q.writable===X.writable&&Q.enumerable===X.enumerable&&Q.configurable===X.configurable&&(Q.writable||Q.value===X.value)},PF=(Q,X)=>{let $=Object.getPrototypeOf(X);if($===Object.getPrototypeOf(Q))return;Object.setPrototypeOf(Q,$)},SF=(Q,X)=>`/* Wrapped ${Q}*/
${X}`,ZF=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),CF=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),_F=(Q,X,$)=>{let Y=$===""?"":`with ${$.trim()}() `,G=SF.bind(null,Y,X.toString());Object.defineProperty(G,"name",CF),Object.defineProperty(Q,"toString",{...ZF,value:G})};function tQ(Q,X,{ignoreNonConfigurable:$=!1}={}){let{name:Y}=Q;for(let G of Reflect.ownKeys(X))RF(Q,X,G,$);return PF(Q,X),_F(Q,X,Y),Q}var y8=new WeakMap,WJ=(Q,X={})=>{if(typeof Q!=="function")throw TypeError("Expected a function");let $,Y=0,G=Q.displayName||Q.name||"<anonymous>",J=function(...W){if(y8.set(J,++Y),Y===1)$=Q.apply(this,W),Q=null;else if(X.throw===!0)throw Error(`Function \`${G}\` can only be called once`);return $};return tQ(J,Q),y8.set(J,Y),J};WJ.callCount=(Q)=>{if(!y8.has(Q))throw Error(`The given function \`${Q.name}\` is not wrapped by the \`onetime\` package`);return y8.get(Q)};var HJ=WJ;import lF from"node:process";import{constants as xF}from"node:os";var zJ=()=>{let Q=aQ-BJ+1;return Array.from({length:Q},kF)},kF=(Q,X)=>({name:`SIGRT${X+1}`,number:BJ+X,action:"terminate",description:"Application-specific signal (realtime)",standard:"posix"}),BJ=34,aQ=64;import{constants as vF}from"node:os";var KJ=[{name:"SIGHUP",number:1,action:"terminate",description:"Terminal closed",standard:"posix"},{name:"SIGINT",number:2,action:"terminate",description:"User interruption with CTRL-C",standard:"ansi"},{name:"SIGQUIT",number:3,action:"core",description:"User interruption with CTRL-\\",standard:"posix"},{name:"SIGILL",number:4,action:"core",description:"Invalid machine instruction",standard:"ansi"},{name:"SIGTRAP",number:5,action:"core",description:"Debugger breakpoint",standard:"posix"},{name:"SIGABRT",number:6,action:"core",description:"Aborted",standard:"ansi"},{name:"SIGIOT",number:6,action:"core",description:"Aborted",standard:"bsd"},{name:"SIGBUS",number:7,action:"core",description:"Bus error due to misaligned, non-existing address or paging error",standard:"bsd"},{name:"SIGEMT",number:7,action:"terminate",description:"Command should be emulated but is not implemented",standard:"other"},{name:"SIGFPE",number:8,action:"core",description:"Floating point arithmetic error",standard:"ansi"},{name:"SIGKILL",number:9,action:"terminate",description:"Forced termination",standard:"posix",forced:!0},{name:"SIGUSR1",number:10,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGSEGV",number:11,action:"core",description:"Segmentation fault",standard:"ansi"},{name:"SIGUSR2",number:12,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGPIPE",number:13,action:"terminate",description:"Broken pipe or socket",standard:"posix"},{name:"SIGALRM",number:14,action:"terminate",description:"Timeout or timer",standard:"posix"},{name:"SIGTERM",number:15,action:"terminate",description:"Termination",standard:"ansi"},{name:"SIGSTKFLT",number:16,action:"terminate",description:"Stack is empty or overflowed",standard:"other"},{name:"SIGCHLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"posix"},{name:"SIGCLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"other"},{name:"SIGCONT",number:18,action:"unpause",description:"Unpaused",standard:"posix",forced:!0},{name:"SIGSTOP",number:19,action:"pause",description:"Paused",standard:"posix",forced:!0},{name:"SIGTSTP",number:20,action:"pause",description:'Paused using CTRL-Z or "suspend"',standard:"posix"},{name:"SIGTTIN",number:21,action:"pause",description:"Background process cannot read terminal input",standard:"posix"},{name:"SIGBREAK",number:21,action:"terminate",description:"User interruption with CTRL-BREAK",standard:"other"},{name:"SIGTTOU",number:22,action:"pause",description:"Background process cannot write to terminal output",standard:"posix"},{name:"SIGURG",number:23,action:"ignore",description:"Socket received out-of-band data",standard:"bsd"},{name:"SIGXCPU",number:24,action:"core",description:"Process timed out",standard:"bsd"},{name:"SIGXFSZ",number:25,action:"core",description:"File too big",standard:"bsd"},{name:"SIGVTALRM",number:26,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGPROF",number:27,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGWINCH",number:28,action:"ignore",description:"Terminal window size changed",standard:"bsd"},{name:"SIGIO",number:29,action:"terminate",description:"I/O is available",standard:"other"},{name:"SIGPOLL",number:29,action:"terminate",description:"Watched event",standard:"other"},{name:"SIGINFO",number:29,action:"ignore",description:"Request for process information",standard:"other"},{name:"SIGPWR",number:30,action:"terminate",description:"Device running out of power",standard:"systemv"},{name:"SIGSYS",number:31,action:"core",description:"Invalid system call",standard:"other"},{name:"SIGUNUSED",number:31,action:"terminate",description:"Invalid system call",standard:"other"}];var sQ=()=>{let Q=zJ();return[...KJ,...Q].map(TF)},TF=({name:Q,number:X,description:$,action:Y,forced:G=!1,standard:J})=>{let{signals:{[Q]:W}}=vF,H=W!==void 0;return{name:Q,number:H?W:X,description:$,supported:H,action:Y,forced:G,standard:J}};var yF=()=>{let Q=sQ();return Object.fromEntries(Q.map(gF))},gF=({name:Q,number:X,description:$,supported:Y,action:G,forced:J,standard:W})=>[Q,{name:Q,number:X,description:$,supported:Y,action:G,forced:J,standard:W}],VJ=yF(),fF=()=>{let Q=sQ(),X=aQ+1,$=Array.from({length:X},(Y,G)=>hF(G,Q));return Object.assign({},...$)},hF=(Q,X)=>{let $=uF(Q,X);if($===void 0)return{};let{name:Y,description:G,supported:J,action:W,forced:H,standard:z}=$;return{[Q]:{name:Y,number:Q,description:G,supported:J,action:W,forced:H,standard:z}}},uF=(Q,X)=>{let $=X.find(({name:Y})=>xF.signals[Y]===Q);if($!==void 0)return $;return X.find((Y)=>Y.number===Q)},Ok=fF();var mF=({timedOut:Q,timeout:X,errorCode:$,signal:Y,signalDescription:G,exitCode:J,isCanceled:W})=>{if(Q)return`timed out after ${X} milliseconds`;if(W)return"was canceled";if($!==void 0)return`failed with ${$}`;if(Y!==void 0)return`was killed with ${Y} (${G})`;if(J!==void 0)return`failed with exit code ${J}`;return"failed"},B4=({stdout:Q,stderr:X,all:$,error:Y,signal:G,exitCode:J,command:W,escapedCommand:H,timedOut:z,isCanceled:B,killed:K,parsed:{options:{timeout:q,cwd:U=lF.cwd()}}})=>{J=J===null?void 0:J,G=G===null?void 0:G;let V=G===void 0?void 0:VJ[G].description,L=Y&&Y.code,M=`Command ${mF({timedOut:z,timeout:q,errorCode:L,signal:G,signalDescription:V,exitCode:J,isCanceled:B})}: ${W}`,O=Object.prototype.toString.call(Y)==="[object Error]",j=O?`${M}
${Y.message}`:M,I=[j,X,Q].filter(Boolean).join(`
`);if(O)Y.originalMessage=Y.message,Y.message=I;else Y=Error(I);if(Y.shortMessage=j,Y.command=W,Y.escapedCommand=H,Y.exitCode=J,Y.signal=G,Y.signalDescription=V,Y.stdout=Q,Y.stderr=X,Y.cwd=U,$!==void 0)Y.all=$;if("bufferedData"in Y)delete Y.bufferedData;return Y.failed=!0,Y.timedOut=Boolean(z),Y.isCanceled=B,Y.killed=K&&!z,Y};var g8=["stdin","stdout","stderr"],cF=(Q)=>g8.some((X)=>Q[X]!==void 0),qJ=(Q)=>{if(!Q)return;let{stdio:X}=Q;if(X===void 0)return g8.map((Y)=>Q[Y]);if(cF(Q))throw Error(`It's not possible to provide \`stdio\` in combination with one of ${g8.map((Y)=>`\`${Y}\``).join(", ")}`);if(typeof X==="string")return X;if(!Array.isArray(X))throw TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof X}\``);let $=Math.max(X.length,g8.length);return Array.from({length:$},(Y,G)=>X[G])};import iF from"node:os";var $6=[];$6.push("SIGHUP","SIGINT","SIGTERM");if(process.platform!=="win32")$6.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT");if(process.platform==="linux")$6.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT");var f8=(Q)=>!!Q&&typeof Q==="object"&&typeof Q.removeListener==="function"&&typeof Q.emit==="function"&&typeof Q.reallyExit==="function"&&typeof Q.listeners==="function"&&typeof Q.kill==="function"&&typeof Q.pid==="number"&&typeof Q.on==="function",eQ=Symbol.for("signal-exit emitter"),QX=globalThis,pF=Object.defineProperty.bind(Object);class UJ{emitted={afterExit:!1,exit:!1};listeners={afterExit:[],exit:[]};count=0;id=Math.random();constructor(){if(QX[eQ])return QX[eQ];pF(QX,eQ,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(Q,X){this.listeners[Q].push(X)}removeListener(Q,X){let $=this.listeners[Q],Y=$.indexOf(X);if(Y===-1)return;if(Y===0&&$.length===1)$.length=0;else $.splice(Y,1)}emit(Q,X,$){if(this.emitted[Q])return!1;this.emitted[Q]=!0;let Y=!1;for(let G of this.listeners[Q])Y=G(X,$)===!0||Y;if(Q==="exit")Y=this.emit("afterExit",X,$)||Y;return Y}}class $X{}var dF=(Q)=>{return{onExit(X,$){return Q.onExit(X,$)},load(){return Q.load()},unload(){return Q.unload()}}};class LJ extends $X{onExit(){return()=>{}}load(){}unload(){}}class FJ extends $X{#W=XX.platform==="win32"?"SIGINT":"SIGHUP";#X=new UJ;#Q;#G;#J;#Y={};#$=!1;constructor(Q){super();this.#Q=Q,this.#Y={};for(let X of $6)this.#Y[X]=()=>{let $=this.#Q.listeners(X),{count:Y}=this.#X,G=Q;if(typeof G.__signal_exit_emitter__==="object"&&typeof G.__signal_exit_emitter__.count==="number")Y+=G.__signal_exit_emitter__.count;if($.length===Y){this.unload();let J=this.#X.emit("exit",null,X),W=X==="SIGHUP"?this.#W:X;if(!J)Q.kill(Q.pid,W)}};this.#J=Q.reallyExit,this.#G=Q.emit}onExit(Q,X){if(!f8(this.#Q))return()=>{};if(this.#$===!1)this.load();let $=X?.alwaysLast?"afterExit":"exit";return this.#X.on($,Q),()=>{if(this.#X.removeListener($,Q),this.#X.listeners.exit.length===0&&this.#X.listeners.afterExit.length===0)this.unload()}}load(){if(this.#$)return;this.#$=!0,this.#X.count+=1;for(let Q of $6)try{let X=this.#Y[Q];if(X)this.#Q.on(Q,X)}catch(X){}this.#Q.emit=(Q,...X)=>{return this.#z(Q,...X)},this.#Q.reallyExit=(Q)=>{return this.#H(Q)}}unload(){if(!this.#$)return;this.#$=!1,$6.forEach((Q)=>{let X=this.#Y[Q];if(!X)throw Error("Listener not defined for signal: "+Q);try{this.#Q.removeListener(Q,X)}catch($){}}),this.#Q.emit=this.#G,this.#Q.reallyExit=this.#J,this.#X.count-=1}#H(Q){if(!f8(this.#Q))return 0;return this.#Q.exitCode=Q||0,this.#X.emit("exit",this.#Q.exitCode,null),this.#J.call(this.#Q,this.#Q.exitCode)}#z(Q,...X){let $=this.#G;if(Q==="exit"&&f8(this.#Q)){if(typeof X[0]==="number")this.#Q.exitCode=X[0];let Y=$.call(this.#Q,Q,...X);return this.#X.emit("exit",this.#Q.exitCode,null),Y}else return $.call(this.#Q,Q,...X)}}var XX=globalThis.process,{onExit:NJ,load:Ek,unload:Pk}=dF(f8(XX)?new FJ(XX):new LJ);var nF=5000,DJ=(Q,X="SIGTERM",$={})=>{let Y=Q(X);return oF(Q,X,$,Y),Y},oF=(Q,X,$,Y)=>{if(!rF(X,$,Y))return;let G=aF($),J=setTimeout(()=>{Q("SIGKILL")},G);if(J.unref)J.unref()},rF=(Q,{forceKillAfterTimeout:X},$)=>tF(Q)&&X!==!1&&$,tF=(Q)=>Q===iF.constants.signals.SIGTERM||typeof Q==="string"&&Q.toUpperCase()==="SIGTERM",aF=({forceKillAfterTimeout:Q=!0})=>{if(Q===!0)return nF;if(!Number.isFinite(Q)||Q<0)throw TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${Q}\` (${typeof Q})`);return Q},OJ=(Q,X)=>{if(Q.kill())X.isCanceled=!0},sF=(Q,X,$)=>{Q.kill(X),$(Object.assign(Error("Timed out"),{timedOut:!0,signal:X}))},MJ=(Q,{timeout:X,killSignal:$="SIGTERM"},Y)=>{if(X===0||X===void 0)return Y;let G,J=new Promise((H,z)=>{G=setTimeout(()=>{sF(Q,$,z)},X)}),W=Y.finally(()=>{clearTimeout(G)});return Promise.race([J,W])},AJ=({timeout:Q})=>{if(Q!==void 0&&(!Number.isFinite(Q)||Q<0))throw TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${Q}\` (${typeof Q})`)},wJ=async(Q,{cleanup:X,detached:$},Y)=>{if(!X||$)return Y;let G=NJ(()=>{Q.kill()});return Y.finally(()=>{G()})};import{createWriteStream as eF}from"node:fs";import{ChildProcess as QN}from"node:child_process";function h8(Q){return Q!==null&&typeof Q==="object"&&typeof Q.pipe==="function"}function YX(Q){return h8(Q)&&Q.writable!==!1&&typeof Q._write==="function"&&typeof Q._writableState==="object"}var XN=(Q)=>Q instanceof QN&&typeof Q.then==="function",GX=(Q,X,$)=>{if(typeof $==="string")return Q[X].pipe(eF($)),Q;if(YX($))return Q[X].pipe($),Q;if(!XN($))throw TypeError("The second argument must be a string, a stream or an Execa child process.");if(!YX($.stdin))throw TypeError("The target child process's stdin must be available.");return Q[X].pipe($.stdin),$},jJ=(Q)=>{if(Q.stdout!==null)Q.pipeStdout=GX.bind(void 0,Q,"stdout");if(Q.stderr!==null)Q.pipeStderr=GX.bind(void 0,Q,"stderr");if(Q.all!==void 0)Q.pipeAll=GX.bind(void 0,Q,"all")};import{createReadStream as AN,readFileSync as wN}from"node:fs";import{setTimeout as jN}from"node:timers/promises";var K4=async(Q,{init:X,convertChunk:$,getSize:Y,truncateChunk:G,addChunk:J,getFinalChunk:W,finalize:H},{maxBuffer:z=Number.POSITIVE_INFINITY}={})=>{if(!YN(Q))throw Error("The first argument must be a Readable, a ReadableStream, or an async iterable.");let B=X();B.length=0;try{for await(let K of Q){let q=GN(K),U=$[q](K,B);RJ({convertedChunk:U,state:B,getSize:Y,truncateChunk:G,addChunk:J,maxBuffer:z})}return $N({state:B,convertChunk:$,getSize:Y,truncateChunk:G,addChunk:J,getFinalChunk:W,maxBuffer:z}),H(B)}catch(K){throw K.bufferedData=H(B),K}},$N=({state:Q,getSize:X,truncateChunk:$,addChunk:Y,getFinalChunk:G,maxBuffer:J})=>{let W=G(Q);if(W!==void 0)RJ({convertedChunk:W,state:Q,getSize:X,truncateChunk:$,addChunk:Y,maxBuffer:J})},RJ=({convertedChunk:Q,state:X,getSize:$,truncateChunk:Y,addChunk:G,maxBuffer:J})=>{let W=$(Q),H=X.length+W;if(H<=J){IJ(Q,X,G,H);return}let z=Y(Q,J-X.length);if(z!==void 0)IJ(z,X,G,J);throw new JX},IJ=(Q,X,$,Y)=>{X.contents=$(Q,X,Y),X.length=Y},YN=(Q)=>typeof Q==="object"&&Q!==null&&typeof Q[Symbol.asyncIterator]==="function",GN=(Q)=>{let X=typeof Q;if(X==="string")return"string";if(X!=="object"||Q===null)return"others";if(globalThis.Buffer?.isBuffer(Q))return"buffer";let $=bJ.call(Q);if($==="[object ArrayBuffer]")return"arrayBuffer";if($==="[object DataView]")return"dataView";if(Number.isInteger(Q.byteLength)&&Number.isInteger(Q.byteOffset)&&bJ.call(Q.buffer)==="[object ArrayBuffer]")return"typedArray";return"others"},{toString:bJ}=Object.prototype;class JX extends Error{name="MaxBufferError";constructor(){super("maxBuffer exceeded")}}var WX=(Q)=>Q,HX=()=>{return},zX=({contents:Q})=>Q,u8=(Q)=>{throw Error(`Streams in object mode are not supported: ${String(Q)}`)},l8=(Q)=>Q.length;async function BX(Q,X){return K4(Q,UN,X)}var JN=()=>({contents:new ArrayBuffer(0)}),WN=(Q)=>HN.encode(Q),HN=new TextEncoder,EJ=(Q)=>new Uint8Array(Q),PJ=(Q)=>new Uint8Array(Q.buffer,Q.byteOffset,Q.byteLength),zN=(Q,X)=>Q.slice(0,X),BN=(Q,{contents:X,length:$},Y)=>{let G=CJ()?VN(X,Y):KN(X,Y);return new Uint8Array(G).set(Q,$),G},KN=(Q,X)=>{if(X<=Q.byteLength)return Q;let $=new ArrayBuffer(ZJ(X));return new Uint8Array($).set(new Uint8Array(Q),0),$},VN=(Q,X)=>{if(X<=Q.maxByteLength)return Q.resize(X),Q;let $=new ArrayBuffer(X,{maxByteLength:ZJ(X)});return new Uint8Array($).set(new Uint8Array(Q),0),$},ZJ=(Q)=>SJ**Math.ceil(Math.log(Q)/Math.log(SJ)),SJ=2,qN=({contents:Q,length:X})=>CJ()?Q:Q.slice(0,X),CJ=()=>("resize"in ArrayBuffer.prototype),UN={init:JN,convertChunk:{string:WN,buffer:EJ,arrayBuffer:EJ,dataView:PJ,typedArray:PJ,others:u8},getSize:l8,truncateChunk:zN,addChunk:BN,getFinalChunk:HX,finalize:qN};async function m8(Q,X){if(!("Buffer"in globalThis))throw Error("getStreamAsBuffer() is only supported in Node.js");try{return _J(await BX(Q,X))}catch($){if($.bufferedData!==void 0)$.bufferedData=_J($.bufferedData);throw $}}var _J=(Q)=>globalThis.Buffer.from(Q);async function KX(Q,X){return K4(Q,ON,X)}var LN=()=>({contents:"",textDecoder:new TextDecoder}),c8=(Q,{textDecoder:X})=>X.decode(Q,{stream:!0}),FN=(Q,{contents:X})=>X+Q,NN=(Q,X)=>Q.slice(0,X),DN=({textDecoder:Q})=>{let X=Q.decode();return X===""?void 0:X},ON={init:LN,convertChunk:{string:WX,buffer:c8,arrayBuffer:c8,dataView:c8,typedArray:c8,others:u8},getSize:l8,truncateChunk:NN,addChunk:FN,getFinalChunk:DN,finalize:zX};var TJ=b8(vJ(),1),xJ=(Q)=>{if(Q!==void 0)throw TypeError("The `input` and `inputFile` options cannot be both set.")},IN=({input:Q,inputFile:X})=>{if(typeof X!=="string")return Q;return xJ(Q),wN(X)},yJ=(Q)=>{let X=IN(Q);if(h8(X))throw TypeError("The `input` option cannot be a stream in sync mode");return X},bN=({input:Q,inputFile:X})=>{if(typeof X!=="string")return Q;return xJ(Q),AN(X)},gJ=(Q,X)=>{let $=bN(X);if($===void 0)return;if(h8($))$.pipe(Q.stdin);else Q.stdin.end($)},fJ=(Q,{all:X})=>{if(!X||!Q.stdout&&!Q.stderr)return;let $=TJ.default();if(Q.stdout)$.add(Q.stdout);if(Q.stderr)$.add(Q.stderr);return $},VX=async(Q,X)=>{if(!Q||X===void 0)return;await jN(0),Q.destroy();try{return await X}catch($){return $.bufferedData}},qX=(Q,{encoding:X,buffer:$,maxBuffer:Y})=>{if(!Q||!$)return;if(X==="utf8"||X==="utf-8")return KX(Q,{maxBuffer:Y});if(X===null||X==="buffer")return m8(Q,{maxBuffer:Y});return RN(Q,Y,X)},RN=async(Q,X,$)=>{return(await m8(Q,{maxBuffer:X})).toString($)},hJ=async({stdout:Q,stderr:X,all:$},{encoding:Y,buffer:G,maxBuffer:J},W)=>{let H=qX(Q,{encoding:Y,buffer:G,maxBuffer:J}),z=qX(X,{encoding:Y,buffer:G,maxBuffer:J}),B=qX($,{encoding:Y,buffer:G,maxBuffer:J*2});try{return await Promise.all([W,H,z,B])}catch(K){return Promise.all([{error:K,signal:K.signal,timedOut:K.timedOut},VX(Q,H),VX(X,z),VX($,B)])}};var EN=(async()=>{})().constructor.prototype,PN=["then","catch","finally"].map((Q)=>[Q,Reflect.getOwnPropertyDescriptor(EN,Q)]),UX=(Q,X)=>{for(let[$,Y]of PN){let G=typeof X==="function"?(...J)=>Reflect.apply(Y.value,X(),J):Y.value.bind(X);Reflect.defineProperty(Q,$,{...Y,value:G})}},uJ=(Q)=>new Promise((X,$)=>{if(Q.on("exit",(Y,G)=>{X({exitCode:Y,signal:G})}),Q.on("error",(Y)=>{$(Y)}),Q.stdin)Q.stdin.on("error",(Y)=>{$(Y)})});import{Buffer as SN}from"node:buffer";import{ChildProcess as ZN}from"node:child_process";var cJ=(Q,X=[])=>{if(!Array.isArray(X))return[Q];return[Q,...X]},CN=/^[\w.-]+$/,_N=(Q)=>{if(typeof Q!=="string"||CN.test(Q))return Q;return`"${Q.replaceAll('"',"\\\"")}"`},LX=(Q,X)=>cJ(Q,X).join(" "),FX=(Q,X)=>cJ(Q,X).map(($)=>_N($)).join(" "),kN=/ +/g;var lJ=(Q)=>{let X=typeof Q;if(X==="string")return Q;if(X==="number")return String(Q);if(X==="object"&&Q!==null&&!(Q instanceof ZN)&&"stdout"in Q){let $=typeof Q.stdout;if($==="string")return Q.stdout;if(SN.isBuffer(Q.stdout))return Q.stdout.toString();throw TypeError(`Unexpected "${$}" stdout in template expression`)}throw TypeError(`Unexpected "${X}" in template expression`)},mJ=(Q,X,$)=>$||Q.length===0||X.length===0?[...Q,...X]:[...Q.slice(0,-1),`${Q.at(-1)}${X[0]}`,...X.slice(1)],vN=({templates:Q,expressions:X,tokens:$,index:Y,template:G})=>{let J=G??Q.raw[Y],W=J.split(kN).filter(Boolean),H=mJ($,W,J.startsWith(" "));if(Y===X.length)return H;let z=X[Y],B=Array.isArray(z)?z.map((K)=>lJ(K)):[lJ(z)];return mJ(H,B,J.endsWith(" "))},NX=(Q,X)=>{let $=[];for(let[Y,G]of Q.entries())$=vN({templates:Q,expressions:X,tokens:$,index:Y,template:G});return $};import{debuglog as TN}from"node:util";import xN from"node:process";var pJ=TN("execa").enabled,p8=(Q,X)=>String(Q).padStart(X,"0"),yN=()=>{let Q=new Date;return`${p8(Q.getHours(),2)}:${p8(Q.getMinutes(),2)}:${p8(Q.getSeconds(),2)}.${p8(Q.getMilliseconds(),3)}`},DX=(Q,{verbose:X})=>{if(!X)return;xN.stderr.write(`[${yN()}] ${Q}
`)};var hN=1e8,uN=({env:Q,extendEnv:X,preferLocal:$,localDir:Y,execPath:G})=>{let J=X?{...d8.env,...Q}:Q;if($)return JJ({env:J,cwd:Y,execPath:G});return J},nJ=(Q,X,$={})=>{let Y=iJ.default._parse(Q,X,$);if(Q=Y.command,X=Y.args,$=Y.options,$={maxBuffer:hN,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:$.cwd||d8.cwd(),execPath:d8.execPath,encoding:"utf8",reject:!0,cleanup:!0,all:!1,windowsHide:!0,verbose:pJ,...$},$.env=uN($),$.stdio=qJ($),d8.platform==="win32"&&fN.basename(Q,".exe")==="cmd")X.unshift("/q");return{file:Q,args:X,options:$,parsed:Y}},V4=(Q,X,$)=>{if(typeof X!=="string"&&!gN.isBuffer(X))return $===void 0?void 0:"";if(Q.stripFinalNewline)return rQ(X);return X};function oJ(Q,X,$){let Y=nJ(Q,X,$),G=LX(Q,X),J=FX(Q,X);DX(J,Y.options),AJ(Y.options);let W;try{W=OX.spawn(Y.file,Y.args,Y.options)}catch(V){let L=new OX.ChildProcess,F=Promise.reject(B4({error:V,stdout:"",stderr:"",all:"",command:G,escapedCommand:J,parsed:Y,timedOut:!1,isCanceled:!1,killed:!1}));return UX(L,F),L}let H=uJ(W),z=MJ(W,Y.options,H),B=wJ(W,Y.options,z),K={isCanceled:!1};W.kill=DJ.bind(null,W.kill.bind(W)),W.cancel=OJ.bind(null,W,K);let U=HJ(async()=>{let[{error:V,exitCode:L,signal:F,timedOut:M},O,j,I]=await hJ(W,Y.options,B),v=V4(Y.options,O),k=V4(Y.options,j),q1=V4(Y.options,I);if(V||L!==0||F!==null){let F1=B4({error:V,exitCode:L,signal:F,stdout:v,stderr:k,all:q1,command:G,escapedCommand:J,parsed:Y,timedOut:M,isCanceled:K.isCanceled||(Y.options.signal?Y.options.signal.aborted:!1),killed:W.killed});if(!Y.options.reject)return F1;throw F1}return{command:G,escapedCommand:J,exitCode:0,stdout:v,stderr:k,all:q1,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}});return gJ(W,Y.options),W.all=fJ(W,Y.options),jJ(W),UX(W,U),W}function lN(Q,X,$){let Y=nJ(Q,X,$),G=LX(Q,X),J=FX(Q,X);DX(J,Y.options);let W=yJ(Y.options),H;try{H=OX.spawnSync(Y.file,Y.args,{...Y.options,input:W})}catch(K){throw B4({error:K,stdout:"",stderr:"",all:"",command:G,escapedCommand:J,parsed:Y,timedOut:!1,isCanceled:!1,killed:!1})}let z=V4(Y.options,H.stdout,H.error),B=V4(Y.options,H.stderr,H.error);if(H.error||H.status!==0||H.signal!==null){let K=B4({stdout:z,stderr:B,error:H.error,signal:H.signal,exitCode:H.status,command:G,escapedCommand:J,parsed:Y,timedOut:H.error&&H.error.code==="ETIMEDOUT",isCanceled:!1,killed:H.signal!==null});if(!Y.options.reject)return K;throw K}return{command:G,escapedCommand:J,exitCode:0,stdout:z,stderr:B,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}}var mN=({input:Q,inputFile:X,stdio:$})=>Q===void 0&&X===void 0&&$===void 0?{stdin:"inherit"}:{},dJ=(Q={})=>({preferLocal:!0,...mN(Q),...Q});function rJ(Q){function X($,...Y){if(!Array.isArray($))return rJ({...Q,...$});let[G,...J]=NX($,Y);return oJ(G,J,dJ(Q))}return X.sync=($,...Y)=>{if(!Array.isArray($))throw TypeError("Please use $(options).sync`command` instead of $.sync(options)`command`.");let[G,...J]=NX($,Y);return lN(G,J,dJ(Q))},X}var vv=rJ();import{execSync as cN}from"child_process";function MX(Q,X){let Y=[];try{const $=e(Y,W1`execSync: ${Q.slice(0,100)}`,0);return cN(Q,X)}catch(G){var J=G,W=1}finally{Q1(Y,J,W)}}function pN(Q){if(process.platform==="win32")try{return MX(`where.exe ${Q}`,{encoding:"utf-8",stdio:["ignore","pipe","ignore"]}).toString().trim().split(/\r?\n/)[0]||null}catch{return null}try{return MX(`which ${Q}`,{encoding:"utf-8",stdio:["ignore","pipe","ignore"]}).toString().trim()||null}catch{return null}}function tJ(Q){if(typeof Bun<"u")return Bun.which(Q);return pN(Q)}function sN(Q){try{let X=i8(aN(),"claude-agent-sdk"),$=i8(X,"cli.js");tN(X,{recursive:!0});let Y=nN(Q);return oN($,Y),rN($,493),$}catch{return}}function n8(Q){let X=dN(Q),$=iN(X),Y=i8($,"cli.js");if(!Y.includes("/$bunfs/"))return Y;let G=[Y,i8($,"node_modules","@anthropic-ai","claude-agent-sdk","cli.js")];for(let W of G){let H=sN(W);if(H)return H}let J=tJ("claude");if(J)return J;throw ReferenceError(`Claude Code executable not found. When using bun build --compile, import.meta.url resolves to a virtual path (${Y}) where cli.js cannot be found.

To fix this, do one of the following:
  1. Set pathToClaudeCodeExecutable in your query/session options to the path of your Claude Code installation
  2. Install Claude Code on the target machine: npm install -g @anthropic-ai/claude-code
  3. Include cli.js in your compiled binary: bun build --compile index.ts ./node_modules/@anthropic-ai/claude-agent-sdk/cli.js`)}class AX{closed=!1;inputStream;query;queryIterator=null;abortController;_sessionId=null;get sessionId(){if(this._sessionId===null)throw Error("Session ID not available until after receiving messages");return this._sessionId}constructor(Q){if(Q.resume)this._sessionId=Q.resume;this.inputStream=new W4;let X=Q.pathToClaudeCodeExecutable;if(!X)X=n8(import.meta.url);let $={...Q.env??process.env};if(!$.CLAUDE_CODE_ENTRYPOINT)$.CLAUDE_CODE_ENTRYPOINT="sdk-ts";this.abortController=w6();let Y=new J4({abortController:this.abortController,pathToClaudeCodeExecutable:X,env:$,executable:Q.executable??(P6()?"bun":"node"),executableArgs:Q.executableArgs??[],extraArgs:{},thinkingConfig:void 0,maxTurns:void 0,maxBudgetUsd:void 0,model:Q.model,fallbackModel:void 0,permissionMode:Q.permissionMode??"default",allowDangerouslySkipPermissions:!1,continueConversation:!1,resume:Q.resume,settingSources:[],allowedTools:Q.allowedTools??[],disallowedTools:Q.disallowedTools??[],mcpServers:{},strictMcpConfig:!1,canUseTool:!!Q.canUseTool,hooks:!!Q.hooks,includePartialMessages:!1,forkSession:!1,resumeSessionAt:void 0});this.query=new H4(Y,!1,Q.canUseTool,Q.hooks,this.abortController,new Map),this.query.streamInput(this.inputStream)}async send(Q){if(this.closed)throw Error("Cannot send to closed session");let X=typeof Q==="string"?{type:"user",session_id:"",message:{role:"user",content:[{type:"text",text:Q}]},parent_tool_use_id:null}:Q;this.inputStream.enqueue(X)}async*stream(){if(!this.queryIterator)this.queryIterator=this.query[Symbol.asyncIterator]();while(!0){let{value:Q,done:X}=await this.queryIterator.next();if(X)return;if(Q.type==="system"&&Q.subtype==="init")this._sessionId=Q.session_id;if(yield Q,Q.type==="result")return}}close(){if(this.closed)return;this.closed=!0,this.inputStream.done(),this.abortController.abort()}async[Symbol.asyncDispose](){this.close()}}function wX(Q){return new AX(Q)}function aJ(Q,X){return new AX({...X,resume:Q})}var i;(function(Q){Q.assertEqual=(G)=>{};function X(G){}Q.assertIs=X;function $(G){throw Error()}Q.assertNever=$,Q.arrayToEnum=(G)=>{let J={};for(let W of G)J[W]=W;return J},Q.getValidEnumValues=(G)=>{let J=Q.objectKeys(G).filter((H)=>typeof G[G[H]]!=="number"),W={};for(let H of J)W[H]=G[H];return Q.objectValues(W)},Q.objectValues=(G)=>{return Q.objectKeys(G).map(function(J){return G[J]})},Q.objectKeys=typeof Object.keys==="function"?(G)=>Object.keys(G):(G)=>{let J=[];for(let W in G)if(Object.prototype.hasOwnProperty.call(G,W))J.push(W);return J},Q.find=(G,J)=>{for(let W of G)if(J(W))return W;return},Q.isInteger=typeof Number.isInteger==="function"?(G)=>Number.isInteger(G):(G)=>typeof G==="number"&&Number.isFinite(G)&&Math.floor(G)===G;function Y(G,J=" | "){return G.map((W)=>typeof W==="string"?`'${W}'`:W).join(J)}Q.joinValues=Y,Q.jsonStringifyReplacer=(G,J)=>{if(typeof J==="bigint")return J.toString();return J}})(i||(i={}));var sJ;(function(Q){Q.mergeShapes=(X,$)=>{return{...X,...$}}})(sJ||(sJ={}));var R=i.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),M0=(Q)=>{switch(typeof Q){case"undefined":return R.undefined;case"string":return R.string;case"number":return Number.isNaN(Q)?R.nan:R.number;case"boolean":return R.boolean;case"function":return R.function;case"bigint":return R.bigint;case"symbol":return R.symbol;case"object":if(Array.isArray(Q))return R.array;if(Q===null)return R.null;if(Q.then&&typeof Q.then==="function"&&Q.catch&&typeof Q.catch==="function")return R.promise;if(typeof Map<"u"&&Q instanceof Map)return R.map;if(typeof Set<"u"&&Q instanceof Set)return R.set;if(typeof Date<"u"&&Q instanceof Date)return R.date;return R.object;default:return R.unknown}};var A=i.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class h1 extends Error{get errors(){return this.issues}constructor(Q){super();this.issues=[],this.addIssue=($)=>{this.issues=[...this.issues,$]},this.addIssues=($=[])=>{this.issues=[...this.issues,...$]};let X=new.target.prototype;if(Object.setPrototypeOf)Object.setPrototypeOf(this,X);else this.__proto__=X;this.name="ZodError",this.issues=Q}format(Q){let X=Q||function(G){return G.message},$={_errors:[]},Y=(G)=>{for(let J of G.issues)if(J.code==="invalid_union")J.unionErrors.map(Y);else if(J.code==="invalid_return_type")Y(J.returnTypeError);else if(J.code==="invalid_arguments")Y(J.argumentsError);else if(J.path.length===0)$._errors.push(X(J));else{let W=$,H=0;while(H<J.path.length){let z=J.path[H];if(H!==J.path.length-1)W[z]=W[z]||{_errors:[]};else W[z]=W[z]||{_errors:[]},W[z]._errors.push(X(J));W=W[z],H++}}};return Y(this),$}static assert(Q){if(!(Q instanceof h1))throw Error(`Not a ZodError: ${Q}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,i.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(Q=(X)=>X.message){let X={},$=[];for(let Y of this.issues)if(Y.path.length>0){let G=Y.path[0];X[G]=X[G]||[],X[G].push(Q(Y))}else $.push(Q(Y));return{formErrors:$,fieldErrors:X}}get formErrors(){return this.flatten()}}h1.create=(Q)=>{return new h1(Q)};var eN=(Q,X)=>{let $;switch(Q.code){case A.invalid_type:if(Q.received===R.undefined)$="Required";else $=`Expected ${Q.expected}, received ${Q.received}`;break;case A.invalid_literal:$=`Invalid literal value, expected ${JSON.stringify(Q.expected,i.jsonStringifyReplacer)}`;break;case A.unrecognized_keys:$=`Unrecognized key(s) in object: ${i.joinValues(Q.keys,", ")}`;break;case A.invalid_union:$="Invalid input";break;case A.invalid_union_discriminator:$=`Invalid discriminator value. Expected ${i.joinValues(Q.options)}`;break;case A.invalid_enum_value:$=`Invalid enum value. Expected ${i.joinValues(Q.options)}, received '${Q.received}'`;break;case A.invalid_arguments:$="Invalid function arguments";break;case A.invalid_return_type:$="Invalid function return type";break;case A.invalid_date:$="Invalid date";break;case A.invalid_string:if(typeof Q.validation==="object")if("includes"in Q.validation){if($=`Invalid input: must include "${Q.validation.includes}"`,typeof Q.validation.position==="number")$=`${$} at one or more positions greater than or equal to ${Q.validation.position}`}else if("startsWith"in Q.validation)$=`Invalid input: must start with "${Q.validation.startsWith}"`;else if("endsWith"in Q.validation)$=`Invalid input: must end with "${Q.validation.endsWith}"`;else i.assertNever(Q.validation);else if(Q.validation!=="regex")$=`Invalid ${Q.validation}`;else $="Invalid";break;case A.too_small:if(Q.type==="array")$=`Array must contain ${Q.exact?"exactly":Q.inclusive?"at least":"more than"} ${Q.minimum} element(s)`;else if(Q.type==="string")$=`String must contain ${Q.exact?"exactly":Q.inclusive?"at least":"over"} ${Q.minimum} character(s)`;else if(Q.type==="number")$=`Number must be ${Q.exact?"exactly equal to ":Q.inclusive?"greater than or equal to ":"greater than "}${Q.minimum}`;else if(Q.type==="bigint")$=`Number must be ${Q.exact?"exactly equal to ":Q.inclusive?"greater than or equal to ":"greater than "}${Q.minimum}`;else if(Q.type==="date")$=`Date must be ${Q.exact?"exactly equal to ":Q.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(Q.minimum))}`;else $="Invalid input";break;case A.too_big:if(Q.type==="array")$=`Array must contain ${Q.exact?"exactly":Q.inclusive?"at most":"less than"} ${Q.maximum} element(s)`;else if(Q.type==="string")$=`String must contain ${Q.exact?"exactly":Q.inclusive?"at most":"under"} ${Q.maximum} character(s)`;else if(Q.type==="number")$=`Number must be ${Q.exact?"exactly":Q.inclusive?"less than or equal to":"less than"} ${Q.maximum}`;else if(Q.type==="bigint")$=`BigInt must be ${Q.exact?"exactly":Q.inclusive?"less than or equal to":"less than"} ${Q.maximum}`;else if(Q.type==="date")$=`Date must be ${Q.exact?"exactly":Q.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(Q.maximum))}`;else $="Invalid input";break;case A.custom:$="Invalid input";break;case A.invalid_intersection_types:$="Intersection results could not be merged";break;case A.not_multiple_of:$=`Number must be a multiple of ${Q.multipleOf}`;break;case A.not_finite:$="Number must be finite";break;default:$=X.defaultError,i.assertNever(Q)}return{message:$}},T0=eN;var QD=T0;function q4(){return QD}var o8=(Q)=>{let{data:X,path:$,errorMaps:Y,issueData:G}=Q,J=[...$,...G.path||[]],W={...G,path:J};if(G.message!==void 0)return{...G,path:J,message:G.message};let H="",z=Y.filter((B)=>!!B).slice().reverse();for(let B of z)H=B(W,{data:X,defaultError:H}).message;return{...G,path:J,message:H}};function E(Q,X){let $=q4(),Y=o8({issueData:X,data:Q.data,path:Q.path,errorMaps:[Q.common.contextualErrorMap,Q.schemaErrorMap,$,$===T0?void 0:T0].filter((G)=>!!G)});Q.common.issues.push(Y)}class E1{constructor(){this.value="valid"}dirty(){if(this.value==="valid")this.value="dirty"}abort(){if(this.value!=="aborted")this.value="aborted"}static mergeArray(Q,X){let $=[];for(let Y of X){if(Y.status==="aborted")return y;if(Y.status==="dirty")Q.dirty();$.push(Y.value)}return{status:Q.value,value:$}}static async mergeObjectAsync(Q,X){let $=[];for(let Y of X){let G=await Y.key,J=await Y.value;$.push({key:G,value:J})}return E1.mergeObjectSync(Q,$)}static mergeObjectSync(Q,X){let $={};for(let Y of X){let{key:G,value:J}=Y;if(G.status==="aborted")return y;if(J.status==="aborted")return y;if(G.status==="dirty")Q.dirty();if(J.status==="dirty")Q.dirty();if(G.value!=="__proto__"&&(typeof J.value<"u"||Y.alwaysSet))$[G.value]=J.value}return{status:Q.value,value:$}}}var y=Object.freeze({status:"aborted"}),C6=(Q)=>({status:"dirty",value:Q}),Z1=(Q)=>({status:"valid",value:Q}),jX=(Q)=>Q.status==="aborted",IX=(Q)=>Q.status==="dirty",Y6=(Q)=>Q.status==="valid",U4=(Q)=>typeof Promise<"u"&&Q instanceof Promise;var S;(function(Q){Q.errToObj=(X)=>typeof X==="string"?{message:X}:X||{},Q.toString=(X)=>typeof X==="string"?X:X?.message})(S||(S={}));class t1{constructor(Q,X,$,Y){this._cachedPath=[],this.parent=Q,this.data=X,this._path=$,this._key=Y}get path(){if(!this._cachedPath.length)if(Array.isArray(this._key))this._cachedPath.push(...this._path,...this._key);else this._cachedPath.push(...this._path,this._key);return this._cachedPath}}var eJ=(Q,X)=>{if(Y6(X))return{success:!0,data:X.value};else{if(!Q.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let $=new h1(Q.common.issues);return this._error=$,this._error}}}};function l(Q){if(!Q)return{};let{errorMap:X,invalid_type_error:$,required_error:Y,description:G}=Q;if(X&&($||Y))throw Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);if(X)return{errorMap:X,description:G};return{errorMap:(W,H)=>{let{message:z}=Q;if(W.code==="invalid_enum_value")return{message:z??H.defaultError};if(typeof H.data>"u")return{message:z??Y??H.defaultError};if(W.code!=="invalid_type")return{message:H.defaultError};return{message:z??$??H.defaultError}},description:G}}class p{get description(){return this._def.description}_getType(Q){return M0(Q.data)}_getOrReturnCtx(Q,X){return X||{common:Q.parent.common,data:Q.data,parsedType:M0(Q.data),schemaErrorMap:this._def.errorMap,path:Q.path,parent:Q.parent}}_processInputParams(Q){return{status:new E1,ctx:{common:Q.parent.common,data:Q.data,parsedType:M0(Q.data),schemaErrorMap:this._def.errorMap,path:Q.path,parent:Q.parent}}}_parseSync(Q){let X=this._parse(Q);if(U4(X))throw Error("Synchronous parse encountered promise.");return X}_parseAsync(Q){let X=this._parse(Q);return Promise.resolve(X)}parse(Q,X){let $=this.safeParse(Q,X);if($.success)return $.data;throw $.error}safeParse(Q,X){let $={common:{issues:[],async:X?.async??!1,contextualErrorMap:X?.errorMap},path:X?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:Q,parsedType:M0(Q)},Y=this._parseSync({data:Q,path:$.path,parent:$});return eJ($,Y)}"~validate"(Q){let X={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:Q,parsedType:M0(Q)};if(!this["~standard"].async)try{let $=this._parseSync({data:Q,path:[],parent:X});return Y6($)?{value:$.value}:{issues:X.common.issues}}catch($){if($?.message?.toLowerCase()?.includes("encountered"))this["~standard"].async=!0;X.common={issues:[],async:!0}}return this._parseAsync({data:Q,path:[],parent:X}).then(($)=>Y6($)?{value:$.value}:{issues:X.common.issues})}async parseAsync(Q,X){let $=await this.safeParseAsync(Q,X);if($.success)return $.data;throw $.error}async safeParseAsync(Q,X){let $={common:{issues:[],contextualErrorMap:X?.errorMap,async:!0},path:X?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:Q,parsedType:M0(Q)},Y=this._parse({data:Q,path:$.path,parent:$}),G=await(U4(Y)?Y:Promise.resolve(Y));return eJ($,G)}refine(Q,X){let $=(Y)=>{if(typeof X==="string"||typeof X>"u")return{message:X};else if(typeof X==="function")return X(Y);else return X};return this._refinement((Y,G)=>{let J=Q(Y),W=()=>G.addIssue({code:A.custom,...$(Y)});if(typeof Promise<"u"&&J instanceof Promise)return J.then((H)=>{if(!H)return W(),!1;else return!0});if(!J)return W(),!1;else return!0})}refinement(Q,X){return this._refinement(($,Y)=>{if(!Q($))return Y.addIssue(typeof X==="function"?X($,Y):X),!1;else return!0})}_refinement(Q){return new z0({schema:this,typeName:w.ZodEffects,effect:{type:"refinement",refinement:Q}})}superRefine(Q){return this._refinement(Q)}constructor(Q){this.spa=this.safeParseAsync,this._def=Q,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:(X)=>this["~validate"](X)}}optional(){return p1.create(this,this._def)}nullable(){return x0.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return H0.create(this)}promise(){return x6.create(this,this._def)}or(Q){return O4.create([this,Q],this._def)}and(Q){return M4.create(this,Q,this._def)}transform(Q){return new z0({...l(this._def),schema:this,typeName:w.ZodEffects,effect:{type:"transform",transform:Q}})}default(Q){let X=typeof Q==="function"?Q:()=>Q;return new I4({...l(this._def),innerType:this,defaultValue:X,typeName:w.ZodDefault})}brand(){return new PX({typeName:w.ZodBranded,type:this,...l(this._def)})}catch(Q){let X=typeof Q==="function"?Q:()=>Q;return new b4({...l(this._def),innerType:this,catchValue:X,typeName:w.ZodCatch})}describe(Q){return new this.constructor({...this._def,description:Q})}pipe(Q){return $9.create(this,Q)}readonly(){return R4.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}var XD=/^c[^\s-]{8,}$/i,$D=/^[0-9a-z]+$/,YD=/^[0-9A-HJKMNP-TV-Z]{26}$/i,GD=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,JD=/^[a-z0-9_-]{21}$/i,WD=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,HD=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,zD=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,BD="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",bX,KD=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,VD=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,qD=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,UD=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,LD=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,FD=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,QW="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ND=new RegExp(`^${QW}$`);function XW(Q){let X="[0-5]\\d";if(Q.precision)X=`${X}\\.\\d{${Q.precision}}`;else if(Q.precision==null)X=`${X}(\\.\\d+)?`;let $=Q.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${X})${$}`}function DD(Q){return new RegExp(`^${XW(Q)}$`)}function OD(Q){let X=`${QW}T${XW(Q)}`,$=[];if($.push(Q.local?"Z?":"Z"),Q.offset)$.push("([+-]\\d{2}:?\\d{2})");return X=`${X}(${$.join("|")})`,new RegExp(`^${X}$`)}function MD(Q,X){if((X==="v4"||!X)&&KD.test(Q))return!0;if((X==="v6"||!X)&&qD.test(Q))return!0;return!1}function AD(Q,X){if(!WD.test(Q))return!1;try{let[$]=Q.split(".");if(!$)return!1;let Y=$.replace(/-/g,"+").replace(/_/g,"/").padEnd($.length+(4-$.length%4)%4,"="),G=JSON.parse(atob(Y));if(typeof G!=="object"||G===null)return!1;if("typ"in G&&G?.typ!=="JWT")return!1;if(!G.alg)return!1;if(X&&G.alg!==X)return!1;return!0}catch{return!1}}function wD(Q,X){if((X==="v4"||!X)&&VD.test(Q))return!0;if((X==="v6"||!X)&&UD.test(Q))return!0;return!1}class w0 extends p{_parse(Q){if(this._def.coerce)Q.data=String(Q.data);if(this._getType(Q)!==R.string){let G=this._getOrReturnCtx(Q);return E(G,{code:A.invalid_type,expected:R.string,received:G.parsedType}),y}let $=new E1,Y=void 0;for(let G of this._def.checks)if(G.kind==="min"){if(Q.data.length<G.value)Y=this._getOrReturnCtx(Q,Y),E(Y,{code:A.too_small,minimum:G.value,type:"string",inclusive:!0,exact:!1,message:G.message}),$.dirty()}else if(G.kind==="max"){if(Q.data.length>G.value)Y=this._getOrReturnCtx(Q,Y),E(Y,{code:A.too_big,maximum:G.value,type:"string",inclusive:!0,exact:!1,message:G.message}),$.dirty()}else if(G.kind==="length"){let J=Q.data.length>G.value,W=Q.data.length<G.value;if(J||W){if(Y=this._getOrReturnCtx(Q,Y),J)E(Y,{code:A.too_big,maximum:G.value,type:"string",inclusive:!0,exact:!0,message:G.message});else if(W)E(Y,{code:A.too_small,minimum:G.value,type:"string",inclusive:!0,exact:!0,message:G.message});$.dirty()}}else if(G.kind==="email"){if(!zD.test(Q.data))Y=this._getOrReturnCtx(Q,Y),E(Y,{validation:"email",code:A.invalid_string,message:G.message}),$.dirty()}else if(G.kind==="emoji"){if(!bX)bX=new RegExp(BD,"u");if(!bX.test(Q.data))Y=this._getOrReturnCtx(Q,Y),E(Y,{validation:"emoji",code:A.invalid_string,message:G.message}),$.dirty()}else if(G.kind==="uuid"){if(!GD.test(Q.data))Y=this._getOrReturnCtx(Q,Y),E(Y,{validation:"uuid",code:A.invalid_string,message:G.message}),$.dirty()}else if(G.kind==="nanoid"){if(!JD.test(Q.data))Y=this._getOrReturnCtx(Q,Y),E(Y,{validation:"nanoid",code:A.invalid_string,message:G.message}),$.dirty()}else if(G.kind==="cuid"){if(!XD.test(Q.data))Y=this._getOrReturnCtx(Q,Y),E(Y,{validation:"cuid",code:A.invalid_string,message:G.message}),$.dirty()}else if(G.kind==="cuid2"){if(!$D.test(Q.data))Y=this._getOrReturnCtx(Q,Y),E(Y,{validation:"cuid2",code:A.invalid_string,message:G.message}),$.dirty()}else if(G.kind==="ulid"){if(!YD.test(Q.data))Y=this._getOrReturnCtx(Q,Y),E(Y,{validation:"ulid",code:A.invalid_string,message:G.message}),$.dirty()}else if(G.kind==="url")try{new URL(Q.data)}catch{Y=this._getOrReturnCtx(Q,Y),E(Y,{validation:"url",code:A.invalid_string,message:G.message}),$.dirty()}else if(G.kind==="regex"){if(G.regex.lastIndex=0,!G.regex.test(Q.data))Y=this._getOrReturnCtx(Q,Y),E(Y,{validation:"regex",code:A.invalid_string,message:G.message}),$.dirty()}else if(G.kind==="trim")Q.data=Q.data.trim();else if(G.kind==="includes"){if(!Q.data.includes(G.value,G.position))Y=this._getOrReturnCtx(Q,Y),E(Y,{code:A.invalid_string,validation:{includes:G.value,position:G.position},message:G.message}),$.dirty()}else if(G.kind==="toLowerCase")Q.data=Q.data.toLowerCase();else if(G.kind==="toUpperCase")Q.data=Q.data.toUpperCase();else if(G.kind==="startsWith"){if(!Q.data.startsWith(G.value))Y=this._getOrReturnCtx(Q,Y),E(Y,{code:A.invalid_string,validation:{startsWith:G.value},message:G.message}),$.dirty()}else if(G.kind==="endsWith"){if(!Q.data.endsWith(G.value))Y=this._getOrReturnCtx(Q,Y),E(Y,{code:A.invalid_string,validation:{endsWith:G.value},message:G.message}),$.dirty()}else if(G.kind==="datetime"){if(!OD(G).test(Q.data))Y=this._getOrReturnCtx(Q,Y),E(Y,{code:A.invalid_string,validation:"datetime",message:G.message}),$.dirty()}else if(G.kind==="date"){if(!ND.test(Q.data))Y=this._getOrReturnCtx(Q,Y),E(Y,{code:A.invalid_string,validation:"date",message:G.message}),$.dirty()}else if(G.kind==="time"){if(!DD(G).test(Q.data))Y=this._getOrReturnCtx(Q,Y),E(Y,{code:A.invalid_string,validation:"time",message:G.message}),$.dirty()}else if(G.kind==="duration"){if(!HD.test(Q.data))Y=this._getOrReturnCtx(Q,Y),E(Y,{validation:"duration",code:A.invalid_string,message:G.message}),$.dirty()}else if(G.kind==="ip"){if(!MD(Q.data,G.version))Y=this._getOrReturnCtx(Q,Y),E(Y,{validation:"ip",code:A.invalid_string,message:G.message}),$.dirty()}else if(G.kind==="jwt"){if(!AD(Q.data,G.alg))Y=this._getOrReturnCtx(Q,Y),E(Y,{validation:"jwt",code:A.invalid_string,message:G.message}),$.dirty()}else if(G.kind==="cidr"){if(!wD(Q.data,G.version))Y=this._getOrReturnCtx(Q,Y),E(Y,{validation:"cidr",code:A.invalid_string,message:G.message}),$.dirty()}else if(G.kind==="base64"){if(!LD.test(Q.data))Y=this._getOrReturnCtx(Q,Y),E(Y,{validation:"base64",code:A.invalid_string,message:G.message}),$.dirty()}else if(G.kind==="base64url"){if(!FD.test(Q.data))Y=this._getOrReturnCtx(Q,Y),E(Y,{validation:"base64url",code:A.invalid_string,message:G.message}),$.dirty()}else i.assertNever(G);return{status:$.value,value:Q.data}}_regex(Q,X,$){return this.refinement((Y)=>Q.test(Y),{validation:X,code:A.invalid_string,...S.errToObj($)})}_addCheck(Q){return new w0({...this._def,checks:[...this._def.checks,Q]})}email(Q){return this._addCheck({kind:"email",...S.errToObj(Q)})}url(Q){return this._addCheck({kind:"url",...S.errToObj(Q)})}emoji(Q){return this._addCheck({kind:"emoji",...S.errToObj(Q)})}uuid(Q){return this._addCheck({kind:"uuid",...S.errToObj(Q)})}nanoid(Q){return this._addCheck({kind:"nanoid",...S.errToObj(Q)})}cuid(Q){return this._addCheck({kind:"cuid",...S.errToObj(Q)})}cuid2(Q){return this._addCheck({kind:"cuid2",...S.errToObj(Q)})}ulid(Q){return this._addCheck({kind:"ulid",...S.errToObj(Q)})}base64(Q){return this._addCheck({kind:"base64",...S.errToObj(Q)})}base64url(Q){return this._addCheck({kind:"base64url",...S.errToObj(Q)})}jwt(Q){return this._addCheck({kind:"jwt",...S.errToObj(Q)})}ip(Q){return this._addCheck({kind:"ip",...S.errToObj(Q)})}cidr(Q){return this._addCheck({kind:"cidr",...S.errToObj(Q)})}datetime(Q){if(typeof Q==="string")return this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:Q});return this._addCheck({kind:"datetime",precision:typeof Q?.precision>"u"?null:Q?.precision,offset:Q?.offset??!1,local:Q?.local??!1,...S.errToObj(Q?.message)})}date(Q){return this._addCheck({kind:"date",message:Q})}time(Q){if(typeof Q==="string")return this._addCheck({kind:"time",precision:null,message:Q});return this._addCheck({kind:"time",precision:typeof Q?.precision>"u"?null:Q?.precision,...S.errToObj(Q?.message)})}duration(Q){return this._addCheck({kind:"duration",...S.errToObj(Q)})}regex(Q,X){return this._addCheck({kind:"regex",regex:Q,...S.errToObj(X)})}includes(Q,X){return this._addCheck({kind:"includes",value:Q,position:X?.position,...S.errToObj(X?.message)})}startsWith(Q,X){return this._addCheck({kind:"startsWith",value:Q,...S.errToObj(X)})}endsWith(Q,X){return this._addCheck({kind:"endsWith",value:Q,...S.errToObj(X)})}min(Q,X){return this._addCheck({kind:"min",value:Q,...S.errToObj(X)})}max(Q,X){return this._addCheck({kind:"max",value:Q,...S.errToObj(X)})}length(Q,X){return this._addCheck({kind:"length",value:Q,...S.errToObj(X)})}nonempty(Q){return this.min(1,S.errToObj(Q))}trim(){return new w0({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new w0({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new w0({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((Q)=>Q.kind==="datetime")}get isDate(){return!!this._def.checks.find((Q)=>Q.kind==="date")}get isTime(){return!!this._def.checks.find((Q)=>Q.kind==="time")}get isDuration(){return!!this._def.checks.find((Q)=>Q.kind==="duration")}get isEmail(){return!!this._def.checks.find((Q)=>Q.kind==="email")}get isURL(){return!!this._def.checks.find((Q)=>Q.kind==="url")}get isEmoji(){return!!this._def.checks.find((Q)=>Q.kind==="emoji")}get isUUID(){return!!this._def.checks.find((Q)=>Q.kind==="uuid")}get isNANOID(){return!!this._def.checks.find((Q)=>Q.kind==="nanoid")}get isCUID(){return!!this._def.checks.find((Q)=>Q.kind==="cuid")}get isCUID2(){return!!this._def.checks.find((Q)=>Q.kind==="cuid2")}get isULID(){return!!this._def.checks.find((Q)=>Q.kind==="ulid")}get isIP(){return!!this._def.checks.find((Q)=>Q.kind==="ip")}get isCIDR(){return!!this._def.checks.find((Q)=>Q.kind==="cidr")}get isBase64(){return!!this._def.checks.find((Q)=>Q.kind==="base64")}get isBase64url(){return!!this._def.checks.find((Q)=>Q.kind==="base64url")}get minLength(){let Q=null;for(let X of this._def.checks)if(X.kind==="min"){if(Q===null||X.value>Q)Q=X.value}return Q}get maxLength(){let Q=null;for(let X of this._def.checks)if(X.kind==="max"){if(Q===null||X.value<Q)Q=X.value}return Q}}w0.create=(Q)=>{return new w0({checks:[],typeName:w.ZodString,coerce:Q?.coerce??!1,...l(Q)})};function jD(Q,X){let $=(Q.toString().split(".")[1]||"").length,Y=(X.toString().split(".")[1]||"").length,G=$>Y?$:Y,J=Number.parseInt(Q.toFixed(G).replace(".","")),W=Number.parseInt(X.toFixed(G).replace(".",""));return J%W/10**G}class k6 extends p{constructor(){super(...arguments);this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(Q){if(this._def.coerce)Q.data=Number(Q.data);if(this._getType(Q)!==R.number){let G=this._getOrReturnCtx(Q);return E(G,{code:A.invalid_type,expected:R.number,received:G.parsedType}),y}let $=void 0,Y=new E1;for(let G of this._def.checks)if(G.kind==="int"){if(!i.isInteger(Q.data))$=this._getOrReturnCtx(Q,$),E($,{code:A.invalid_type,expected:"integer",received:"float",message:G.message}),Y.dirty()}else if(G.kind==="min"){if(G.inclusive?Q.data<G.value:Q.data<=G.value)$=this._getOrReturnCtx(Q,$),E($,{code:A.too_small,minimum:G.value,type:"number",inclusive:G.inclusive,exact:!1,message:G.message}),Y.dirty()}else if(G.kind==="max"){if(G.inclusive?Q.data>G.value:Q.data>=G.value)$=this._getOrReturnCtx(Q,$),E($,{code:A.too_big,maximum:G.value,type:"number",inclusive:G.inclusive,exact:!1,message:G.message}),Y.dirty()}else if(G.kind==="multipleOf"){if(jD(Q.data,G.value)!==0)$=this._getOrReturnCtx(Q,$),E($,{code:A.not_multiple_of,multipleOf:G.value,message:G.message}),Y.dirty()}else if(G.kind==="finite"){if(!Number.isFinite(Q.data))$=this._getOrReturnCtx(Q,$),E($,{code:A.not_finite,message:G.message}),Y.dirty()}else i.assertNever(G);return{status:Y.value,value:Q.data}}gte(Q,X){return this.setLimit("min",Q,!0,S.toString(X))}gt(Q,X){return this.setLimit("min",Q,!1,S.toString(X))}lte(Q,X){return this.setLimit("max",Q,!0,S.toString(X))}lt(Q,X){return this.setLimit("max",Q,!1,S.toString(X))}setLimit(Q,X,$,Y){return new k6({...this._def,checks:[...this._def.checks,{kind:Q,value:X,inclusive:$,message:S.toString(Y)}]})}_addCheck(Q){return new k6({...this._def,checks:[...this._def.checks,Q]})}int(Q){return this._addCheck({kind:"int",message:S.toString(Q)})}positive(Q){return this._addCheck({kind:"min",value:0,inclusive:!1,message:S.toString(Q)})}negative(Q){return this._addCheck({kind:"max",value:0,inclusive:!1,message:S.toString(Q)})}nonpositive(Q){return this._addCheck({kind:"max",value:0,inclusive:!0,message:S.toString(Q)})}nonnegative(Q){return this._addCheck({kind:"min",value:0,inclusive:!0,message:S.toString(Q)})}multipleOf(Q,X){return this._addCheck({kind:"multipleOf",value:Q,message:S.toString(X)})}finite(Q){return this._addCheck({kind:"finite",message:S.toString(Q)})}safe(Q){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:S.toString(Q)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:S.toString(Q)})}get minValue(){let Q=null;for(let X of this._def.checks)if(X.kind==="min"){if(Q===null||X.value>Q)Q=X.value}return Q}get maxValue(){let Q=null;for(let X of this._def.checks)if(X.kind==="max"){if(Q===null||X.value<Q)Q=X.value}return Q}get isInt(){return!!this._def.checks.find((Q)=>Q.kind==="int"||Q.kind==="multipleOf"&&i.isInteger(Q.value))}get isFinite(){let Q=null,X=null;for(let $ of this._def.checks)if($.kind==="finite"||$.kind==="int"||$.kind==="multipleOf")return!0;else if($.kind==="min"){if(X===null||$.value>X)X=$.value}else if($.kind==="max"){if(Q===null||$.value<Q)Q=$.value}return Number.isFinite(X)&&Number.isFinite(Q)}}k6.create=(Q)=>{return new k6({checks:[],typeName:w.ZodNumber,coerce:Q?.coerce||!1,...l(Q)})};class v6 extends p{constructor(){super(...arguments);this.min=this.gte,this.max=this.lte}_parse(Q){if(this._def.coerce)try{Q.data=BigInt(Q.data)}catch{return this._getInvalidInput(Q)}if(this._getType(Q)!==R.bigint)return this._getInvalidInput(Q);let $=void 0,Y=new E1;for(let G of this._def.checks)if(G.kind==="min"){if(G.inclusive?Q.data<G.value:Q.data<=G.value)$=this._getOrReturnCtx(Q,$),E($,{code:A.too_small,type:"bigint",minimum:G.value,inclusive:G.inclusive,message:G.message}),Y.dirty()}else if(G.kind==="max"){if(G.inclusive?Q.data>G.value:Q.data>=G.value)$=this._getOrReturnCtx(Q,$),E($,{code:A.too_big,type:"bigint",maximum:G.value,inclusive:G.inclusive,message:G.message}),Y.dirty()}else if(G.kind==="multipleOf"){if(Q.data%G.value!==BigInt(0))$=this._getOrReturnCtx(Q,$),E($,{code:A.not_multiple_of,multipleOf:G.value,message:G.message}),Y.dirty()}else i.assertNever(G);return{status:Y.value,value:Q.data}}_getInvalidInput(Q){let X=this._getOrReturnCtx(Q);return E(X,{code:A.invalid_type,expected:R.bigint,received:X.parsedType}),y}gte(Q,X){return this.setLimit("min",Q,!0,S.toString(X))}gt(Q,X){return this.setLimit("min",Q,!1,S.toString(X))}lte(Q,X){return this.setLimit("max",Q,!0,S.toString(X))}lt(Q,X){return this.setLimit("max",Q,!1,S.toString(X))}setLimit(Q,X,$,Y){return new v6({...this._def,checks:[...this._def.checks,{kind:Q,value:X,inclusive:$,message:S.toString(Y)}]})}_addCheck(Q){return new v6({...this._def,checks:[...this._def.checks,Q]})}positive(Q){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:S.toString(Q)})}negative(Q){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:S.toString(Q)})}nonpositive(Q){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:S.toString(Q)})}nonnegative(Q){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:S.toString(Q)})}multipleOf(Q,X){return this._addCheck({kind:"multipleOf",value:Q,message:S.toString(X)})}get minValue(){let Q=null;for(let X of this._def.checks)if(X.kind==="min"){if(Q===null||X.value>Q)Q=X.value}return Q}get maxValue(){let Q=null;for(let X of this._def.checks)if(X.kind==="max"){if(Q===null||X.value<Q)Q=X.value}return Q}}v6.create=(Q)=>{return new v6({checks:[],typeName:w.ZodBigInt,coerce:Q?.coerce??!1,...l(Q)})};class r8 extends p{_parse(Q){if(this._def.coerce)Q.data=Boolean(Q.data);if(this._getType(Q)!==R.boolean){let $=this._getOrReturnCtx(Q);return E($,{code:A.invalid_type,expected:R.boolean,received:$.parsedType}),y}return Z1(Q.data)}}r8.create=(Q)=>{return new r8({typeName:w.ZodBoolean,coerce:Q?.coerce||!1,...l(Q)})};class F4 extends p{_parse(Q){if(this._def.coerce)Q.data=new Date(Q.data);if(this._getType(Q)!==R.date){let G=this._getOrReturnCtx(Q);return E(G,{code:A.invalid_type,expected:R.date,received:G.parsedType}),y}if(Number.isNaN(Q.data.getTime())){let G=this._getOrReturnCtx(Q);return E(G,{code:A.invalid_date}),y}let $=new E1,Y=void 0;for(let G of this._def.checks)if(G.kind==="min"){if(Q.data.getTime()<G.value)Y=this._getOrReturnCtx(Q,Y),E(Y,{code:A.too_small,message:G.message,inclusive:!0,exact:!1,minimum:G.value,type:"date"}),$.dirty()}else if(G.kind==="max"){if(Q.data.getTime()>G.value)Y=this._getOrReturnCtx(Q,Y),E(Y,{code:A.too_big,message:G.message,inclusive:!0,exact:!1,maximum:G.value,type:"date"}),$.dirty()}else i.assertNever(G);return{status:$.value,value:new Date(Q.data.getTime())}}_addCheck(Q){return new F4({...this._def,checks:[...this._def.checks,Q]})}min(Q,X){return this._addCheck({kind:"min",value:Q.getTime(),message:S.toString(X)})}max(Q,X){return this._addCheck({kind:"max",value:Q.getTime(),message:S.toString(X)})}get minDate(){let Q=null;for(let X of this._def.checks)if(X.kind==="min"){if(Q===null||X.value>Q)Q=X.value}return Q!=null?new Date(Q):null}get maxDate(){let Q=null;for(let X of this._def.checks)if(X.kind==="max"){if(Q===null||X.value<Q)Q=X.value}return Q!=null?new Date(Q):null}}F4.create=(Q)=>{return new F4({checks:[],coerce:Q?.coerce||!1,typeName:w.ZodDate,...l(Q)})};class t8 extends p{_parse(Q){if(this._getType(Q)!==R.symbol){let $=this._getOrReturnCtx(Q);return E($,{code:A.invalid_type,expected:R.symbol,received:$.parsedType}),y}return Z1(Q.data)}}t8.create=(Q)=>{return new t8({typeName:w.ZodSymbol,...l(Q)})};class N4 extends p{_parse(Q){if(this._getType(Q)!==R.undefined){let $=this._getOrReturnCtx(Q);return E($,{code:A.invalid_type,expected:R.undefined,received:$.parsedType}),y}return Z1(Q.data)}}N4.create=(Q)=>{return new N4({typeName:w.ZodUndefined,...l(Q)})};class D4 extends p{_parse(Q){if(this._getType(Q)!==R.null){let $=this._getOrReturnCtx(Q);return E($,{code:A.invalid_type,expected:R.null,received:$.parsedType}),y}return Z1(Q.data)}}D4.create=(Q)=>{return new D4({typeName:w.ZodNull,...l(Q)})};class a8 extends p{constructor(){super(...arguments);this._any=!0}_parse(Q){return Z1(Q.data)}}a8.create=(Q)=>{return new a8({typeName:w.ZodAny,...l(Q)})};class G6 extends p{constructor(){super(...arguments);this._unknown=!0}_parse(Q){return Z1(Q.data)}}G6.create=(Q)=>{return new G6({typeName:w.ZodUnknown,...l(Q)})};class j0 extends p{_parse(Q){let X=this._getOrReturnCtx(Q);return E(X,{code:A.invalid_type,expected:R.never,received:X.parsedType}),y}}j0.create=(Q)=>{return new j0({typeName:w.ZodNever,...l(Q)})};class s8 extends p{_parse(Q){if(this._getType(Q)!==R.undefined){let $=this._getOrReturnCtx(Q);return E($,{code:A.invalid_type,expected:R.void,received:$.parsedType}),y}return Z1(Q.data)}}s8.create=(Q)=>{return new s8({typeName:w.ZodVoid,...l(Q)})};class H0 extends p{_parse(Q){let{ctx:X,status:$}=this._processInputParams(Q),Y=this._def;if(X.parsedType!==R.array)return E(X,{code:A.invalid_type,expected:R.array,received:X.parsedType}),y;if(Y.exactLength!==null){let J=X.data.length>Y.exactLength.value,W=X.data.length<Y.exactLength.value;if(J||W)E(X,{code:J?A.too_big:A.too_small,minimum:W?Y.exactLength.value:void 0,maximum:J?Y.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:Y.exactLength.message}),$.dirty()}if(Y.minLength!==null){if(X.data.length<Y.minLength.value)E(X,{code:A.too_small,minimum:Y.minLength.value,type:"array",inclusive:!0,exact:!1,message:Y.minLength.message}),$.dirty()}if(Y.maxLength!==null){if(X.data.length>Y.maxLength.value)E(X,{code:A.too_big,maximum:Y.maxLength.value,type:"array",inclusive:!0,exact:!1,message:Y.maxLength.message}),$.dirty()}if(X.common.async)return Promise.all([...X.data].map((J,W)=>{return Y.type._parseAsync(new t1(X,J,X.path,W))})).then((J)=>{return E1.mergeArray($,J)});let G=[...X.data].map((J,W)=>{return Y.type._parseSync(new t1(X,J,X.path,W))});return E1.mergeArray($,G)}get element(){return this._def.type}min(Q,X){return new H0({...this._def,minLength:{value:Q,message:S.toString(X)}})}max(Q,X){return new H0({...this._def,maxLength:{value:Q,message:S.toString(X)}})}length(Q,X){return new H0({...this._def,exactLength:{value:Q,message:S.toString(X)}})}nonempty(Q){return this.min(1,Q)}}H0.create=(Q,X)=>{return new H0({type:Q,minLength:null,maxLength:null,exactLength:null,typeName:w.ZodArray,...l(X)})};function _6(Q){if(Q instanceof N1){let X={};for(let $ in Q.shape){let Y=Q.shape[$];X[$]=p1.create(_6(Y))}return new N1({...Q._def,shape:()=>X})}else if(Q instanceof H0)return new H0({...Q._def,type:_6(Q.element)});else if(Q instanceof p1)return p1.create(_6(Q.unwrap()));else if(Q instanceof x0)return x0.create(_6(Q.unwrap()));else if(Q instanceof I0)return I0.create(Q.items.map((X)=>_6(X)));else return Q}class N1 extends p{constructor(){super(...arguments);this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let Q=this._def.shape(),X=i.objectKeys(Q);return this._cached={shape:Q,keys:X},this._cached}_parse(Q){if(this._getType(Q)!==R.object){let z=this._getOrReturnCtx(Q);return E(z,{code:A.invalid_type,expected:R.object,received:z.parsedType}),y}let{status:$,ctx:Y}=this._processInputParams(Q),{shape:G,keys:J}=this._getCached(),W=[];if(!(this._def.catchall instanceof j0&&this._def.unknownKeys==="strip")){for(let z in Y.data)if(!J.includes(z))W.push(z)}let H=[];for(let z of J){let B=G[z],K=Y.data[z];H.push({key:{status:"valid",value:z},value:B._parse(new t1(Y,K,Y.path,z)),alwaysSet:z in Y.data})}if(this._def.catchall instanceof j0){let z=this._def.unknownKeys;if(z==="passthrough")for(let B of W)H.push({key:{status:"valid",value:B},value:{status:"valid",value:Y.data[B]}});else if(z==="strict"){if(W.length>0)E(Y,{code:A.unrecognized_keys,keys:W}),$.dirty()}else if(z==="strip");else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let z=this._def.catchall;for(let B of W){let K=Y.data[B];H.push({key:{status:"valid",value:B},value:z._parse(new t1(Y,K,Y.path,B)),alwaysSet:B in Y.data})}}if(Y.common.async)return Promise.resolve().then(async()=>{let z=[];for(let B of H){let K=await B.key,q=await B.value;z.push({key:K,value:q,alwaysSet:B.alwaysSet})}return z}).then((z)=>{return E1.mergeObjectSync($,z)});else return E1.mergeObjectSync($,H)}get shape(){return this._def.shape()}strict(Q){return S.errToObj,new N1({...this._def,unknownKeys:"strict",...Q!==void 0?{errorMap:(X,$)=>{let Y=this._def.errorMap?.(X,$).message??$.defaultError;if(X.code==="unrecognized_keys")return{message:S.errToObj(Q).message??Y};return{message:Y}}}:{}})}strip(){return new N1({...this._def,unknownKeys:"strip"})}passthrough(){return new N1({...this._def,unknownKeys:"passthrough"})}extend(Q){return new N1({...this._def,shape:()=>({...this._def.shape(),...Q})})}merge(Q){return new N1({unknownKeys:Q._def.unknownKeys,catchall:Q._def.catchall,shape:()=>({...this._def.shape(),...Q._def.shape()}),typeName:w.ZodObject})}setKey(Q,X){return this.augment({[Q]:X})}catchall(Q){return new N1({...this._def,catchall:Q})}pick(Q){let X={};for(let $ of i.objectKeys(Q))if(Q[$]&&this.shape[$])X[$]=this.shape[$];return new N1({...this._def,shape:()=>X})}omit(Q){let X={};for(let $ of i.objectKeys(this.shape))if(!Q[$])X[$]=this.shape[$];return new N1({...this._def,shape:()=>X})}deepPartial(){return _6(this)}partial(Q){let X={};for(let $ of i.objectKeys(this.shape)){let Y=this.shape[$];if(Q&&!Q[$])X[$]=Y;else X[$]=Y.optional()}return new N1({...this._def,shape:()=>X})}required(Q){let X={};for(let $ of i.objectKeys(this.shape))if(Q&&!Q[$])X[$]=this.shape[$];else{let G=this.shape[$];while(G instanceof p1)G=G._def.innerType;X[$]=G}return new N1({...this._def,shape:()=>X})}keyof(){return $W(i.objectKeys(this.shape))}}N1.create=(Q,X)=>{return new N1({shape:()=>Q,unknownKeys:"strip",catchall:j0.create(),typeName:w.ZodObject,...l(X)})};N1.strictCreate=(Q,X)=>{return new N1({shape:()=>Q,unknownKeys:"strict",catchall:j0.create(),typeName:w.ZodObject,...l(X)})};N1.lazycreate=(Q,X)=>{return new N1({shape:Q,unknownKeys:"strip",catchall:j0.create(),typeName:w.ZodObject,...l(X)})};class O4 extends p{_parse(Q){let{ctx:X}=this._processInputParams(Q),$=this._def.options;function Y(G){for(let W of G)if(W.result.status==="valid")return W.result;for(let W of G)if(W.result.status==="dirty")return X.common.issues.push(...W.ctx.common.issues),W.result;let J=G.map((W)=>new h1(W.ctx.common.issues));return E(X,{code:A.invalid_union,unionErrors:J}),y}if(X.common.async)return Promise.all($.map(async(G)=>{let J={...X,common:{...X.common,issues:[]},parent:null};return{result:await G._parseAsync({data:X.data,path:X.path,parent:J}),ctx:J}})).then(Y);else{let G=void 0,J=[];for(let H of $){let z={...X,common:{...X.common,issues:[]},parent:null},B=H._parseSync({data:X.data,path:X.path,parent:z});if(B.status==="valid")return B;else if(B.status==="dirty"&&!G)G={result:B,ctx:z};if(z.common.issues.length)J.push(z.common.issues)}if(G)return X.common.issues.push(...G.ctx.common.issues),G.result;let W=J.map((H)=>new h1(H));return E(X,{code:A.invalid_union,unionErrors:W}),y}}get options(){return this._def.options}}O4.create=(Q,X)=>{return new O4({options:Q,typeName:w.ZodUnion,...l(X)})};var A0=(Q)=>{if(Q instanceof A4)return A0(Q.schema);else if(Q instanceof z0)return A0(Q.innerType());else if(Q instanceof w4)return[Q.value];else if(Q instanceof J6)return Q.options;else if(Q instanceof j4)return i.objectValues(Q.enum);else if(Q instanceof I4)return A0(Q._def.innerType);else if(Q instanceof N4)return[void 0];else if(Q instanceof D4)return[null];else if(Q instanceof p1)return[void 0,...A0(Q.unwrap())];else if(Q instanceof x0)return[null,...A0(Q.unwrap())];else if(Q instanceof PX)return A0(Q.unwrap());else if(Q instanceof R4)return A0(Q.unwrap());else if(Q instanceof b4)return A0(Q._def.innerType);else return[]};class EX extends p{_parse(Q){let{ctx:X}=this._processInputParams(Q);if(X.parsedType!==R.object)return E(X,{code:A.invalid_type,expected:R.object,received:X.parsedType}),y;let $=this.discriminator,Y=X.data[$],G=this.optionsMap.get(Y);if(!G)return E(X,{code:A.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[$]}),y;if(X.common.async)return G._parseAsync({data:X.data,path:X.path,parent:X});else return G._parseSync({data:X.data,path:X.path,parent:X})}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(Q,X,$){let Y=new Map;for(let G of X){let J=A0(G.shape[Q]);if(!J.length)throw Error(`A discriminator value for key \`${Q}\` could not be extracted from all schema options`);for(let W of J){if(Y.has(W))throw Error(`Discriminator property ${String(Q)} has duplicate value ${String(W)}`);Y.set(W,G)}}return new EX({typeName:w.ZodDiscriminatedUnion,discriminator:Q,options:X,optionsMap:Y,...l($)})}}function RX(Q,X){let $=M0(Q),Y=M0(X);if(Q===X)return{valid:!0,data:Q};else if($===R.object&&Y===R.object){let G=i.objectKeys(X),J=i.objectKeys(Q).filter((H)=>G.indexOf(H)!==-1),W={...Q,...X};for(let H of J){let z=RX(Q[H],X[H]);if(!z.valid)return{valid:!1};W[H]=z.data}return{valid:!0,data:W}}else if($===R.array&&Y===R.array){if(Q.length!==X.length)return{valid:!1};let G=[];for(let J=0;J<Q.length;J++){let W=Q[J],H=X[J],z=RX(W,H);if(!z.valid)return{valid:!1};G.push(z.data)}return{valid:!0,data:G}}else if($===R.date&&Y===R.date&&+Q===+X)return{valid:!0,data:Q};else return{valid:!1}}class M4 extends p{_parse(Q){let{status:X,ctx:$}=this._processInputParams(Q),Y=(G,J)=>{if(jX(G)||jX(J))return y;let W=RX(G.value,J.value);if(!W.valid)return E($,{code:A.invalid_intersection_types}),y;if(IX(G)||IX(J))X.dirty();return{status:X.value,value:W.data}};if($.common.async)return Promise.all([this._def.left._parseAsync({data:$.data,path:$.path,parent:$}),this._def.right._parseAsync({data:$.data,path:$.path,parent:$})]).then(([G,J])=>Y(G,J));else return Y(this._def.left._parseSync({data:$.data,path:$.path,parent:$}),this._def.right._parseSync({data:$.data,path:$.path,parent:$}))}}M4.create=(Q,X,$)=>{return new M4({left:Q,right:X,typeName:w.ZodIntersection,...l($)})};class I0 extends p{_parse(Q){let{status:X,ctx:$}=this._processInputParams(Q);if($.parsedType!==R.array)return E($,{code:A.invalid_type,expected:R.array,received:$.parsedType}),y;if($.data.length<this._def.items.length)return E($,{code:A.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),y;if(!this._def.rest&&$.data.length>this._def.items.length)E($,{code:A.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),X.dirty();let G=[...$.data].map((J,W)=>{let H=this._def.items[W]||this._def.rest;if(!H)return null;return H._parse(new t1($,J,$.path,W))}).filter((J)=>!!J);if($.common.async)return Promise.all(G).then((J)=>{return E1.mergeArray(X,J)});else return E1.mergeArray(X,G)}get items(){return this._def.items}rest(Q){return new I0({...this._def,rest:Q})}}I0.create=(Q,X)=>{if(!Array.isArray(Q))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new I0({items:Q,typeName:w.ZodTuple,rest:null,...l(X)})};class e8 extends p{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(Q){let{status:X,ctx:$}=this._processInputParams(Q);if($.parsedType!==R.object)return E($,{code:A.invalid_type,expected:R.object,received:$.parsedType}),y;let Y=[],G=this._def.keyType,J=this._def.valueType;for(let W in $.data)Y.push({key:G._parse(new t1($,W,$.path,W)),value:J._parse(new t1($,$.data[W],$.path,W)),alwaysSet:W in $.data});if($.common.async)return E1.mergeObjectAsync(X,Y);else return E1.mergeObjectSync(X,Y)}get element(){return this._def.valueType}static create(Q,X,$){if(X instanceof p)return new e8({keyType:Q,valueType:X,typeName:w.ZodRecord,...l($)});return new e8({keyType:w0.create(),valueType:Q,typeName:w.ZodRecord,...l(X)})}}class Q9 extends p{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(Q){let{status:X,ctx:$}=this._processInputParams(Q);if($.parsedType!==R.map)return E($,{code:A.invalid_type,expected:R.map,received:$.parsedType}),y;let Y=this._def.keyType,G=this._def.valueType,J=[...$.data.entries()].map(([W,H],z)=>{return{key:Y._parse(new t1($,W,$.path,[z,"key"])),value:G._parse(new t1($,H,$.path,[z,"value"]))}});if($.common.async){let W=new Map;return Promise.resolve().then(async()=>{for(let H of J){let z=await H.key,B=await H.value;if(z.status==="aborted"||B.status==="aborted")return y;if(z.status==="dirty"||B.status==="dirty")X.dirty();W.set(z.value,B.value)}return{status:X.value,value:W}})}else{let W=new Map;for(let H of J){let{key:z,value:B}=H;if(z.status==="aborted"||B.status==="aborted")return y;if(z.status==="dirty"||B.status==="dirty")X.dirty();W.set(z.value,B.value)}return{status:X.value,value:W}}}}Q9.create=(Q,X,$)=>{return new Q9({valueType:X,keyType:Q,typeName:w.ZodMap,...l($)})};class T6 extends p{_parse(Q){let{status:X,ctx:$}=this._processInputParams(Q);if($.parsedType!==R.set)return E($,{code:A.invalid_type,expected:R.set,received:$.parsedType}),y;let Y=this._def;if(Y.minSize!==null){if($.data.size<Y.minSize.value)E($,{code:A.too_small,minimum:Y.minSize.value,type:"set",inclusive:!0,exact:!1,message:Y.minSize.message}),X.dirty()}if(Y.maxSize!==null){if($.data.size>Y.maxSize.value)E($,{code:A.too_big,maximum:Y.maxSize.value,type:"set",inclusive:!0,exact:!1,message:Y.maxSize.message}),X.dirty()}let G=this._def.valueType;function J(H){let z=new Set;for(let B of H){if(B.status==="aborted")return y;if(B.status==="dirty")X.dirty();z.add(B.value)}return{status:X.value,value:z}}let W=[...$.data.values()].map((H,z)=>G._parse(new t1($,H,$.path,z)));if($.common.async)return Promise.all(W).then((H)=>J(H));else return J(W)}min(Q,X){return new T6({...this._def,minSize:{value:Q,message:S.toString(X)}})}max(Q,X){return new T6({...this._def,maxSize:{value:Q,message:S.toString(X)}})}size(Q,X){return this.min(Q,X).max(Q,X)}nonempty(Q){return this.min(1,Q)}}T6.create=(Q,X)=>{return new T6({valueType:Q,minSize:null,maxSize:null,typeName:w.ZodSet,...l(X)})};class L4 extends p{constructor(){super(...arguments);this.validate=this.implement}_parse(Q){let{ctx:X}=this._processInputParams(Q);if(X.parsedType!==R.function)return E(X,{code:A.invalid_type,expected:R.function,received:X.parsedType}),y;function $(W,H){return o8({data:W,path:X.path,errorMaps:[X.common.contextualErrorMap,X.schemaErrorMap,q4(),T0].filter((z)=>!!z),issueData:{code:A.invalid_arguments,argumentsError:H}})}function Y(W,H){return o8({data:W,path:X.path,errorMaps:[X.common.contextualErrorMap,X.schemaErrorMap,q4(),T0].filter((z)=>!!z),issueData:{code:A.invalid_return_type,returnTypeError:H}})}let G={errorMap:X.common.contextualErrorMap},J=X.data;if(this._def.returns instanceof x6){let W=this;return Z1(async function(...H){let z=new h1([]),B=await W._def.args.parseAsync(H,G).catch((U)=>{throw z.addIssue($(H,U)),z}),K=await Reflect.apply(J,this,B);return await W._def.returns._def.type.parseAsync(K,G).catch((U)=>{throw z.addIssue(Y(K,U)),z})})}else{let W=this;return Z1(function(...H){let z=W._def.args.safeParse(H,G);if(!z.success)throw new h1([$(H,z.error)]);let B=Reflect.apply(J,this,z.data),K=W._def.returns.safeParse(B,G);if(!K.success)throw new h1([Y(B,K.error)]);return K.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...Q){return new L4({...this._def,args:I0.create(Q).rest(G6.create())})}returns(Q){return new L4({...this._def,returns:Q})}implement(Q){return this.parse(Q)}strictImplement(Q){return this.parse(Q)}static create(Q,X,$){return new L4({args:Q?Q:I0.create([]).rest(G6.create()),returns:X||G6.create(),typeName:w.ZodFunction,...l($)})}}class A4 extends p{get schema(){return this._def.getter()}_parse(Q){let{ctx:X}=this._processInputParams(Q);return this._def.getter()._parse({data:X.data,path:X.path,parent:X})}}A4.create=(Q,X)=>{return new A4({getter:Q,typeName:w.ZodLazy,...l(X)})};class w4 extends p{_parse(Q){if(Q.data!==this._def.value){let X=this._getOrReturnCtx(Q);return E(X,{received:X.data,code:A.invalid_literal,expected:this._def.value}),y}return{status:"valid",value:Q.data}}get value(){return this._def.value}}w4.create=(Q,X)=>{return new w4({value:Q,typeName:w.ZodLiteral,...l(X)})};function $W(Q,X){return new J6({values:Q,typeName:w.ZodEnum,...l(X)})}class J6 extends p{_parse(Q){if(typeof Q.data!=="string"){let X=this._getOrReturnCtx(Q),$=this._def.values;return E(X,{expected:i.joinValues($),received:X.parsedType,code:A.invalid_type}),y}if(!this._cache)this._cache=new Set(this._def.values);if(!this._cache.has(Q.data)){let X=this._getOrReturnCtx(Q),$=this._def.values;return E(X,{received:X.data,code:A.invalid_enum_value,options:$}),y}return Z1(Q.data)}get options(){return this._def.values}get enum(){let Q={};for(let X of this._def.values)Q[X]=X;return Q}get Values(){let Q={};for(let X of this._def.values)Q[X]=X;return Q}get Enum(){let Q={};for(let X of this._def.values)Q[X]=X;return Q}extract(Q,X=this._def){return J6.create(Q,{...this._def,...X})}exclude(Q,X=this._def){return J6.create(this.options.filter(($)=>!Q.includes($)),{...this._def,...X})}}J6.create=$W;class j4 extends p{_parse(Q){let X=i.getValidEnumValues(this._def.values),$=this._getOrReturnCtx(Q);if($.parsedType!==R.string&&$.parsedType!==R.number){let Y=i.objectValues(X);return E($,{expected:i.joinValues(Y),received:$.parsedType,code:A.invalid_type}),y}if(!this._cache)this._cache=new Set(i.getValidEnumValues(this._def.values));if(!this._cache.has(Q.data)){let Y=i.objectValues(X);return E($,{received:$.data,code:A.invalid_enum_value,options:Y}),y}return Z1(Q.data)}get enum(){return this._def.values}}j4.create=(Q,X)=>{return new j4({values:Q,typeName:w.ZodNativeEnum,...l(X)})};class x6 extends p{unwrap(){return this._def.type}_parse(Q){let{ctx:X}=this._processInputParams(Q);if(X.parsedType!==R.promise&&X.common.async===!1)return E(X,{code:A.invalid_type,expected:R.promise,received:X.parsedType}),y;let $=X.parsedType===R.promise?X.data:Promise.resolve(X.data);return Z1($.then((Y)=>{return this._def.type.parseAsync(Y,{path:X.path,errorMap:X.common.contextualErrorMap})}))}}x6.create=(Q,X)=>{return new x6({type:Q,typeName:w.ZodPromise,...l(X)})};class z0 extends p{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===w.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(Q){let{status:X,ctx:$}=this._processInputParams(Q),Y=this._def.effect||null,G={addIssue:(J)=>{if(E($,J),J.fatal)X.abort();else X.dirty()},get path(){return $.path}};if(G.addIssue=G.addIssue.bind(G),Y.type==="preprocess"){let J=Y.transform($.data,G);if($.common.async)return Promise.resolve(J).then(async(W)=>{if(X.value==="aborted")return y;let H=await this._def.schema._parseAsync({data:W,path:$.path,parent:$});if(H.status==="aborted")return y;if(H.status==="dirty")return C6(H.value);if(X.value==="dirty")return C6(H.value);return H});else{if(X.value==="aborted")return y;let W=this._def.schema._parseSync({data:J,path:$.path,parent:$});if(W.status==="aborted")return y;if(W.status==="dirty")return C6(W.value);if(X.value==="dirty")return C6(W.value);return W}}if(Y.type==="refinement"){let J=(W)=>{let H=Y.refinement(W,G);if($.common.async)return Promise.resolve(H);if(H instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return W};if($.common.async===!1){let W=this._def.schema._parseSync({data:$.data,path:$.path,parent:$});if(W.status==="aborted")return y;if(W.status==="dirty")X.dirty();return J(W.value),{status:X.value,value:W.value}}else return this._def.schema._parseAsync({data:$.data,path:$.path,parent:$}).then((W)=>{if(W.status==="aborted")return y;if(W.status==="dirty")X.dirty();return J(W.value).then(()=>{return{status:X.value,value:W.value}})})}if(Y.type==="transform")if($.common.async===!1){let J=this._def.schema._parseSync({data:$.data,path:$.path,parent:$});if(!Y6(J))return y;let W=Y.transform(J.value,G);if(W instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:X.value,value:W}}else return this._def.schema._parseAsync({data:$.data,path:$.path,parent:$}).then((J)=>{if(!Y6(J))return y;return Promise.resolve(Y.transform(J.value,G)).then((W)=>({status:X.value,value:W}))});i.assertNever(Y)}}z0.create=(Q,X,$)=>{return new z0({schema:Q,typeName:w.ZodEffects,effect:X,...l($)})};z0.createWithPreprocess=(Q,X,$)=>{return new z0({schema:X,effect:{type:"preprocess",transform:Q},typeName:w.ZodEffects,...l($)})};class p1 extends p{_parse(Q){if(this._getType(Q)===R.undefined)return Z1(void 0);return this._def.innerType._parse(Q)}unwrap(){return this._def.innerType}}p1.create=(Q,X)=>{return new p1({innerType:Q,typeName:w.ZodOptional,...l(X)})};class x0 extends p{_parse(Q){if(this._getType(Q)===R.null)return Z1(null);return this._def.innerType._parse(Q)}unwrap(){return this._def.innerType}}x0.create=(Q,X)=>{return new x0({innerType:Q,typeName:w.ZodNullable,...l(X)})};class I4 extends p{_parse(Q){let{ctx:X}=this._processInputParams(Q),$=X.data;if(X.parsedType===R.undefined)$=this._def.defaultValue();return this._def.innerType._parse({data:$,path:X.path,parent:X})}removeDefault(){return this._def.innerType}}I4.create=(Q,X)=>{return new I4({innerType:Q,typeName:w.ZodDefault,defaultValue:typeof X.default==="function"?X.default:()=>X.default,...l(X)})};class b4 extends p{_parse(Q){let{ctx:X}=this._processInputParams(Q),$={...X,common:{...X.common,issues:[]}},Y=this._def.innerType._parse({data:$.data,path:$.path,parent:{...$}});if(U4(Y))return Y.then((G)=>{return{status:"valid",value:G.status==="valid"?G.value:this._def.catchValue({get error(){return new h1($.common.issues)},input:$.data})}});else return{status:"valid",value:Y.status==="valid"?Y.value:this._def.catchValue({get error(){return new h1($.common.issues)},input:$.data})}}removeCatch(){return this._def.innerType}}b4.create=(Q,X)=>{return new b4({innerType:Q,typeName:w.ZodCatch,catchValue:typeof X.catch==="function"?X.catch:()=>X.catch,...l(X)})};class X9 extends p{_parse(Q){if(this._getType(Q)!==R.nan){let $=this._getOrReturnCtx(Q);return E($,{code:A.invalid_type,expected:R.nan,received:$.parsedType}),y}return{status:"valid",value:Q.data}}}X9.create=(Q)=>{return new X9({typeName:w.ZodNaN,...l(Q)})};var OT=Symbol("zod_brand");class PX extends p{_parse(Q){let{ctx:X}=this._processInputParams(Q),$=X.data;return this._def.type._parse({data:$,path:X.path,parent:X})}unwrap(){return this._def.type}}class $9 extends p{_parse(Q){let{status:X,ctx:$}=this._processInputParams(Q);if($.common.async)return(async()=>{let G=await this._def.in._parseAsync({data:$.data,path:$.path,parent:$});if(G.status==="aborted")return y;if(G.status==="dirty")return X.dirty(),C6(G.value);else return this._def.out._parseAsync({data:G.value,path:$.path,parent:$})})();else{let Y=this._def.in._parseSync({data:$.data,path:$.path,parent:$});if(Y.status==="aborted")return y;if(Y.status==="dirty")return X.dirty(),{status:"dirty",value:Y.value};else return this._def.out._parseSync({data:Y.value,path:$.path,parent:$})}}static create(Q,X){return new $9({in:Q,out:X,typeName:w.ZodPipeline})}}class R4 extends p{_parse(Q){let X=this._def.innerType._parse(Q),$=(Y)=>{if(Y6(Y))Y.value=Object.freeze(Y.value);return Y};return U4(X)?X.then((Y)=>$(Y)):$(X)}unwrap(){return this._def.innerType}}R4.create=(Q,X)=>{return new R4({innerType:Q,typeName:w.ZodReadonly,...l(X)})};var MT={object:N1.lazycreate},w;(function(Q){Q.ZodString="ZodString",Q.ZodNumber="ZodNumber",Q.ZodNaN="ZodNaN",Q.ZodBigInt="ZodBigInt",Q.ZodBoolean="ZodBoolean",Q.ZodDate="ZodDate",Q.ZodSymbol="ZodSymbol",Q.ZodUndefined="ZodUndefined",Q.ZodNull="ZodNull",Q.ZodAny="ZodAny",Q.ZodUnknown="ZodUnknown",Q.ZodNever="ZodNever",Q.ZodVoid="ZodVoid",Q.ZodArray="ZodArray",Q.ZodObject="ZodObject",Q.ZodUnion="ZodUnion",Q.ZodDiscriminatedUnion="ZodDiscriminatedUnion",Q.ZodIntersection="ZodIntersection",Q.ZodTuple="ZodTuple",Q.ZodRecord="ZodRecord",Q.ZodMap="ZodMap",Q.ZodSet="ZodSet",Q.ZodFunction="ZodFunction",Q.ZodLazy="ZodLazy",Q.ZodLiteral="ZodLiteral",Q.ZodEnum="ZodEnum",Q.ZodEffects="ZodEffects",Q.ZodNativeEnum="ZodNativeEnum",Q.ZodOptional="ZodOptional",Q.ZodNullable="ZodNullable",Q.ZodDefault="ZodDefault",Q.ZodCatch="ZodCatch",Q.ZodPromise="ZodPromise",Q.ZodBranded="ZodBranded",Q.ZodPipeline="ZodPipeline",Q.ZodReadonly="ZodReadonly"})(w||(w={}));var AT=w0.create,wT=k6.create,jT=X9.create,IT=v6.create,bT=r8.create,RT=F4.create,ET=t8.create,PT=N4.create,ST=D4.create,ZT=a8.create,CT=G6.create,_T=j0.create,kT=s8.create,vT=H0.create,YW=N1.create,TT=N1.strictCreate,xT=O4.create,yT=EX.create,gT=M4.create,fT=I0.create,hT=e8.create,uT=Q9.create,lT=T6.create,mT=L4.create,cT=A4.create,pT=w4.create,dT=J6.create,iT=j4.create,nT=x6.create,oT=z0.create,rT=p1.create,tT=x0.create,aT=z0.createWithPreprocess,sT=$9.create;var ID=Object.freeze({status:"aborted"});function D(Q,X,$){function Y(H,z){var B;Object.defineProperty(H,"_zod",{value:H._zod??{},enumerable:!1}),(B=H._zod).traits??(B.traits=new Set),H._zod.traits.add(Q),X(H,z);for(let K in W.prototype)if(!(K in H))Object.defineProperty(H,K,{value:W.prototype[K].bind(H)});H._zod.constr=W,H._zod.def=z}let G=$?.Parent??Object;class J extends G{}Object.defineProperty(J,"name",{value:Q});function W(H){var z;let B=$?.Parent?new J:this;Y(B,H),(z=B._zod).deferred??(z.deferred=[]);for(let K of B._zod.deferred)K();return B}return Object.defineProperty(W,"init",{value:Y}),Object.defineProperty(W,Symbol.hasInstance,{value:(H)=>{if($?.Parent&&H instanceof $.Parent)return!0;return H?._zod?.traits?.has(Q)}}),Object.defineProperty(W,"name",{value:Q}),W}var bD=Symbol("zod_brand");class y0 extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}var Y9={};function u1(Q){if(Q)Object.assign(Y9,Q);return Y9}var d={};w7(d,{unwrapMessage:()=>E4,stringifyPrimitive:()=>W9,required:()=>lD,randomString:()=>kD,propertyKeyTypes:()=>vX,promiseAllObject:()=>_D,primitiveTypes:()=>GW,prefixIssues:()=>B0,pick:()=>yD,partial:()=>uD,optionalKeys:()=>TX,omit:()=>gD,numKeys:()=>vD,nullish:()=>Z4,normalizeParams:()=>x,merge:()=>hD,jsonStringifyReplacer:()=>ZX,joinValues:()=>G9,issue:()=>yX,isPlainObject:()=>g6,isObject:()=>y6,getSizableOrigin:()=>WW,getParsedType:()=>TD,getLengthableOrigin:()=>_4,getEnumValues:()=>P4,getElementAtPath:()=>CD,floatSafeRemainder:()=>CX,finalizeIssue:()=>a1,extend:()=>fD,escapeRegex:()=>g0,esc:()=>W6,defineLazy:()=>Y1,createTransparentProxy:()=>xD,clone:()=>l1,cleanRegex:()=>C4,cleanEnum:()=>mD,captureStackTrace:()=>J9,cached:()=>S4,assignProp:()=>_X,assertNotEqual:()=>ED,assertNever:()=>SD,assertIs:()=>PD,assertEqual:()=>RD,assert:()=>ZD,allowsEval:()=>kX,aborted:()=>H6,NUMBER_FORMAT_RANGES:()=>xX,Class:()=>HW,BIGINT_FORMAT_RANGES:()=>JW});function RD(Q){return Q}function ED(Q){return Q}function PD(Q){}function SD(Q){throw Error()}function ZD(Q){}function P4(Q){let X=Object.values(Q).filter((Y)=>typeof Y==="number");return Object.entries(Q).filter(([Y,G])=>X.indexOf(+Y)===-1).map(([Y,G])=>G)}function G9(Q,X="|"){return Q.map(($)=>W9($)).join(X)}function ZX(Q,X){if(typeof X==="bigint")return X.toString();return X}function S4(Q){return{get value(){{let $=Q();return Object.defineProperty(this,"value",{value:$}),$}throw Error("cached value already set")}}}function Z4(Q){return Q===null||Q===void 0}function C4(Q){let X=Q.startsWith("^")?1:0,$=Q.endsWith("$")?Q.length-1:Q.length;return Q.slice(X,$)}function CX(Q,X){let $=(Q.toString().split(".")[1]||"").length,Y=(X.toString().split(".")[1]||"").length,G=$>Y?$:Y,J=Number.parseInt(Q.toFixed(G).replace(".","")),W=Number.parseInt(X.toFixed(G).replace(".",""));return J%W/10**G}function Y1(Q,X,$){Object.defineProperty(Q,X,{get(){{let G=$();return Q[X]=G,G}throw Error("cached value already set")},set(G){Object.defineProperty(Q,X,{value:G})},configurable:!0})}function _X(Q,X,$){Object.defineProperty(Q,X,{value:$,writable:!0,enumerable:!0,configurable:!0})}function CD(Q,X){if(!X)return Q;return X.reduce(($,Y)=>$?.[Y],Q)}function _D(Q){let X=Object.keys(Q),$=X.map((Y)=>Q[Y]);return Promise.all($).then((Y)=>{let G={};for(let J=0;J<X.length;J++)G[X[J]]=Y[J];return G})}function kD(Q=10){let $="";for(let Y=0;Y<Q;Y++)$+="abcdefghijklmnopqrstuvwxyz"[Math.floor(Math.random()*26)];return $}function W6(Q){return JSON.stringify(Q)}var J9=Error.captureStackTrace?Error.captureStackTrace:(...Q)=>{};function y6(Q){return typeof Q==="object"&&Q!==null&&!Array.isArray(Q)}var kX=S4(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return new Function(""),!0}catch(Q){return!1}});function g6(Q){if(y6(Q)===!1)return!1;let X=Q.constructor;if(X===void 0)return!0;let $=X.prototype;if(y6($)===!1)return!1;if(Object.prototype.hasOwnProperty.call($,"isPrototypeOf")===!1)return!1;return!0}function vD(Q){let X=0;for(let $ in Q)if(Object.prototype.hasOwnProperty.call(Q,$))X++;return X}var TD=(Q)=>{let X=typeof Q;switch(X){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(Q)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":if(Array.isArray(Q))return"array";if(Q===null)return"null";if(Q.then&&typeof Q.then==="function"&&Q.catch&&typeof Q.catch==="function")return"promise";if(typeof Map<"u"&&Q instanceof Map)return"map";if(typeof Set<"u"&&Q instanceof Set)return"set";if(typeof Date<"u"&&Q instanceof Date)return"date";if(typeof File<"u"&&Q instanceof File)return"file";return"object";default:throw Error(`Unknown data type: ${X}`)}},vX=new Set(["string","number","symbol"]),GW=new Set(["string","number","bigint","boolean","symbol","undefined"]);function g0(Q){return Q.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function l1(Q,X,$){let Y=new Q._zod.constr(X??Q._zod.def);if(!X||$?.parent)Y._zod.parent=Q;return Y}function x(Q){let X=Q;if(!X)return{};if(typeof X==="string")return{error:()=>X};if(X?.message!==void 0){if(X?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");X.error=X.message}if(delete X.message,typeof X.error==="string")return{...X,error:()=>X.error};return X}function xD(Q){let X;return new Proxy({},{get($,Y,G){return X??(X=Q()),Reflect.get(X,Y,G)},set($,Y,G,J){return X??(X=Q()),Reflect.set(X,Y,G,J)},has($,Y){return X??(X=Q()),Reflect.has(X,Y)},deleteProperty($,Y){return X??(X=Q()),Reflect.deleteProperty(X,Y)},ownKeys($){return X??(X=Q()),Reflect.ownKeys(X)},getOwnPropertyDescriptor($,Y){return X??(X=Q()),Reflect.getOwnPropertyDescriptor(X,Y)},defineProperty($,Y,G){return X??(X=Q()),Reflect.defineProperty(X,Y,G)}})}function W9(Q){if(typeof Q==="bigint")return Q.toString()+"n";if(typeof Q==="string")return`"${Q}"`;return`${Q}`}function TX(Q){return Object.keys(Q).filter((X)=>{return Q[X]._zod.optin==="optional"&&Q[X]._zod.optout==="optional"})}var xX={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-340282346638528860000000000000000000000,340282346638528860000000000000000000000],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},JW={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function yD(Q,X){let $={},Y=Q._zod.def;for(let G in X){if(!(G in Y.shape))throw Error(`Unrecognized key: "${G}"`);if(!X[G])continue;$[G]=Y.shape[G]}return l1(Q,{...Q._zod.def,shape:$,checks:[]})}function gD(Q,X){let $={...Q._zod.def.shape},Y=Q._zod.def;for(let G in X){if(!(G in Y.shape))throw Error(`Unrecognized key: "${G}"`);if(!X[G])continue;delete $[G]}return l1(Q,{...Q._zod.def,shape:$,checks:[]})}function fD(Q,X){if(!g6(X))throw Error("Invalid input to extend: expected a plain object");let $={...Q._zod.def,get shape(){let Y={...Q._zod.def.shape,...X};return _X(this,"shape",Y),Y},checks:[]};return l1(Q,$)}function hD(Q,X){return l1(Q,{...Q._zod.def,get shape(){let $={...Q._zod.def.shape,...X._zod.def.shape};return _X(this,"shape",$),$},catchall:X._zod.def.catchall,checks:[]})}function uD(Q,X,$){let Y=X._zod.def.shape,G={...Y};if($)for(let J in $){if(!(J in Y))throw Error(`Unrecognized key: "${J}"`);if(!$[J])continue;G[J]=Q?new Q({type:"optional",innerType:Y[J]}):Y[J]}else for(let J in Y)G[J]=Q?new Q({type:"optional",innerType:Y[J]}):Y[J];return l1(X,{...X._zod.def,shape:G,checks:[]})}function lD(Q,X,$){let Y=X._zod.def.shape,G={...Y};if($)for(let J in $){if(!(J in G))throw Error(`Unrecognized key: "${J}"`);if(!$[J])continue;G[J]=new Q({type:"nonoptional",innerType:Y[J]})}else for(let J in Y)G[J]=new Q({type:"nonoptional",innerType:Y[J]});return l1(X,{...X._zod.def,shape:G,checks:[]})}function H6(Q,X=0){for(let $=X;$<Q.issues.length;$++)if(Q.issues[$]?.continue!==!0)return!0;return!1}function B0(Q,X){return X.map(($)=>{var Y;return(Y=$).path??(Y.path=[]),$.path.unshift(Q),$})}function E4(Q){return typeof Q==="string"?Q:Q?.message}function a1(Q,X,$){let Y={...Q,path:Q.path??[]};if(!Q.message){let G=E4(Q.inst?._zod.def?.error?.(Q))??E4(X?.error?.(Q))??E4($.customError?.(Q))??E4($.localeError?.(Q))??"Invalid input";Y.message=G}if(delete Y.inst,delete Y.continue,!X?.reportInput)delete Y.input;return Y}function WW(Q){if(Q instanceof Set)return"set";if(Q instanceof Map)return"map";if(Q instanceof File)return"file";return"unknown"}function _4(Q){if(Array.isArray(Q))return"array";if(typeof Q==="string")return"string";return"unknown"}function yX(...Q){let[X,$,Y]=Q;if(typeof X==="string")return{message:X,code:"custom",input:$,inst:Y};return{...X}}function mD(Q){return Object.entries(Q).filter(([X,$])=>{return Number.isNaN(Number.parseInt(X,10))}).map((X)=>X[1])}class HW{constructor(...Q){}}var zW=(Q,X)=>{Q.name="$ZodError",Object.defineProperty(Q,"_zod",{value:Q._zod,enumerable:!1}),Object.defineProperty(Q,"issues",{value:X,enumerable:!1}),Object.defineProperty(Q,"message",{get(){return JSON.stringify(X,ZX,2)},enumerable:!0})},H9=D("$ZodError",zW),k4=D("$ZodError",zW,{Parent:Error});function gX(Q,X=($)=>$.message){let $={},Y=[];for(let G of Q.issues)if(G.path.length>0)$[G.path[0]]=$[G.path[0]]||[],$[G.path[0]].push(X(G));else Y.push(X(G));return{formErrors:Y,fieldErrors:$}}function fX(Q,X){let $=X||function(J){return J.message},Y={_errors:[]},G=(J)=>{for(let W of J.issues)if(W.code==="invalid_union"&&W.errors.length)W.errors.map((H)=>G({issues:H}));else if(W.code==="invalid_key")G({issues:W.issues});else if(W.code==="invalid_element")G({issues:W.issues});else if(W.path.length===0)Y._errors.push($(W));else{let H=Y,z=0;while(z<W.path.length){let B=W.path[z];if(z!==W.path.length-1)H[B]=H[B]||{_errors:[]};else H[B]=H[B]||{_errors:[]},H[B]._errors.push($(W));H=H[B],z++}}};return G(Q),Y}var hX=(Q)=>(X,$,Y,G)=>{let J=Y?Object.assign(Y,{async:!1}):{async:!1},W=X._zod.run({value:$,issues:[]},J);if(W instanceof Promise)throw new y0;if(W.issues.length){let H=new(G?.Err??Q)(W.issues.map((z)=>a1(z,J,u1())));throw J9(H,G?.callee),H}return W.value},uX=hX(k4),lX=(Q)=>async(X,$,Y,G)=>{let J=Y?Object.assign(Y,{async:!0}):{async:!0},W=X._zod.run({value:$,issues:[]},J);if(W instanceof Promise)W=await W;if(W.issues.length){let H=new(G?.Err??Q)(W.issues.map((z)=>a1(z,J,u1())));throw J9(H,G?.callee),H}return W.value},mX=lX(k4),cX=(Q)=>(X,$,Y)=>{let G=Y?{...Y,async:!1}:{async:!1},J=X._zod.run({value:$,issues:[]},G);if(J instanceof Promise)throw new y0;return J.issues.length?{success:!1,error:new(Q??H9)(J.issues.map((W)=>a1(W,G,u1())))}:{success:!0,data:J.value}},z6=cX(k4),pX=(Q)=>async(X,$,Y)=>{let G=Y?Object.assign(Y,{async:!0}):{async:!0},J=X._zod.run({value:$,issues:[]},G);if(J instanceof Promise)J=await J;return J.issues.length?{success:!1,error:new Q(J.issues.map((W)=>a1(W,G,u1())))}:{success:!0,data:J.value}},B6=pX(k4);var BW=/^[cC][^\s-]{8,}$/,KW=/^[0-9a-z]+$/,VW=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,qW=/^[0-9a-vA-V]{20}$/,UW=/^[A-Za-z0-9]{27}$/,LW=/^[a-zA-Z0-9_-]{21}$/,FW=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/;var NW=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,dX=(Q)=>{if(!Q)return/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/;return new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${Q}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`)};var DW=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/;function OW(){return new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")}var MW=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,AW=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,wW=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,jW=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,IW=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,iX=/^[A-Za-z0-9_-]*$/,bW=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/;var RW=/^\+(?:[0-9]){6,14}[0-9]$/,EW="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",PW=new RegExp(`^${EW}$`);function SW(Q){return typeof Q.precision==="number"?Q.precision===-1?"(?:[01]\\d|2[0-3]):[0-5]\\d":Q.precision===0?"(?:[01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d":`(?:[01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d\\.\\d{${Q.precision}}`:"(?:[01]\\d|2[0-3]):[0-5]\\d(?::[0-5]\\d(?:\\.\\d+)?)?"}function ZW(Q){return new RegExp(`^${SW(Q)}$`)}function CW(Q){let X=SW({precision:Q.precision}),$=["Z"];if(Q.local)$.push("");if(Q.offset)$.push("([+-]\\d{2}:\\d{2})");let Y=`${X}(?:${$.join("|")})`;return new RegExp(`^${EW}T(?:${Y})$`)}var _W=(Q)=>{let X=Q?`[\\s\\S]{${Q?.minimum??0},${Q?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${X}$`)};var kW=/^\d+$/,vW=/^-?\d+(?:\.\d+)?/i,TW=/true|false/i,xW=/null/i;var yW=/^[^A-Z]*$/,gW=/^[^a-z]*$/;var A1=D("$ZodCheck",(Q,X)=>{var $;Q._zod??(Q._zod={}),Q._zod.def=X,($=Q._zod).onattach??($.onattach=[])}),fW={number:"number",bigint:"bigint",object:"date"},nX=D("$ZodCheckLessThan",(Q,X)=>{A1.init(Q,X);let $=fW[typeof X.value];Q._zod.onattach.push((Y)=>{let G=Y._zod.bag,J=(X.inclusive?G.maximum:G.exclusiveMaximum)??Number.POSITIVE_INFINITY;if(X.value<J)if(X.inclusive)G.maximum=X.value;else G.exclusiveMaximum=X.value}),Q._zod.check=(Y)=>{if(X.inclusive?Y.value<=X.value:Y.value<X.value)return;Y.issues.push({origin:$,code:"too_big",maximum:X.value,input:Y.value,inclusive:X.inclusive,inst:Q,continue:!X.abort})}}),oX=D("$ZodCheckGreaterThan",(Q,X)=>{A1.init(Q,X);let $=fW[typeof X.value];Q._zod.onattach.push((Y)=>{let G=Y._zod.bag,J=(X.inclusive?G.minimum:G.exclusiveMinimum)??Number.NEGATIVE_INFINITY;if(X.value>J)if(X.inclusive)G.minimum=X.value;else G.exclusiveMinimum=X.value}),Q._zod.check=(Y)=>{if(X.inclusive?Y.value>=X.value:Y.value>X.value)return;Y.issues.push({origin:$,code:"too_small",minimum:X.value,input:Y.value,inclusive:X.inclusive,inst:Q,continue:!X.abort})}}),hW=D("$ZodCheckMultipleOf",(Q,X)=>{A1.init(Q,X),Q._zod.onattach.push(($)=>{var Y;(Y=$._zod.bag).multipleOf??(Y.multipleOf=X.value)}),Q._zod.check=($)=>{if(typeof $.value!==typeof X.value)throw Error("Cannot mix number and bigint in multiple_of check.");if(typeof $.value==="bigint"?$.value%X.value===BigInt(0):CX($.value,X.value)===0)return;$.issues.push({origin:typeof $.value,code:"not_multiple_of",divisor:X.value,input:$.value,inst:Q,continue:!X.abort})}}),uW=D("$ZodCheckNumberFormat",(Q,X)=>{A1.init(Q,X),X.format=X.format||"float64";let $=X.format?.includes("int"),Y=$?"int":"number",[G,J]=xX[X.format];Q._zod.onattach.push((W)=>{let H=W._zod.bag;if(H.format=X.format,H.minimum=G,H.maximum=J,$)H.pattern=kW}),Q._zod.check=(W)=>{let H=W.value;if($){if(!Number.isInteger(H)){W.issues.push({expected:Y,format:X.format,code:"invalid_type",input:H,inst:Q});return}if(!Number.isSafeInteger(H)){if(H>0)W.issues.push({input:H,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:Q,origin:Y,continue:!X.abort});else W.issues.push({input:H,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:Q,origin:Y,continue:!X.abort});return}}if(H<G)W.issues.push({origin:"number",input:H,code:"too_small",minimum:G,inclusive:!0,inst:Q,continue:!X.abort});if(H>J)W.issues.push({origin:"number",input:H,code:"too_big",maximum:J,inst:Q})}});var lW=D("$ZodCheckMaxLength",(Q,X)=>{A1.init(Q,X),Q._zod.when=($)=>{let Y=$.value;return!Z4(Y)&&Y.length!==void 0},Q._zod.onattach.push(($)=>{let Y=$._zod.bag.maximum??Number.POSITIVE_INFINITY;if(X.maximum<Y)$._zod.bag.maximum=X.maximum}),Q._zod.check=($)=>{let Y=$.value;if(Y.length<=X.maximum)return;let J=_4(Y);$.issues.push({origin:J,code:"too_big",maximum:X.maximum,inclusive:!0,input:Y,inst:Q,continue:!X.abort})}}),mW=D("$ZodCheckMinLength",(Q,X)=>{A1.init(Q,X),Q._zod.when=($)=>{let Y=$.value;return!Z4(Y)&&Y.length!==void 0},Q._zod.onattach.push(($)=>{let Y=$._zod.bag.minimum??Number.NEGATIVE_INFINITY;if(X.minimum>Y)$._zod.bag.minimum=X.minimum}),Q._zod.check=($)=>{let Y=$.value;if(Y.length>=X.minimum)return;let J=_4(Y);$.issues.push({origin:J,code:"too_small",minimum:X.minimum,inclusive:!0,input:Y,inst:Q,continue:!X.abort})}}),cW=D("$ZodCheckLengthEquals",(Q,X)=>{A1.init(Q,X),Q._zod.when=($)=>{let Y=$.value;return!Z4(Y)&&Y.length!==void 0},Q._zod.onattach.push(($)=>{let Y=$._zod.bag;Y.minimum=X.length,Y.maximum=X.length,Y.length=X.length}),Q._zod.check=($)=>{let Y=$.value,G=Y.length;if(G===X.length)return;let J=_4(Y),W=G>X.length;$.issues.push({origin:J,...W?{code:"too_big",maximum:X.length}:{code:"too_small",minimum:X.length},inclusive:!0,exact:!0,input:$.value,inst:Q,continue:!X.abort})}}),v4=D("$ZodCheckStringFormat",(Q,X)=>{var $,Y;if(A1.init(Q,X),Q._zod.onattach.push((G)=>{let J=G._zod.bag;if(J.format=X.format,X.pattern)J.patterns??(J.patterns=new Set),J.patterns.add(X.pattern)}),X.pattern)($=Q._zod).check??($.check=(G)=>{if(X.pattern.lastIndex=0,X.pattern.test(G.value))return;G.issues.push({origin:"string",code:"invalid_format",format:X.format,input:G.value,...X.pattern?{pattern:X.pattern.toString()}:{},inst:Q,continue:!X.abort})});else(Y=Q._zod).check??(Y.check=()=>{})}),pW=D("$ZodCheckRegex",(Q,X)=>{v4.init(Q,X),Q._zod.check=($)=>{if(X.pattern.lastIndex=0,X.pattern.test($.value))return;$.issues.push({origin:"string",code:"invalid_format",format:"regex",input:$.value,pattern:X.pattern.toString(),inst:Q,continue:!X.abort})}}),dW=D("$ZodCheckLowerCase",(Q,X)=>{X.pattern??(X.pattern=yW),v4.init(Q,X)}),iW=D("$ZodCheckUpperCase",(Q,X)=>{X.pattern??(X.pattern=gW),v4.init(Q,X)}),nW=D("$ZodCheckIncludes",(Q,X)=>{A1.init(Q,X);let $=g0(X.includes),Y=new RegExp(typeof X.position==="number"?`^.{${X.position}}${$}`:$);X.pattern=Y,Q._zod.onattach.push((G)=>{let J=G._zod.bag;J.patterns??(J.patterns=new Set),J.patterns.add(Y)}),Q._zod.check=(G)=>{if(G.value.includes(X.includes,X.position))return;G.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:X.includes,input:G.value,inst:Q,continue:!X.abort})}}),oW=D("$ZodCheckStartsWith",(Q,X)=>{A1.init(Q,X);let $=new RegExp(`^${g0(X.prefix)}.*`);X.pattern??(X.pattern=$),Q._zod.onattach.push((Y)=>{let G=Y._zod.bag;G.patterns??(G.patterns=new Set),G.patterns.add($)}),Q._zod.check=(Y)=>{if(Y.value.startsWith(X.prefix))return;Y.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:X.prefix,input:Y.value,inst:Q,continue:!X.abort})}}),rW=D("$ZodCheckEndsWith",(Q,X)=>{A1.init(Q,X);let $=new RegExp(`.*${g0(X.suffix)}$`);X.pattern??(X.pattern=$),Q._zod.onattach.push((Y)=>{let G=Y._zod.bag;G.patterns??(G.patterns=new Set),G.patterns.add($)}),Q._zod.check=(Y)=>{if(Y.value.endsWith(X.suffix))return;Y.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:X.suffix,input:Y.value,inst:Q,continue:!X.abort})}});var tW=D("$ZodCheckOverwrite",(Q,X)=>{A1.init(Q,X),Q._zod.check=($)=>{$.value=X.tx($.value)}});class rX{constructor(Q=[]){if(this.content=[],this.indent=0,this)this.args=Q}indented(Q){this.indent+=1,Q(this),this.indent-=1}write(Q){if(typeof Q==="function"){Q(this,{execution:"sync"}),Q(this,{execution:"async"});return}let $=Q.split(`
`).filter((J)=>J),Y=Math.min(...$.map((J)=>J.length-J.trimStart().length)),G=$.map((J)=>J.slice(Y)).map((J)=>" ".repeat(this.indent*2)+J);for(let J of G)this.content.push(J)}compile(){let Q=Function,X=this?.args,Y=[...(this?.content??[""]).map((G)=>`  ${G}`)];return new Q(...X,Y.join(`
`))}}var sW={major:4,minor:0,patch:0};var X1=D("$ZodType",(Q,X)=>{var $;Q??(Q={}),Q._zod.def=X,Q._zod.bag=Q._zod.bag||{},Q._zod.version=sW;let Y=[...Q._zod.def.checks??[]];if(Q._zod.traits.has("$ZodCheck"))Y.unshift(Q);for(let G of Y)for(let J of G._zod.onattach)J(Q);if(Y.length===0)($=Q._zod).deferred??($.deferred=[]),Q._zod.deferred?.push(()=>{Q._zod.run=Q._zod.parse});else{let G=(J,W,H)=>{let z=H6(J),B;for(let K of W){if(K._zod.when){if(!K._zod.when(J))continue}else if(z)continue;let q=J.issues.length,U=K._zod.check(J);if(U instanceof Promise&&H?.async===!1)throw new y0;if(B||U instanceof Promise)B=(B??Promise.resolve()).then(async()=>{if(await U,J.issues.length===q)return;if(!z)z=H6(J,q)});else{if(J.issues.length===q)continue;if(!z)z=H6(J,q)}}if(B)return B.then(()=>{return J});return J};Q._zod.run=(J,W)=>{let H=Q._zod.parse(J,W);if(H instanceof Promise){if(W.async===!1)throw new y0;return H.then((z)=>G(z,Y,W))}return G(H,Y,W)}}Q["~standard"]={validate:(G)=>{try{let J=z6(Q,G);return J.success?{value:J.data}:{issues:J.error?.issues}}catch(J){return B6(Q,G).then((W)=>W.success?{value:W.data}:{issues:W.error?.issues})}},vendor:"zod",version:1}}),T4=D("$ZodString",(Q,X)=>{X1.init(Q,X),Q._zod.pattern=[...Q?._zod.bag?.patterns??[]].pop()??_W(Q._zod.bag),Q._zod.parse=($,Y)=>{if(X.coerce)try{$.value=String($.value)}catch(G){}if(typeof $.value==="string")return $;return $.issues.push({expected:"string",code:"invalid_type",input:$.value,inst:Q}),$}}),G1=D("$ZodStringFormat",(Q,X)=>{v4.init(Q,X),T4.init(Q,X)}),aX=D("$ZodGUID",(Q,X)=>{X.pattern??(X.pattern=NW),G1.init(Q,X)}),sX=D("$ZodUUID",(Q,X)=>{if(X.version){let Y={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[X.version];if(Y===void 0)throw Error(`Invalid UUID version: "${X.version}"`);X.pattern??(X.pattern=dX(Y))}else X.pattern??(X.pattern=dX());G1.init(Q,X)}),eX=D("$ZodEmail",(Q,X)=>{X.pattern??(X.pattern=DW),G1.init(Q,X)}),Q$=D("$ZodURL",(Q,X)=>{G1.init(Q,X),Q._zod.check=($)=>{try{let Y=$.value,G=new URL(Y),J=G.href;if(X.hostname){if(X.hostname.lastIndex=0,!X.hostname.test(G.hostname))$.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:bW.source,input:$.value,inst:Q,continue:!X.abort})}if(X.protocol){if(X.protocol.lastIndex=0,!X.protocol.test(G.protocol.endsWith(":")?G.protocol.slice(0,-1):G.protocol))$.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:X.protocol.source,input:$.value,inst:Q,continue:!X.abort})}if(!Y.endsWith("/")&&J.endsWith("/"))$.value=J.slice(0,-1);else $.value=J;return}catch(Y){$.issues.push({code:"invalid_format",format:"url",input:$.value,inst:Q,continue:!X.abort})}}}),X$=D("$ZodEmoji",(Q,X)=>{X.pattern??(X.pattern=OW()),G1.init(Q,X)}),$$=D("$ZodNanoID",(Q,X)=>{X.pattern??(X.pattern=LW),G1.init(Q,X)}),Y$=D("$ZodCUID",(Q,X)=>{X.pattern??(X.pattern=BW),G1.init(Q,X)}),G$=D("$ZodCUID2",(Q,X)=>{X.pattern??(X.pattern=KW),G1.init(Q,X)}),J$=D("$ZodULID",(Q,X)=>{X.pattern??(X.pattern=VW),G1.init(Q,X)}),W$=D("$ZodXID",(Q,X)=>{X.pattern??(X.pattern=qW),G1.init(Q,X)}),H$=D("$ZodKSUID",(Q,X)=>{X.pattern??(X.pattern=UW),G1.init(Q,X)}),z3=D("$ZodISODateTime",(Q,X)=>{X.pattern??(X.pattern=CW(X)),G1.init(Q,X)}),B3=D("$ZodISODate",(Q,X)=>{X.pattern??(X.pattern=PW),G1.init(Q,X)}),K3=D("$ZodISOTime",(Q,X)=>{X.pattern??(X.pattern=ZW(X)),G1.init(Q,X)}),V3=D("$ZodISODuration",(Q,X)=>{X.pattern??(X.pattern=FW),G1.init(Q,X)}),z$=D("$ZodIPv4",(Q,X)=>{X.pattern??(X.pattern=MW),G1.init(Q,X),Q._zod.onattach.push(($)=>{let Y=$._zod.bag;Y.format="ipv4"})}),B$=D("$ZodIPv6",(Q,X)=>{X.pattern??(X.pattern=AW),G1.init(Q,X),Q._zod.onattach.push(($)=>{let Y=$._zod.bag;Y.format="ipv6"}),Q._zod.check=($)=>{try{new URL(`http://[${$.value}]`)}catch{$.issues.push({code:"invalid_format",format:"ipv6",input:$.value,inst:Q,continue:!X.abort})}}}),K$=D("$ZodCIDRv4",(Q,X)=>{X.pattern??(X.pattern=wW),G1.init(Q,X)}),V$=D("$ZodCIDRv6",(Q,X)=>{X.pattern??(X.pattern=jW),G1.init(Q,X),Q._zod.check=($)=>{let[Y,G]=$.value.split("/");try{if(!G)throw Error();let J=Number(G);if(`${J}`!==G)throw Error();if(J<0||J>128)throw Error();new URL(`http://[${Y}]`)}catch{$.issues.push({code:"invalid_format",format:"cidrv6",input:$.value,inst:Q,continue:!X.abort})}}});function q3(Q){if(Q==="")return!0;if(Q.length%4!==0)return!1;try{return atob(Q),!0}catch{return!1}}var q$=D("$ZodBase64",(Q,X)=>{X.pattern??(X.pattern=IW),G1.init(Q,X),Q._zod.onattach.push(($)=>{$._zod.bag.contentEncoding="base64"}),Q._zod.check=($)=>{if(q3($.value))return;$.issues.push({code:"invalid_format",format:"base64",input:$.value,inst:Q,continue:!X.abort})}});function pD(Q){if(!iX.test(Q))return!1;let X=Q.replace(/[-_]/g,(Y)=>Y==="-"?"+":"/"),$=X.padEnd(Math.ceil(X.length/4)*4,"=");return q3($)}var U$=D("$ZodBase64URL",(Q,X)=>{X.pattern??(X.pattern=iX),G1.init(Q,X),Q._zod.onattach.push(($)=>{$._zod.bag.contentEncoding="base64url"}),Q._zod.check=($)=>{if(pD($.value))return;$.issues.push({code:"invalid_format",format:"base64url",input:$.value,inst:Q,continue:!X.abort})}}),L$=D("$ZodE164",(Q,X)=>{X.pattern??(X.pattern=RW),G1.init(Q,X)});function dD(Q,X=null){try{let $=Q.split(".");if($.length!==3)return!1;let[Y]=$;if(!Y)return!1;let G=JSON.parse(atob(Y));if("typ"in G&&G?.typ!=="JWT")return!1;if(!G.alg)return!1;if(X&&(!("alg"in G)||G.alg!==X))return!1;return!0}catch{return!1}}var F$=D("$ZodJWT",(Q,X)=>{G1.init(Q,X),Q._zod.check=($)=>{if(dD($.value,X.alg))return;$.issues.push({code:"invalid_format",format:"jwt",input:$.value,inst:Q,continue:!X.abort})}});var K9=D("$ZodNumber",(Q,X)=>{X1.init(Q,X),Q._zod.pattern=Q._zod.bag.pattern??vW,Q._zod.parse=($,Y)=>{if(X.coerce)try{$.value=Number($.value)}catch(W){}let G=$.value;if(typeof G==="number"&&!Number.isNaN(G)&&Number.isFinite(G))return $;let J=typeof G==="number"?Number.isNaN(G)?"NaN":!Number.isFinite(G)?"Infinity":void 0:void 0;return $.issues.push({expected:"number",code:"invalid_type",input:G,inst:Q,...J?{received:J}:{}}),$}}),N$=D("$ZodNumber",(Q,X)=>{uW.init(Q,X),K9.init(Q,X)}),D$=D("$ZodBoolean",(Q,X)=>{X1.init(Q,X),Q._zod.pattern=TW,Q._zod.parse=($,Y)=>{if(X.coerce)try{$.value=Boolean($.value)}catch(J){}let G=$.value;if(typeof G==="boolean")return $;return $.issues.push({expected:"boolean",code:"invalid_type",input:G,inst:Q}),$}});var O$=D("$ZodNull",(Q,X)=>{X1.init(Q,X),Q._zod.pattern=xW,Q._zod.values=new Set([null]),Q._zod.parse=($,Y)=>{let G=$.value;if(G===null)return $;return $.issues.push({expected:"null",code:"invalid_type",input:G,inst:Q}),$}});var M$=D("$ZodUnknown",(Q,X)=>{X1.init(Q,X),Q._zod.parse=($)=>$}),A$=D("$ZodNever",(Q,X)=>{X1.init(Q,X),Q._zod.parse=($,Y)=>{return $.issues.push({expected:"never",code:"invalid_type",input:$.value,inst:Q}),$}});function eW(Q,X,$){if(Q.issues.length)X.issues.push(...B0($,Q.issues));X.value[$]=Q.value}var w$=D("$ZodArray",(Q,X)=>{X1.init(Q,X),Q._zod.parse=($,Y)=>{let G=$.value;if(!Array.isArray(G))return $.issues.push({expected:"array",code:"invalid_type",input:G,inst:Q}),$;$.value=Array(G.length);let J=[];for(let W=0;W<G.length;W++){let H=G[W],z=X.element._zod.run({value:H,issues:[]},Y);if(z instanceof Promise)J.push(z.then((B)=>eW(B,$,W)));else eW(z,$,W)}if(J.length)return Promise.all(J).then(()=>$);return $}});function B9(Q,X,$){if(Q.issues.length)X.issues.push(...B0($,Q.issues));X.value[$]=Q.value}function Q3(Q,X,$,Y){if(Q.issues.length)if(Y[$]===void 0)if($ in Y)X.value[$]=void 0;else X.value[$]=Q.value;else X.issues.push(...B0($,Q.issues));else if(Q.value===void 0){if($ in Y)X.value[$]=void 0}else X.value[$]=Q.value}var V9=D("$ZodObject",(Q,X)=>{X1.init(Q,X);let $=S4(()=>{let q=Object.keys(X.shape);for(let V of q)if(!(X.shape[V]instanceof X1))throw Error(`Invalid element at key "${V}": expected a Zod schema`);let U=TX(X.shape);return{shape:X.shape,keys:q,keySet:new Set(q),numKeys:q.length,optionalKeys:new Set(U)}});Y1(Q._zod,"propValues",()=>{let q=X.shape,U={};for(let V in q){let L=q[V]._zod;if(L.values){U[V]??(U[V]=new Set);for(let F of L.values)U[V].add(F)}}return U});let Y=(q)=>{let U=new rX(["shape","payload","ctx"]),V=$.value,L=(j)=>{let I=W6(j);return`shape[${I}]._zod.run({ value: input[${I}], issues: [] }, ctx)`};U.write("const input = payload.value;");let F=Object.create(null),M=0;for(let j of V.keys)F[j]=`key_${M++}`;U.write("const newResult = {}");for(let j of V.keys)if(V.optionalKeys.has(j)){let I=F[j];U.write(`const ${I} = ${L(j)};`);let v=W6(j);U.write(`
        if (${I}.issues.length) {
          if (input[${v}] === undefined) {
            if (${v} in input) {
              newResult[${v}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${I}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${v}, ...iss.path] : [${v}],
              }))
            );
          }
        } else if (${I}.value === undefined) {
          if (${v} in input) newResult[${v}] = undefined;
        } else {
          newResult[${v}] = ${I}.value;
        }
        `)}else{let I=F[j];U.write(`const ${I} = ${L(j)};`),U.write(`
          if (${I}.issues.length) payload.issues = payload.issues.concat(${I}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${W6(j)}, ...iss.path] : [${W6(j)}]
          })));`),U.write(`newResult[${W6(j)}] = ${I}.value`)}U.write("payload.value = newResult;"),U.write("return payload;");let O=U.compile();return(j,I)=>O(q,j,I)},G,J=y6,W=!Y9.jitless,z=W&&kX.value,B=X.catchall,K;Q._zod.parse=(q,U)=>{K??(K=$.value);let V=q.value;if(!J(V))return q.issues.push({expected:"object",code:"invalid_type",input:V,inst:Q}),q;let L=[];if(W&&z&&U?.async===!1&&U.jitless!==!0){if(!G)G=Y(X.shape);q=G(q,U)}else{q.value={};let I=K.shape;for(let v of K.keys){let k=I[v],q1=k._zod.run({value:V[v],issues:[]},U),F1=k._zod.optin==="optional"&&k._zod.optout==="optional";if(q1 instanceof Promise)L.push(q1.then((c1)=>F1?Q3(c1,q,v,V):B9(c1,q,v)));else if(F1)Q3(q1,q,v,V);else B9(q1,q,v)}}if(!B)return L.length?Promise.all(L).then(()=>q):q;let F=[],M=K.keySet,O=B._zod,j=O.def.type;for(let I of Object.keys(V)){if(M.has(I))continue;if(j==="never"){F.push(I);continue}let v=O.run({value:V[I],issues:[]},U);if(v instanceof Promise)L.push(v.then((k)=>B9(k,q,I)));else B9(v,q,I)}if(F.length)q.issues.push({code:"unrecognized_keys",keys:F,input:V,inst:Q});if(!L.length)return q;return Promise.all(L).then(()=>{return q})}});function X3(Q,X,$,Y){for(let G of Q)if(G.issues.length===0)return X.value=G.value,X;return X.issues.push({code:"invalid_union",input:X.value,inst:$,errors:Q.map((G)=>G.issues.map((J)=>a1(J,Y,u1())))}),X}var q9=D("$ZodUnion",(Q,X)=>{X1.init(Q,X),Y1(Q._zod,"optin",()=>X.options.some(($)=>$._zod.optin==="optional")?"optional":void 0),Y1(Q._zod,"optout",()=>X.options.some(($)=>$._zod.optout==="optional")?"optional":void 0),Y1(Q._zod,"values",()=>{if(X.options.every(($)=>$._zod.values))return new Set(X.options.flatMap(($)=>Array.from($._zod.values)));return}),Y1(Q._zod,"pattern",()=>{if(X.options.every(($)=>$._zod.pattern)){let $=X.options.map((Y)=>Y._zod.pattern);return new RegExp(`^(${$.map((Y)=>C4(Y.source)).join("|")})$`)}return}),Q._zod.parse=($,Y)=>{let G=!1,J=[];for(let W of X.options){let H=W._zod.run({value:$.value,issues:[]},Y);if(H instanceof Promise)J.push(H),G=!0;else{if(H.issues.length===0)return H;J.push(H)}}if(!G)return X3(J,$,Q,Y);return Promise.all(J).then((W)=>{return X3(W,$,Q,Y)})}}),j$=D("$ZodDiscriminatedUnion",(Q,X)=>{q9.init(Q,X);let $=Q._zod.parse;Y1(Q._zod,"propValues",()=>{let G={};for(let J of X.options){let W=J._zod.propValues;if(!W||Object.keys(W).length===0)throw Error(`Invalid discriminated union option at index "${X.options.indexOf(J)}"`);for(let[H,z]of Object.entries(W)){if(!G[H])G[H]=new Set;for(let B of z)G[H].add(B)}}return G});let Y=S4(()=>{let G=X.options,J=new Map;for(let W of G){let H=W._zod.propValues[X.discriminator];if(!H||H.size===0)throw Error(`Invalid discriminated union option at index "${X.options.indexOf(W)}"`);for(let z of H){if(J.has(z))throw Error(`Duplicate discriminator value "${String(z)}"`);J.set(z,W)}}return J});Q._zod.parse=(G,J)=>{let W=G.value;if(!y6(W))return G.issues.push({code:"invalid_type",expected:"object",input:W,inst:Q}),G;let H=Y.value.get(W?.[X.discriminator]);if(H)return H._zod.run(G,J);if(X.unionFallback)return $(G,J);return G.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:W,path:[X.discriminator],inst:Q}),G}}),I$=D("$ZodIntersection",(Q,X)=>{X1.init(Q,X),Q._zod.parse=($,Y)=>{let G=$.value,J=X.left._zod.run({value:G,issues:[]},Y),W=X.right._zod.run({value:G,issues:[]},Y);if(J instanceof Promise||W instanceof Promise)return Promise.all([J,W]).then(([z,B])=>{return $3($,z,B)});return $3($,J,W)}});function tX(Q,X){if(Q===X)return{valid:!0,data:Q};if(Q instanceof Date&&X instanceof Date&&+Q===+X)return{valid:!0,data:Q};if(g6(Q)&&g6(X)){let $=Object.keys(X),Y=Object.keys(Q).filter((J)=>$.indexOf(J)!==-1),G={...Q,...X};for(let J of Y){let W=tX(Q[J],X[J]);if(!W.valid)return{valid:!1,mergeErrorPath:[J,...W.mergeErrorPath]};G[J]=W.data}return{valid:!0,data:G}}if(Array.isArray(Q)&&Array.isArray(X)){if(Q.length!==X.length)return{valid:!1,mergeErrorPath:[]};let $=[];for(let Y=0;Y<Q.length;Y++){let G=Q[Y],J=X[Y],W=tX(G,J);if(!W.valid)return{valid:!1,mergeErrorPath:[Y,...W.mergeErrorPath]};$.push(W.data)}return{valid:!0,data:$}}return{valid:!1,mergeErrorPath:[]}}function $3(Q,X,$){if(X.issues.length)Q.issues.push(...X.issues);if($.issues.length)Q.issues.push(...$.issues);if(H6(Q))return Q;let Y=tX(X.value,$.value);if(!Y.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(Y.mergeErrorPath)}`);return Q.value=Y.data,Q}var b$=D("$ZodRecord",(Q,X)=>{X1.init(Q,X),Q._zod.parse=($,Y)=>{let G=$.value;if(!g6(G))return $.issues.push({expected:"record",code:"invalid_type",input:G,inst:Q}),$;let J=[];if(X.keyType._zod.values){let W=X.keyType._zod.values;$.value={};for(let z of W)if(typeof z==="string"||typeof z==="number"||typeof z==="symbol"){let B=X.valueType._zod.run({value:G[z],issues:[]},Y);if(B instanceof Promise)J.push(B.then((K)=>{if(K.issues.length)$.issues.push(...B0(z,K.issues));$.value[z]=K.value}));else{if(B.issues.length)$.issues.push(...B0(z,B.issues));$.value[z]=B.value}}let H;for(let z in G)if(!W.has(z))H=H??[],H.push(z);if(H&&H.length>0)$.issues.push({code:"unrecognized_keys",input:G,inst:Q,keys:H})}else{$.value={};for(let W of Reflect.ownKeys(G)){if(W==="__proto__")continue;let H=X.keyType._zod.run({value:W,issues:[]},Y);if(H instanceof Promise)throw Error("Async schemas not supported in object keys currently");if(H.issues.length){$.issues.push({origin:"record",code:"invalid_key",issues:H.issues.map((B)=>a1(B,Y,u1())),input:W,path:[W],inst:Q}),$.value[H.value]=H.value;continue}let z=X.valueType._zod.run({value:G[W],issues:[]},Y);if(z instanceof Promise)J.push(z.then((B)=>{if(B.issues.length)$.issues.push(...B0(W,B.issues));$.value[H.value]=B.value}));else{if(z.issues.length)$.issues.push(...B0(W,z.issues));$.value[H.value]=z.value}}}if(J.length)return Promise.all(J).then(()=>$);return $}});var R$=D("$ZodEnum",(Q,X)=>{X1.init(Q,X);let $=P4(X.entries);Q._zod.values=new Set($),Q._zod.pattern=new RegExp(`^(${$.filter((Y)=>vX.has(typeof Y)).map((Y)=>typeof Y==="string"?g0(Y):Y.toString()).join("|")})$`),Q._zod.parse=(Y,G)=>{let J=Y.value;if(Q._zod.values.has(J))return Y;return Y.issues.push({code:"invalid_value",values:$,input:J,inst:Q}),Y}}),E$=D("$ZodLiteral",(Q,X)=>{X1.init(Q,X),Q._zod.values=new Set(X.values),Q._zod.pattern=new RegExp(`^(${X.values.map(($)=>typeof $==="string"?g0($):$?$.toString():String($)).join("|")})$`),Q._zod.parse=($,Y)=>{let G=$.value;if(Q._zod.values.has(G))return $;return $.issues.push({code:"invalid_value",values:X.values,input:G,inst:Q}),$}});var P$=D("$ZodTransform",(Q,X)=>{X1.init(Q,X),Q._zod.parse=($,Y)=>{let G=X.transform($.value,$);if(Y.async)return(G instanceof Promise?G:Promise.resolve(G)).then((W)=>{return $.value=W,$});if(G instanceof Promise)throw new y0;return $.value=G,$}}),S$=D("$ZodOptional",(Q,X)=>{X1.init(Q,X),Q._zod.optin="optional",Q._zod.optout="optional",Y1(Q._zod,"values",()=>{return X.innerType._zod.values?new Set([...X.innerType._zod.values,void 0]):void 0}),Y1(Q._zod,"pattern",()=>{let $=X.innerType._zod.pattern;return $?new RegExp(`^(${C4($.source)})?$`):void 0}),Q._zod.parse=($,Y)=>{if(X.innerType._zod.optin==="optional")return X.innerType._zod.run($,Y);if($.value===void 0)return $;return X.innerType._zod.run($,Y)}}),Z$=D("$ZodNullable",(Q,X)=>{X1.init(Q,X),Y1(Q._zod,"optin",()=>X.innerType._zod.optin),Y1(Q._zod,"optout",()=>X.innerType._zod.optout),Y1(Q._zod,"pattern",()=>{let $=X.innerType._zod.pattern;return $?new RegExp(`^(${C4($.source)}|null)$`):void 0}),Y1(Q._zod,"values",()=>{return X.innerType._zod.values?new Set([...X.innerType._zod.values,null]):void 0}),Q._zod.parse=($,Y)=>{if($.value===null)return $;return X.innerType._zod.run($,Y)}}),C$=D("$ZodDefault",(Q,X)=>{X1.init(Q,X),Q._zod.optin="optional",Y1(Q._zod,"values",()=>X.innerType._zod.values),Q._zod.parse=($,Y)=>{if($.value===void 0)return $.value=X.defaultValue,$;let G=X.innerType._zod.run($,Y);if(G instanceof Promise)return G.then((J)=>Y3(J,X));return Y3(G,X)}});function Y3(Q,X){if(Q.value===void 0)Q.value=X.defaultValue;return Q}var _$=D("$ZodPrefault",(Q,X)=>{X1.init(Q,X),Q._zod.optin="optional",Y1(Q._zod,"values",()=>X.innerType._zod.values),Q._zod.parse=($,Y)=>{if($.value===void 0)$.value=X.defaultValue;return X.innerType._zod.run($,Y)}}),k$=D("$ZodNonOptional",(Q,X)=>{X1.init(Q,X),Y1(Q._zod,"values",()=>{let $=X.innerType._zod.values;return $?new Set([...$].filter((Y)=>Y!==void 0)):void 0}),Q._zod.parse=($,Y)=>{let G=X.innerType._zod.run($,Y);if(G instanceof Promise)return G.then((J)=>G3(J,Q));return G3(G,Q)}});function G3(Q,X){if(!Q.issues.length&&Q.value===void 0)Q.issues.push({code:"invalid_type",expected:"nonoptional",input:Q.value,inst:X});return Q}var v$=D("$ZodCatch",(Q,X)=>{X1.init(Q,X),Q._zod.optin="optional",Y1(Q._zod,"optout",()=>X.innerType._zod.optout),Y1(Q._zod,"values",()=>X.innerType._zod.values),Q._zod.parse=($,Y)=>{let G=X.innerType._zod.run($,Y);if(G instanceof Promise)return G.then((J)=>{if($.value=J.value,J.issues.length)$.value=X.catchValue({...$,error:{issues:J.issues.map((W)=>a1(W,Y,u1()))},input:$.value}),$.issues=[];return $});if($.value=G.value,G.issues.length)$.value=X.catchValue({...$,error:{issues:G.issues.map((J)=>a1(J,Y,u1()))},input:$.value}),$.issues=[];return $}});var T$=D("$ZodPipe",(Q,X)=>{X1.init(Q,X),Y1(Q._zod,"values",()=>X.in._zod.values),Y1(Q._zod,"optin",()=>X.in._zod.optin),Y1(Q._zod,"optout",()=>X.out._zod.optout),Q._zod.parse=($,Y)=>{let G=X.in._zod.run($,Y);if(G instanceof Promise)return G.then((J)=>J3(J,X,Y));return J3(G,X,Y)}});function J3(Q,X,$){if(H6(Q))return Q;return X.out._zod.run({value:Q.value,issues:Q.issues},$)}var x$=D("$ZodReadonly",(Q,X)=>{X1.init(Q,X),Y1(Q._zod,"propValues",()=>X.innerType._zod.propValues),Y1(Q._zod,"values",()=>X.innerType._zod.values),Y1(Q._zod,"optin",()=>X.innerType._zod.optin),Y1(Q._zod,"optout",()=>X.innerType._zod.optout),Q._zod.parse=($,Y)=>{let G=X.innerType._zod.run($,Y);if(G instanceof Promise)return G.then(W3);return W3(G)}});function W3(Q){return Q.value=Object.freeze(Q.value),Q}var y$=D("$ZodCustom",(Q,X)=>{A1.init(Q,X),X1.init(Q,X),Q._zod.parse=($,Y)=>{return $},Q._zod.check=($)=>{let Y=$.value,G=X.fn(Y);if(G instanceof Promise)return G.then((J)=>H3(J,$,Y,Q));H3(G,$,Y,Q);return}});function H3(Q,X,$,Y){if(!Q){let G={code:"custom",input:$,inst:Y,path:[...Y._zod.def.path??[]],continue:!Y._zod.def.abort};if(Y._zod.def.params)G.params=Y._zod.def.params;X.issues.push(yX(G))}}var iD=(Q)=>{let X=typeof Q;switch(X){case"number":return Number.isNaN(Q)?"NaN":"number";case"object":{if(Array.isArray(Q))return"array";if(Q===null)return"null";if(Object.getPrototypeOf(Q)!==Object.prototype&&Q.constructor)return Q.constructor.name}}return X},nD=()=>{let Q={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}};function X(Y){return Q[Y]??null}let $={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return(Y)=>{switch(Y.code){case"invalid_type":return`Invalid input: expected ${Y.expected}, received ${iD(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Invalid input: expected ${W9(Y.values[0])}`;return`Invalid option: expected one of ${G9(Y.values,"|")}`;case"too_big":{let G=Y.inclusive?"<=":"<",J=X(Y.origin);if(J)return`Too big: expected ${Y.origin??"value"} to have ${G}${Y.maximum.toString()} ${J.unit??"elements"}`;return`Too big: expected ${Y.origin??"value"} to be ${G}${Y.maximum.toString()}`}case"too_small":{let G=Y.inclusive?">=":">",J=X(Y.origin);if(J)return`Too small: expected ${Y.origin} to have ${G}${Y.minimum.toString()} ${J.unit}`;return`Too small: expected ${Y.origin} to be ${G}${Y.minimum.toString()}`}case"invalid_format":{let G=Y;if(G.format==="starts_with")return`Invalid string: must start with "${G.prefix}"`;if(G.format==="ends_with")return`Invalid string: must end with "${G.suffix}"`;if(G.format==="includes")return`Invalid string: must include "${G.includes}"`;if(G.format==="regex")return`Invalid string: must match pattern ${G.pattern}`;return`Invalid ${$[G.format]??Y.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${Y.divisor}`;case"unrecognized_keys":return`Unrecognized key${Y.keys.length>1?"s":""}: ${G9(Y.keys,", ")}`;case"invalid_key":return`Invalid key in ${Y.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${Y.origin}`;default:return"Invalid input"}}};function g$(){return{localeError:nD()}}var oD=Symbol("ZodOutput"),rD=Symbol("ZodInput");class U9{constructor(){this._map=new WeakMap,this._idmap=new Map}add(Q,...X){let $=X[0];if(this._map.set(Q,$),$&&typeof $==="object"&&"id"in $){if(this._idmap.has($.id))throw Error(`ID ${$.id} already exists in the registry`);this._idmap.set($.id,Q)}return this}remove(Q){return this._map.delete(Q),this}get(Q){let X=Q._zod.parent;if(X){let $={...this.get(X)??{}};return delete $.id,{...$,...this._map.get(Q)}}return this._map.get(Q)}has(Q){return this._map.has(Q)}}function U3(){return new U9}var f0=U3();function f$(Q,X){return new Q({type:"string",...x(X)})}function h$(Q,X){return new Q({type:"string",format:"email",check:"string_format",abort:!1,...x(X)})}function L9(Q,X){return new Q({type:"string",format:"guid",check:"string_format",abort:!1,...x(X)})}function u$(Q,X){return new Q({type:"string",format:"uuid",check:"string_format",abort:!1,...x(X)})}function l$(Q,X){return new Q({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...x(X)})}function m$(Q,X){return new Q({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...x(X)})}function c$(Q,X){return new Q({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...x(X)})}function p$(Q,X){return new Q({type:"string",format:"url",check:"string_format",abort:!1,...x(X)})}function d$(Q,X){return new Q({type:"string",format:"emoji",check:"string_format",abort:!1,...x(X)})}function i$(Q,X){return new Q({type:"string",format:"nanoid",check:"string_format",abort:!1,...x(X)})}function n$(Q,X){return new Q({type:"string",format:"cuid",check:"string_format",abort:!1,...x(X)})}function o$(Q,X){return new Q({type:"string",format:"cuid2",check:"string_format",abort:!1,...x(X)})}function r$(Q,X){return new Q({type:"string",format:"ulid",check:"string_format",abort:!1,...x(X)})}function t$(Q,X){return new Q({type:"string",format:"xid",check:"string_format",abort:!1,...x(X)})}function a$(Q,X){return new Q({type:"string",format:"ksuid",check:"string_format",abort:!1,...x(X)})}function s$(Q,X){return new Q({type:"string",format:"ipv4",check:"string_format",abort:!1,...x(X)})}function e$(Q,X){return new Q({type:"string",format:"ipv6",check:"string_format",abort:!1,...x(X)})}function QY(Q,X){return new Q({type:"string",format:"cidrv4",check:"string_format",abort:!1,...x(X)})}function XY(Q,X){return new Q({type:"string",format:"cidrv6",check:"string_format",abort:!1,...x(X)})}function $Y(Q,X){return new Q({type:"string",format:"base64",check:"string_format",abort:!1,...x(X)})}function YY(Q,X){return new Q({type:"string",format:"base64url",check:"string_format",abort:!1,...x(X)})}function GY(Q,X){return new Q({type:"string",format:"e164",check:"string_format",abort:!1,...x(X)})}function JY(Q,X){return new Q({type:"string",format:"jwt",check:"string_format",abort:!1,...x(X)})}function L3(Q,X){return new Q({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...x(X)})}function F3(Q,X){return new Q({type:"string",format:"date",check:"string_format",...x(X)})}function N3(Q,X){return new Q({type:"string",format:"time",check:"string_format",precision:null,...x(X)})}function D3(Q,X){return new Q({type:"string",format:"duration",check:"string_format",...x(X)})}function WY(Q,X){return new Q({type:"number",checks:[],...x(X)})}function HY(Q,X){return new Q({type:"number",check:"number_format",abort:!1,format:"safeint",...x(X)})}function zY(Q,X){return new Q({type:"boolean",...x(X)})}function BY(Q,X){return new Q({type:"null",...x(X)})}function KY(Q){return new Q({type:"unknown"})}function VY(Q,X){return new Q({type:"never",...x(X)})}function F9(Q,X){return new nX({check:"less_than",...x(X),value:Q,inclusive:!1})}function x4(Q,X){return new nX({check:"less_than",...x(X),value:Q,inclusive:!0})}function N9(Q,X){return new oX({check:"greater_than",...x(X),value:Q,inclusive:!1})}function y4(Q,X){return new oX({check:"greater_than",...x(X),value:Q,inclusive:!0})}function D9(Q,X){return new hW({check:"multiple_of",...x(X),value:Q})}function O9(Q,X){return new lW({check:"max_length",...x(X),maximum:Q})}function f6(Q,X){return new mW({check:"min_length",...x(X),minimum:Q})}function M9(Q,X){return new cW({check:"length_equals",...x(X),length:Q})}function qY(Q,X){return new pW({check:"string_format",format:"regex",...x(X),pattern:Q})}function UY(Q){return new dW({check:"string_format",format:"lowercase",...x(Q)})}function LY(Q){return new iW({check:"string_format",format:"uppercase",...x(Q)})}function FY(Q,X){return new nW({check:"string_format",format:"includes",...x(X),includes:Q})}function NY(Q,X){return new oW({check:"string_format",format:"starts_with",...x(X),prefix:Q})}function DY(Q,X){return new rW({check:"string_format",format:"ends_with",...x(X),suffix:Q})}function K6(Q){return new tW({check:"overwrite",tx:Q})}function OY(Q){return K6((X)=>X.normalize(Q))}function MY(){return K6((Q)=>Q.trim())}function AY(){return K6((Q)=>Q.toLowerCase())}function wY(){return K6((Q)=>Q.toUpperCase())}function O3(Q,X,$){return new Q({type:"array",element:X,...x($)})}function jY(Q,X,$){let Y=x($);return Y.abort??(Y.abort=!0),new Q({type:"custom",check:"custom",fn:X,...Y})}function IY(Q,X,$){return new Q({type:"custom",check:"custom",fn:X,...x($)})}class bY{constructor(Q){this.counter=0,this.metadataRegistry=Q?.metadata??f0,this.target=Q?.target??"draft-2020-12",this.unrepresentable=Q?.unrepresentable??"throw",this.override=Q?.override??(()=>{}),this.io=Q?.io??"output",this.seen=new Map}process(Q,X={path:[],schemaPath:[]}){var $;let Y=Q._zod.def,G={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},J=this.seen.get(Q);if(J){if(J.count++,X.schemaPath.includes(Q))J.cycle=X.path;return J.schema}let W={schema:{},count:1,cycle:void 0,path:X.path};this.seen.set(Q,W);let H=Q._zod.toJSONSchema?.();if(H)W.schema=H;else{let K={...X,schemaPath:[...X.schemaPath,Q],path:X.path},q=Q._zod.parent;if(q)W.ref=q,this.process(q,K),this.seen.get(q).isParent=!0;else{let U=W.schema;switch(Y.type){case"string":{let V=U;V.type="string";let{minimum:L,maximum:F,format:M,patterns:O,contentEncoding:j}=Q._zod.bag;if(typeof L==="number")V.minLength=L;if(typeof F==="number")V.maxLength=F;if(M){if(V.format=G[M]??M,V.format==="")delete V.format}if(j)V.contentEncoding=j;if(O&&O.size>0){let I=[...O];if(I.length===1)V.pattern=I[0].source;else if(I.length>1)W.schema.allOf=[...I.map((v)=>({...this.target==="draft-7"?{type:"string"}:{},pattern:v.source}))]}break}case"number":{let V=U,{minimum:L,maximum:F,format:M,multipleOf:O,exclusiveMaximum:j,exclusiveMinimum:I}=Q._zod.bag;if(typeof M==="string"&&M.includes("int"))V.type="integer";else V.type="number";if(typeof I==="number")V.exclusiveMinimum=I;if(typeof L==="number"){if(V.minimum=L,typeof I==="number")if(I>=L)delete V.minimum;else delete V.exclusiveMinimum}if(typeof j==="number")V.exclusiveMaximum=j;if(typeof F==="number"){if(V.maximum=F,typeof j==="number")if(j<=F)delete V.maximum;else delete V.exclusiveMaximum}if(typeof O==="number")V.multipleOf=O;break}case"boolean":{let V=U;V.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw Error("Symbols cannot be represented in JSON Schema");break}case"null":{U.type="null";break}case"any":break;case"unknown":break;case"undefined":case"never":{U.not={};break}case"void":{if(this.unrepresentable==="throw")throw Error("Void cannot be represented in JSON Schema");break}case"date":{if(this.unrepresentable==="throw")throw Error("Date cannot be represented in JSON Schema");break}case"array":{let V=U,{minimum:L,maximum:F}=Q._zod.bag;if(typeof L==="number")V.minItems=L;if(typeof F==="number")V.maxItems=F;V.type="array",V.items=this.process(Y.element,{...K,path:[...K.path,"items"]});break}case"object":{let V=U;V.type="object",V.properties={};let L=Y.shape;for(let O in L)V.properties[O]=this.process(L[O],{...K,path:[...K.path,"properties",O]});let F=new Set(Object.keys(L)),M=new Set([...F].filter((O)=>{let j=Y.shape[O]._zod;if(this.io==="input")return j.optin===void 0;else return j.optout===void 0}));if(M.size>0)V.required=Array.from(M);if(Y.catchall?._zod.def.type==="never")V.additionalProperties=!1;else if(!Y.catchall){if(this.io==="output")V.additionalProperties=!1}else if(Y.catchall)V.additionalProperties=this.process(Y.catchall,{...K,path:[...K.path,"additionalProperties"]});break}case"union":{let V=U;V.anyOf=Y.options.map((L,F)=>this.process(L,{...K,path:[...K.path,"anyOf",F]}));break}case"intersection":{let V=U,L=this.process(Y.left,{...K,path:[...K.path,"allOf",0]}),F=this.process(Y.right,{...K,path:[...K.path,"allOf",1]}),M=(j)=>("allOf"in j)&&Object.keys(j).length===1,O=[...M(L)?L.allOf:[L],...M(F)?F.allOf:[F]];V.allOf=O;break}case"tuple":{let V=U;V.type="array";let L=Y.items.map((O,j)=>this.process(O,{...K,path:[...K.path,"prefixItems",j]}));if(this.target==="draft-2020-12")V.prefixItems=L;else V.items=L;if(Y.rest){let O=this.process(Y.rest,{...K,path:[...K.path,"items"]});if(this.target==="draft-2020-12")V.items=O;else V.additionalItems=O}if(Y.rest)V.items=this.process(Y.rest,{...K,path:[...K.path,"items"]});let{minimum:F,maximum:M}=Q._zod.bag;if(typeof F==="number")V.minItems=F;if(typeof M==="number")V.maxItems=M;break}case"record":{let V=U;V.type="object",V.propertyNames=this.process(Y.keyType,{...K,path:[...K.path,"propertyNames"]}),V.additionalProperties=this.process(Y.valueType,{...K,path:[...K.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw Error("Set cannot be represented in JSON Schema");break}case"enum":{let V=U,L=P4(Y.entries);if(L.every((F)=>typeof F==="number"))V.type="number";if(L.every((F)=>typeof F==="string"))V.type="string";V.enum=L;break}case"literal":{let V=U,L=[];for(let F of Y.values)if(F===void 0){if(this.unrepresentable==="throw")throw Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof F==="bigint")if(this.unrepresentable==="throw")throw Error("BigInt literals cannot be represented in JSON Schema");else L.push(Number(F));else L.push(F);if(L.length===0);else if(L.length===1){let F=L[0];V.type=F===null?"null":typeof F,V.const=F}else{if(L.every((F)=>typeof F==="number"))V.type="number";if(L.every((F)=>typeof F==="string"))V.type="string";if(L.every((F)=>typeof F==="boolean"))V.type="string";if(L.every((F)=>F===null))V.type="null";V.enum=L}break}case"file":{let V=U,L={type:"string",format:"binary",contentEncoding:"binary"},{minimum:F,maximum:M,mime:O}=Q._zod.bag;if(F!==void 0)L.minLength=F;if(M!==void 0)L.maxLength=M;if(O)if(O.length===1)L.contentMediaType=O[0],Object.assign(V,L);else V.anyOf=O.map((j)=>{return{...L,contentMediaType:j}});else Object.assign(V,L);break}case"transform":{if(this.unrepresentable==="throw")throw Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{let V=this.process(Y.innerType,K);U.anyOf=[V,{type:"null"}];break}case"nonoptional":{this.process(Y.innerType,K),W.ref=Y.innerType;break}case"success":{let V=U;V.type="boolean";break}case"default":{this.process(Y.innerType,K),W.ref=Y.innerType,U.default=JSON.parse(JSON.stringify(Y.defaultValue));break}case"prefault":{if(this.process(Y.innerType,K),W.ref=Y.innerType,this.io==="input")U._prefault=JSON.parse(JSON.stringify(Y.defaultValue));break}case"catch":{this.process(Y.innerType,K),W.ref=Y.innerType;let V;try{V=Y.catchValue(void 0)}catch{throw Error("Dynamic catch values are not supported in JSON Schema")}U.default=V;break}case"nan":{if(this.unrepresentable==="throw")throw Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{let V=U,L=Q._zod.pattern;if(!L)throw Error("Pattern not found in template literal");V.type="string",V.pattern=L.source;break}case"pipe":{let V=this.io==="input"?Y.in._zod.def.type==="transform"?Y.out:Y.in:Y.out;this.process(V,K),W.ref=V;break}case"readonly":{this.process(Y.innerType,K),W.ref=Y.innerType,U.readOnly=!0;break}case"promise":{this.process(Y.innerType,K),W.ref=Y.innerType;break}case"optional":{this.process(Y.innerType,K),W.ref=Y.innerType;break}case"lazy":{let V=Q._zod.innerType;this.process(V,K),W.ref=V;break}case"custom":{if(this.unrepresentable==="throw")throw Error("Custom types cannot be represented in JSON Schema");break}default:}}}let z=this.metadataRegistry.get(Q);if(z)Object.assign(W.schema,z);if(this.io==="input"&&O1(Q))delete W.schema.examples,delete W.schema.default;if(this.io==="input"&&W.schema._prefault)($=W.schema).default??($.default=W.schema._prefault);return delete W.schema._prefault,this.seen.get(Q).schema}emit(Q,X){let $={cycles:X?.cycles??"ref",reused:X?.reused??"inline",external:X?.external??void 0},Y=this.seen.get(Q);if(!Y)throw Error("Unprocessed schema. This is a bug in Zod.");let G=(B)=>{let K=this.target==="draft-2020-12"?"$defs":"definitions";if($.external){let L=$.external.registry.get(B[0])?.id;if(L)return{ref:$.external.uri(L)};let F=B[1].defId??B[1].schema.id??`schema${this.counter++}`;return B[1].defId=F,{defId:F,ref:`${$.external.uri("__shared")}#/${K}/${F}`}}if(B[1]===Y)return{ref:"#"};let U=`${"#"}/${K}/`,V=B[1].schema.id??`__schema${this.counter++}`;return{defId:V,ref:U+V}},J=(B)=>{if(B[1].schema.$ref)return;let K=B[1],{ref:q,defId:U}=G(B);if(K.def={...K.schema},U)K.defId=U;let V=K.schema;for(let L in V)delete V[L];V.$ref=q};for(let B of this.seen.entries()){let K=B[1];if(Q===B[0]){J(B);continue}if($.external){let U=$.external.registry.get(B[0])?.id;if(Q!==B[0]&&U){J(B);continue}}if(this.metadataRegistry.get(B[0])?.id){J(B);continue}if(K.cycle){if($.cycles==="throw")throw Error(`Cycle detected: #/${K.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`);else if($.cycles==="ref")J(B);continue}if(K.count>1){if($.reused==="ref"){J(B);continue}}}let W=(B,K)=>{let q=this.seen.get(B),U=q.def??q.schema,V={...U};if(q.ref===null)return;let L=q.ref;if(q.ref=null,L){W(L,K);let F=this.seen.get(L).schema;if(F.$ref&&K.target==="draft-7")U.allOf=U.allOf??[],U.allOf.push(F);else Object.assign(U,F),Object.assign(U,V)}if(!q.isParent)this.override({zodSchema:B,jsonSchema:U,path:q.path??[]})};for(let B of[...this.seen.entries()].reverse())W(B[0],{target:this.target});let H={};if(this.target==="draft-2020-12")H.$schema="https://json-schema.org/draft/2020-12/schema";else if(this.target==="draft-7")H.$schema="http://json-schema.org/draft-07/schema#";else console.warn(`Invalid target: ${this.target}`);Object.assign(H,Y.def);let z=$.external?.defs??{};for(let B of this.seen.entries()){let K=B[1];if(K.def&&K.defId)z[K.defId]=K.def}if(!$.external&&Object.keys(z).length>0)if(this.target==="draft-2020-12")H.$defs=z;else H.definitions=z;try{return JSON.parse(JSON.stringify(H))}catch(B){throw Error("Error converting schema to JSON.")}}}function RY(Q,X){if(Q instanceof U9){let Y=new bY(X),G={};for(let H of Q._idmap.entries()){let[z,B]=H;Y.process(B)}let J={},W={registry:Q,uri:X?.uri||((H)=>H),defs:G};for(let H of Q._idmap.entries()){let[z,B]=H;J[z]=Y.emit(B,{...X,external:W})}if(Object.keys(G).length>0){let H=Y.target==="draft-2020-12"?"$defs":"definitions";J.__shared={[H]:G}}return{schemas:J}}let $=new bY(X);return $.process(Q),$.emit(Q,X)}function O1(Q,X){let $=X??{seen:new Set};if($.seen.has(Q))return!1;$.seen.add(Q);let G=Q._zod.def;switch(G.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return O1(G.element,$);case"object":{for(let J in G.shape)if(O1(G.shape[J],$))return!0;return!1}case"union":{for(let J of G.options)if(O1(J,$))return!0;return!1}case"intersection":return O1(G.left,$)||O1(G.right,$);case"tuple":{for(let J of G.items)if(O1(J,$))return!0;if(G.rest&&O1(G.rest,$))return!0;return!1}case"record":return O1(G.keyType,$)||O1(G.valueType,$);case"map":return O1(G.keyType,$)||O1(G.valueType,$);case"set":return O1(G.valueType,$);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return O1(G.innerType,$);case"lazy":return O1(G.getter(),$);case"default":return O1(G.innerType,$);case"prefault":return O1(G.innerType,$);case"custom":return!1;case"transform":return!0;case"pipe":return O1(G.in,$)||O1(G.out,$);case"success":return!1;case"catch":return!1;default:}throw Error(`Unknown schema type: ${G.type}`)}var CO=D("ZodMiniType",(Q,X)=>{if(!Q._zod)throw Error("Uninitialized schema in ZodMiniType.");X1.init(Q,X),Q.def=X,Q.parse=($,Y)=>uX(Q,$,Y,{callee:Q.parse}),Q.safeParse=($,Y)=>z6(Q,$,Y),Q.parseAsync=async($,Y)=>mX(Q,$,Y,{callee:Q.parseAsync}),Q.safeParseAsync=async($,Y)=>B6(Q,$,Y),Q.check=(...$)=>{return Q.clone({...X,checks:[...X.checks??[],...$.map((Y)=>typeof Y==="function"?{_zod:{check:Y,def:{check:"custom"},onattach:[]}}:Y)]})},Q.clone=($,Y)=>l1(Q,$,Y),Q.brand=()=>Q,Q.register=($,Y)=>{return $.add(Q,Y),Q}});var _O=D("ZodMiniObject",(Q,X)=>{V9.init(Q,X),CO.init(Q,X),d.defineLazy(Q,"shape",()=>X.shape)});function EY(Q,X){let $={type:"object",get shape(){return d.assignProp(this,"shape",{...Q}),this.shape},...d.normalizeParams(X)};return new _O($)}function d1(Q){return!!Q._zod}function q6(Q){let X=Object.values(Q);if(X.length===0)return EY({});let $=X.every(d1),Y=X.every((G)=>!d1(G));if($)return EY(Q);if(Y)return YW(Q);throw Error("Mixed Zod versions detected in object shape.")}function h0(Q,X){if(d1(Q))return z6(Q,X);return Q.safeParse(X)}async function A9(Q,X){if(d1(Q))return await B6(Q,X);return await Q.safeParseAsync(X)}function u0(Q){if(!Q)return;let X;if(d1(Q))X=Q._zod?.def?.shape;else X=Q.shape;if(!X)return;if(typeof X==="function")try{return X()}catch{return}return X}function h6(Q){if(!Q)return;if(typeof Q==="object"){let X=Q,$=Q;if(!X._def&&!$._zod){let Y=Object.values(Q);if(Y.length>0&&Y.every((G)=>typeof G==="object"&&G!==null&&(G._def!==void 0||G._zod!==void 0||typeof G.parse==="function")))return q6(Q)}}if(d1(Q)){let $=Q._zod?.def;if($&&($.type==="object"||$.shape!==void 0))return Q}else if(Q.shape!==void 0)return Q;return}function w9(Q){if(Q&&typeof Q==="object"){if("message"in Q&&typeof Q.message==="string")return Q.message;if("issues"in Q&&Array.isArray(Q.issues)&&Q.issues.length>0){let X=Q.issues[0];if(X&&typeof X==="object"&&"message"in X)return String(X.message)}try{return JSON.stringify(Q)}catch{return String(Q)}}return String(Q)}function A3(Q){return Q.description}function w3(Q){if(d1(Q))return Q._zod?.def?.type==="optional";let X=Q;if(typeof Q.isOptional==="function")return Q.isOptional();return X._def?.typeName==="ZodOptional"}function j9(Q){if(d1(Q)){let J=Q._zod?.def;if(J){if(J.value!==void 0)return J.value;if(Array.isArray(J.values)&&J.values.length>0)return J.values[0]}}let $=Q._def;if($){if($.value!==void 0)return $.value;if(Array.isArray($.values)&&$.values.length>0)return $.values[0]}let Y=Q.value;if(Y!==void 0)return Y;return}var g4={};w7(g4,{time:()=>ZY,duration:()=>CY,datetime:()=>PY,date:()=>SY,ZodISOTime:()=>b3,ZodISODuration:()=>R3,ZodISODateTime:()=>j3,ZodISODate:()=>I3});var j3=D("ZodISODateTime",(Q,X)=>{z3.init(Q,X),z1.init(Q,X)});function PY(Q){return L3(j3,Q)}var I3=D("ZodISODate",(Q,X)=>{B3.init(Q,X),z1.init(Q,X)});function SY(Q){return F3(I3,Q)}var b3=D("ZodISOTime",(Q,X)=>{K3.init(Q,X),z1.init(Q,X)});function ZY(Q){return N3(b3,Q)}var R3=D("ZodISODuration",(Q,X)=>{V3.init(Q,X),z1.init(Q,X)});function CY(Q){return D3(R3,Q)}var E3=(Q,X)=>{H9.init(Q,X),Q.name="ZodError",Object.defineProperties(Q,{format:{value:($)=>fX(Q,$)},flatten:{value:($)=>gX(Q,$)},addIssue:{value:($)=>Q.issues.push($)},addIssues:{value:($)=>Q.issues.push(...$)},isEmpty:{get(){return Q.issues.length===0}}})},Gy=D("ZodError",E3),f4=D("ZodError",E3,{Parent:Error});var P3=hX(f4),S3=lX(f4),Z3=cX(f4),C3=pX(f4);var L1=D("ZodType",(Q,X)=>{return X1.init(Q,X),Q.def=X,Object.defineProperty(Q,"_def",{value:X}),Q.check=(...$)=>{return Q.clone({...X,checks:[...X.checks??[],...$.map((Y)=>typeof Y==="function"?{_zod:{check:Y,def:{check:"custom"},onattach:[]}}:Y)]})},Q.clone=($,Y)=>l1(Q,$,Y),Q.brand=()=>Q,Q.register=($,Y)=>{return $.add(Q,Y),Q},Q.parse=($,Y)=>P3(Q,$,Y,{callee:Q.parse}),Q.safeParse=($,Y)=>Z3(Q,$,Y),Q.parseAsync=async($,Y)=>S3(Q,$,Y,{callee:Q.parseAsync}),Q.safeParseAsync=async($,Y)=>C3(Q,$,Y),Q.spa=Q.safeParseAsync,Q.refine=($,Y)=>Q.check(SM($,Y)),Q.superRefine=($)=>Q.check(ZM($)),Q.overwrite=($)=>Q.check(K6($)),Q.optional=()=>U1(Q),Q.nullable=()=>v3(Q),Q.nullish=()=>U1(v3(Q)),Q.nonoptional=($)=>wM(Q,$),Q.array=()=>n(Q),Q.or=($)=>J1([Q,$]),Q.and=($)=>b9(Q,$),Q.transform=($)=>kY(Q,f3($)),Q.default=($)=>OM(Q,$),Q.prefault=($)=>AM(Q,$),Q.catch=($)=>IM(Q,$),Q.pipe=($)=>kY(Q,$),Q.readonly=()=>EM(Q),Q.describe=($)=>{let Y=Q.clone();return f0.add(Y,{description:$}),Y},Object.defineProperty(Q,"description",{get(){return f0.get(Q)?.description},configurable:!0}),Q.meta=(...$)=>{if($.length===0)return f0.get(Q);let Y=Q.clone();return f0.add(Y,$[0]),Y},Q.isOptional=()=>Q.safeParse(void 0).success,Q.isNullable=()=>Q.safeParse(null).success,Q}),T3=D("_ZodString",(Q,X)=>{T4.init(Q,X),L1.init(Q,X);let $=Q._zod.bag;Q.format=$.format??null,Q.minLength=$.minimum??null,Q.maxLength=$.maximum??null,Q.regex=(...Y)=>Q.check(qY(...Y)),Q.includes=(...Y)=>Q.check(FY(...Y)),Q.startsWith=(...Y)=>Q.check(NY(...Y)),Q.endsWith=(...Y)=>Q.check(DY(...Y)),Q.min=(...Y)=>Q.check(f6(...Y)),Q.max=(...Y)=>Q.check(O9(...Y)),Q.length=(...Y)=>Q.check(M9(...Y)),Q.nonempty=(...Y)=>Q.check(f6(1,...Y)),Q.lowercase=(Y)=>Q.check(UY(Y)),Q.uppercase=(Y)=>Q.check(LY(Y)),Q.trim=()=>Q.check(MY()),Q.normalize=(...Y)=>Q.check(OY(...Y)),Q.toLowerCase=()=>Q.check(AY()),Q.toUpperCase=()=>Q.check(wY())}),uO=D("ZodString",(Q,X)=>{T4.init(Q,X),T3.init(Q,X),Q.email=($)=>Q.check(h$(lO,$)),Q.url=($)=>Q.check(p$(mO,$)),Q.jwt=($)=>Q.check(JY(YM,$)),Q.emoji=($)=>Q.check(d$(cO,$)),Q.guid=($)=>Q.check(L9(_3,$)),Q.uuid=($)=>Q.check(u$(I9,$)),Q.uuidv4=($)=>Q.check(l$(I9,$)),Q.uuidv6=($)=>Q.check(m$(I9,$)),Q.uuidv7=($)=>Q.check(c$(I9,$)),Q.nanoid=($)=>Q.check(i$(pO,$)),Q.guid=($)=>Q.check(L9(_3,$)),Q.cuid=($)=>Q.check(n$(dO,$)),Q.cuid2=($)=>Q.check(o$(iO,$)),Q.ulid=($)=>Q.check(r$(nO,$)),Q.base64=($)=>Q.check($Y(QM,$)),Q.base64url=($)=>Q.check(YY(XM,$)),Q.xid=($)=>Q.check(t$(oO,$)),Q.ksuid=($)=>Q.check(a$(rO,$)),Q.ipv4=($)=>Q.check(s$(tO,$)),Q.ipv6=($)=>Q.check(e$(aO,$)),Q.cidrv4=($)=>Q.check(QY(sO,$)),Q.cidrv6=($)=>Q.check(XY(eO,$)),Q.e164=($)=>Q.check(GY($M,$)),Q.datetime=($)=>Q.check(PY($)),Q.date=($)=>Q.check(SY($)),Q.time=($)=>Q.check(ZY($)),Q.duration=($)=>Q.check(CY($))});function N(Q){return f$(uO,Q)}var z1=D("ZodStringFormat",(Q,X)=>{G1.init(Q,X),T3.init(Q,X)}),lO=D("ZodEmail",(Q,X)=>{eX.init(Q,X),z1.init(Q,X)});var _3=D("ZodGUID",(Q,X)=>{aX.init(Q,X),z1.init(Q,X)});var I9=D("ZodUUID",(Q,X)=>{sX.init(Q,X),z1.init(Q,X)});var mO=D("ZodURL",(Q,X)=>{Q$.init(Q,X),z1.init(Q,X)});var cO=D("ZodEmoji",(Q,X)=>{X$.init(Q,X),z1.init(Q,X)});var pO=D("ZodNanoID",(Q,X)=>{$$.init(Q,X),z1.init(Q,X)});var dO=D("ZodCUID",(Q,X)=>{Y$.init(Q,X),z1.init(Q,X)});var iO=D("ZodCUID2",(Q,X)=>{G$.init(Q,X),z1.init(Q,X)});var nO=D("ZodULID",(Q,X)=>{J$.init(Q,X),z1.init(Q,X)});var oO=D("ZodXID",(Q,X)=>{W$.init(Q,X),z1.init(Q,X)});var rO=D("ZodKSUID",(Q,X)=>{H$.init(Q,X),z1.init(Q,X)});var tO=D("ZodIPv4",(Q,X)=>{z$.init(Q,X),z1.init(Q,X)});var aO=D("ZodIPv6",(Q,X)=>{B$.init(Q,X),z1.init(Q,X)});var sO=D("ZodCIDRv4",(Q,X)=>{K$.init(Q,X),z1.init(Q,X)});var eO=D("ZodCIDRv6",(Q,X)=>{V$.init(Q,X),z1.init(Q,X)});var QM=D("ZodBase64",(Q,X)=>{q$.init(Q,X),z1.init(Q,X)});var XM=D("ZodBase64URL",(Q,X)=>{U$.init(Q,X),z1.init(Q,X)});var $M=D("ZodE164",(Q,X)=>{L$.init(Q,X),z1.init(Q,X)});var YM=D("ZodJWT",(Q,X)=>{F$.init(Q,X),z1.init(Q,X)});var x3=D("ZodNumber",(Q,X)=>{K9.init(Q,X),L1.init(Q,X),Q.gt=(Y,G)=>Q.check(N9(Y,G)),Q.gte=(Y,G)=>Q.check(y4(Y,G)),Q.min=(Y,G)=>Q.check(y4(Y,G)),Q.lt=(Y,G)=>Q.check(F9(Y,G)),Q.lte=(Y,G)=>Q.check(x4(Y,G)),Q.max=(Y,G)=>Q.check(x4(Y,G)),Q.int=(Y)=>Q.check(k3(Y)),Q.safe=(Y)=>Q.check(k3(Y)),Q.positive=(Y)=>Q.check(N9(0,Y)),Q.nonnegative=(Y)=>Q.check(y4(0,Y)),Q.negative=(Y)=>Q.check(F9(0,Y)),Q.nonpositive=(Y)=>Q.check(x4(0,Y)),Q.multipleOf=(Y,G)=>Q.check(D9(Y,G)),Q.step=(Y,G)=>Q.check(D9(Y,G)),Q.finite=()=>Q;let $=Q._zod.bag;Q.minValue=Math.max($.minimum??Number.NEGATIVE_INFINITY,$.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,Q.maxValue=Math.min($.maximum??Number.POSITIVE_INFINITY,$.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,Q.isInt=($.format??"").includes("int")||Number.isSafeInteger($.multipleOf??0.5),Q.isFinite=!0,Q.format=$.format??null});function s(Q){return WY(x3,Q)}var GM=D("ZodNumberFormat",(Q,X)=>{N$.init(Q,X),x3.init(Q,X)});function k3(Q){return HY(GM,Q)}var JM=D("ZodBoolean",(Q,X)=>{D$.init(Q,X),L1.init(Q,X)});function M1(Q){return zY(JM,Q)}var WM=D("ZodNull",(Q,X)=>{O$.init(Q,X),L1.init(Q,X)});function vY(Q){return BY(WM,Q)}var HM=D("ZodUnknown",(Q,X)=>{M$.init(Q,X),L1.init(Q,X)});function B1(){return KY(HM)}var zM=D("ZodNever",(Q,X)=>{A$.init(Q,X),L1.init(Q,X)});function BM(Q){return VY(zM,Q)}var KM=D("ZodArray",(Q,X)=>{w$.init(Q,X),L1.init(Q,X),Q.element=X.element,Q.min=($,Y)=>Q.check(f6($,Y)),Q.nonempty=($)=>Q.check(f6(1,$)),Q.max=($,Y)=>Q.check(O9($,Y)),Q.length=($,Y)=>Q.check(M9($,Y)),Q.unwrap=()=>Q.element});function n(Q,X){return O3(KM,Q,X)}var y3=D("ZodObject",(Q,X)=>{V9.init(Q,X),L1.init(Q,X),d.defineLazy(Q,"shape",()=>X.shape),Q.keyof=()=>T1(Object.keys(Q._zod.def.shape)),Q.catchall=($)=>Q.clone({...Q._zod.def,catchall:$}),Q.passthrough=()=>Q.clone({...Q._zod.def,catchall:B1()}),Q.loose=()=>Q.clone({...Q._zod.def,catchall:B1()}),Q.strict=()=>Q.clone({...Q._zod.def,catchall:BM()}),Q.strip=()=>Q.clone({...Q._zod.def,catchall:void 0}),Q.extend=($)=>{return d.extend(Q,$)},Q.merge=($)=>d.merge(Q,$),Q.pick=($)=>d.pick(Q,$),Q.omit=($)=>d.omit(Q,$),Q.partial=(...$)=>d.partial(h3,Q,$[0]),Q.required=(...$)=>d.required(u3,Q,$[0])});function P(Q,X){let $={type:"object",get shape(){return d.assignProp(this,"shape",{...Q}),this.shape},...d.normalizeParams(X)};return new y3($)}function C1(Q,X){return new y3({type:"object",get shape(){return d.assignProp(this,"shape",{...Q}),this.shape},catchall:B1(),...d.normalizeParams(X)})}var g3=D("ZodUnion",(Q,X)=>{q9.init(Q,X),L1.init(Q,X),Q.options=X.options});function J1(Q,X){return new g3({type:"union",options:Q,...d.normalizeParams(X)})}var VM=D("ZodDiscriminatedUnion",(Q,X)=>{g3.init(Q,X),j$.init(Q,X)});function TY(Q,X,$){return new VM({type:"union",options:X,discriminator:Q,...d.normalizeParams($)})}var qM=D("ZodIntersection",(Q,X)=>{I$.init(Q,X),L1.init(Q,X)});function b9(Q,X){return new qM({type:"intersection",left:Q,right:X})}var UM=D("ZodRecord",(Q,X)=>{b$.init(Q,X),L1.init(Q,X),Q.keyType=X.keyType,Q.valueType=X.valueType});function K1(Q,X,$){return new UM({type:"record",keyType:Q,valueType:X,...d.normalizeParams($)})}var _Y=D("ZodEnum",(Q,X)=>{R$.init(Q,X),L1.init(Q,X),Q.enum=X.entries,Q.options=Object.values(X.entries);let $=new Set(Object.keys(X.entries));Q.extract=(Y,G)=>{let J={};for(let W of Y)if($.has(W))J[W]=X.entries[W];else throw Error(`Key ${W} not found in enum`);return new _Y({...X,checks:[],...d.normalizeParams(G),entries:J})},Q.exclude=(Y,G)=>{let J={...X.entries};for(let W of Y)if($.has(W))delete J[W];else throw Error(`Key ${W} not found in enum`);return new _Y({...X,checks:[],...d.normalizeParams(G),entries:J})}});function T1(Q,X){let $=Array.isArray(Q)?Object.fromEntries(Q.map((Y)=>[Y,Y])):Q;return new _Y({type:"enum",entries:$,...d.normalizeParams(X)})}var LM=D("ZodLiteral",(Q,X)=>{E$.init(Q,X),L1.init(Q,X),Q.values=new Set(X.values),Object.defineProperty(Q,"value",{get(){if(X.values.length>1)throw Error("This schema contains multiple valid literal values. Use `.values` instead.");return X.values[0]}})});function C(Q,X){return new LM({type:"literal",values:Array.isArray(Q)?Q:[Q],...d.normalizeParams(X)})}var FM=D("ZodTransform",(Q,X)=>{P$.init(Q,X),L1.init(Q,X),Q._zod.parse=($,Y)=>{$.addIssue=(J)=>{if(typeof J==="string")$.issues.push(d.issue(J,$.value,X));else{let W=J;if(W.fatal)W.continue=!1;W.code??(W.code="custom"),W.input??(W.input=$.value),W.inst??(W.inst=Q),W.continue??(W.continue=!0),$.issues.push(d.issue(W))}};let G=X.transform($.value,$);if(G instanceof Promise)return G.then((J)=>{return $.value=J,$});return $.value=G,$}});function f3(Q){return new FM({type:"transform",transform:Q})}var h3=D("ZodOptional",(Q,X)=>{S$.init(Q,X),L1.init(Q,X),Q.unwrap=()=>Q._zod.def.innerType});function U1(Q){return new h3({type:"optional",innerType:Q})}var NM=D("ZodNullable",(Q,X)=>{Z$.init(Q,X),L1.init(Q,X),Q.unwrap=()=>Q._zod.def.innerType});function v3(Q){return new NM({type:"nullable",innerType:Q})}var DM=D("ZodDefault",(Q,X)=>{C$.init(Q,X),L1.init(Q,X),Q.unwrap=()=>Q._zod.def.innerType,Q.removeDefault=Q.unwrap});function OM(Q,X){return new DM({type:"default",innerType:Q,get defaultValue(){return typeof X==="function"?X():X}})}var MM=D("ZodPrefault",(Q,X)=>{_$.init(Q,X),L1.init(Q,X),Q.unwrap=()=>Q._zod.def.innerType});function AM(Q,X){return new MM({type:"prefault",innerType:Q,get defaultValue(){return typeof X==="function"?X():X}})}var u3=D("ZodNonOptional",(Q,X)=>{k$.init(Q,X),L1.init(Q,X),Q.unwrap=()=>Q._zod.def.innerType});function wM(Q,X){return new u3({type:"nonoptional",innerType:Q,...d.normalizeParams(X)})}var jM=D("ZodCatch",(Q,X)=>{v$.init(Q,X),L1.init(Q,X),Q.unwrap=()=>Q._zod.def.innerType,Q.removeCatch=Q.unwrap});function IM(Q,X){return new jM({type:"catch",innerType:Q,catchValue:typeof X==="function"?X:()=>X})}var bM=D("ZodPipe",(Q,X)=>{T$.init(Q,X),L1.init(Q,X),Q.in=X.in,Q.out=X.out});function kY(Q,X){return new bM({type:"pipe",in:Q,out:X})}var RM=D("ZodReadonly",(Q,X)=>{x$.init(Q,X),L1.init(Q,X)});function EM(Q){return new RM({type:"readonly",innerType:Q})}var l3=D("ZodCustom",(Q,X)=>{y$.init(Q,X),L1.init(Q,X)});function PM(Q,X){let $=new A1({check:"custom",...d.normalizeParams(X)});return $._zod.check=Q,$}function m3(Q,X){return jY(l3,Q??(()=>!0),X)}function SM(Q,X={}){return IY(l3,Q,X)}function ZM(Q,X){let $=PM((Y)=>{return Y.addIssue=(G)=>{if(typeof G==="string")Y.issues.push(d.issue(G,Y.value,$._zod.def));else{let J=G;if(J.fatal)J.continue=!1;J.code??(J.code="custom"),J.input??(J.input=Y.value),J.inst??(J.inst=$),J.continue??(J.continue=!$._zod.def.abort),Y.issues.push(d.issue(J))}},Q(Y.value,Y)},X);return $}function xY(Q,X){return kY(f3(Q),X)}u1(g$());var yY="2025-11-25";var c3=[yY,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],l0="io.modelcontextprotocol/related-task",E9="2.0",w1=m3((Q)=>Q!==null&&(typeof Q==="object"||typeof Q==="function")),p3=J1([N(),s().int()]),d3=N(),Oy=C1({ttl:J1([s(),vY()]).optional(),pollInterval:s().optional()}),CM=P({ttl:s().optional()}),_M=P({taskId:N()}),gY=C1({progressToken:p3.optional(),[l0]:_M.optional()}),m1=P({_meta:gY.optional()}),h4=m1.extend({task:CM.optional()}),i3=(Q)=>h4.safeParse(Q).success,j1=P({method:N(),params:m1.loose().optional()}),i1=P({_meta:gY.optional()}),n1=P({method:N(),params:i1.loose().optional()}),I1=C1({_meta:gY.optional()}),P9=J1([N(),s().int()]),n3=P({jsonrpc:C(E9),id:P9,...j1.shape}).strict(),fY=(Q)=>n3.safeParse(Q).success,o3=P({jsonrpc:C(E9),...n1.shape}).strict(),r3=(Q)=>o3.safeParse(Q).success,hY=P({jsonrpc:C(E9),id:P9,result:I1}).strict(),u4=(Q)=>hY.safeParse(Q).success;var T;(function(Q){Q[Q.ConnectionClosed=-32000]="ConnectionClosed",Q[Q.RequestTimeout=-32001]="RequestTimeout",Q[Q.ParseError=-32700]="ParseError",Q[Q.InvalidRequest=-32600]="InvalidRequest",Q[Q.MethodNotFound=-32601]="MethodNotFound",Q[Q.InvalidParams=-32602]="InvalidParams",Q[Q.InternalError=-32603]="InternalError",Q[Q.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(T||(T={}));var uY=P({jsonrpc:C(E9),id:P9.optional(),error:P({code:s().int(),message:N(),data:B1().optional()})}).strict();var t3=(Q)=>uY.safeParse(Q).success;var My=J1([n3,o3,hY,uY]),Ay=J1([hY,uY]),S9=I1.strict(),kM=i1.extend({requestId:P9.optional(),reason:N().optional()}),Z9=n1.extend({method:C("notifications/cancelled"),params:kM}),vM=P({src:N(),mimeType:N().optional(),sizes:n(N()).optional(),theme:T1(["light","dark"]).optional()}),l4=P({icons:n(vM).optional()}),u6=P({name:N(),title:N().optional()}),a3=u6.extend({...u6.shape,...l4.shape,version:N(),websiteUrl:N().optional(),description:N().optional()}),TM=b9(P({applyDefaults:M1().optional()}),K1(N(),B1())),xM=xY((Q)=>{if(Q&&typeof Q==="object"&&!Array.isArray(Q)){if(Object.keys(Q).length===0)return{form:{}}}return Q},b9(P({form:TM.optional(),url:w1.optional()}),K1(N(),B1()).optional())),yM=C1({list:w1.optional(),cancel:w1.optional(),requests:C1({sampling:C1({createMessage:w1.optional()}).optional(),elicitation:C1({create:w1.optional()}).optional()}).optional()}),gM=C1({list:w1.optional(),cancel:w1.optional(),requests:C1({tools:C1({call:w1.optional()}).optional()}).optional()}),fM=P({experimental:K1(N(),w1).optional(),sampling:P({context:w1.optional(),tools:w1.optional()}).optional(),elicitation:xM.optional(),roots:P({listChanged:M1().optional()}).optional(),tasks:yM.optional()}),hM=m1.extend({protocolVersion:N(),capabilities:fM,clientInfo:a3}),lY=j1.extend({method:C("initialize"),params:hM});var uM=P({experimental:K1(N(),w1).optional(),logging:w1.optional(),completions:w1.optional(),prompts:P({listChanged:M1().optional()}).optional(),resources:P({subscribe:M1().optional(),listChanged:M1().optional()}).optional(),tools:P({listChanged:M1().optional()}).optional(),tasks:gM.optional()}),lM=I1.extend({protocolVersion:N(),capabilities:uM,serverInfo:a3,instructions:N().optional()}),mY=n1.extend({method:C("notifications/initialized"),params:i1.optional()});var C9=j1.extend({method:C("ping"),params:m1.optional()}),mM=P({progress:s(),total:U1(s()),message:U1(N())}),cM=P({...i1.shape,...mM.shape,progressToken:p3}),_9=n1.extend({method:C("notifications/progress"),params:cM}),pM=m1.extend({cursor:d3.optional()}),m4=j1.extend({params:pM.optional()}),c4=I1.extend({nextCursor:d3.optional()}),dM=T1(["working","input_required","completed","failed","cancelled"]),p4=P({taskId:N(),status:dM,ttl:J1([s(),vY()]),createdAt:N(),lastUpdatedAt:N(),pollInterval:U1(s()),statusMessage:U1(N())}),l6=I1.extend({task:p4}),iM=i1.merge(p4),d4=n1.extend({method:C("notifications/tasks/status"),params:iM}),k9=j1.extend({method:C("tasks/get"),params:m1.extend({taskId:N()})}),v9=I1.merge(p4),T9=j1.extend({method:C("tasks/result"),params:m1.extend({taskId:N()})}),wy=I1.loose(),x9=m4.extend({method:C("tasks/list")}),y9=c4.extend({tasks:n(p4)}),g9=j1.extend({method:C("tasks/cancel"),params:m1.extend({taskId:N()})}),s3=I1.merge(p4),e3=P({uri:N(),mimeType:U1(N()),_meta:K1(N(),B1()).optional()}),QH=e3.extend({text:N()}),cY=N().refine((Q)=>{try{return atob(Q),!0}catch{return!1}},{message:"Invalid Base64 string"}),XH=e3.extend({blob:cY}),i4=T1(["user","assistant"]),m6=P({audience:n(i4).optional(),priority:s().min(0).max(1).optional(),lastModified:g4.datetime({offset:!0}).optional()}),$H=P({...u6.shape,...l4.shape,uri:N(),description:U1(N()),mimeType:U1(N()),annotations:m6.optional(),_meta:U1(C1({}))}),nM=P({...u6.shape,...l4.shape,uriTemplate:N(),description:U1(N()),mimeType:U1(N()),annotations:m6.optional(),_meta:U1(C1({}))}),f9=m4.extend({method:C("resources/list")}),oM=c4.extend({resources:n($H)}),h9=m4.extend({method:C("resources/templates/list")}),rM=c4.extend({resourceTemplates:n(nM)}),pY=m1.extend({uri:N()}),tM=pY,u9=j1.extend({method:C("resources/read"),params:tM}),aM=I1.extend({contents:n(J1([QH,XH]))}),sM=n1.extend({method:C("notifications/resources/list_changed"),params:i1.optional()}),eM=pY,QA=j1.extend({method:C("resources/subscribe"),params:eM}),XA=pY,$A=j1.extend({method:C("resources/unsubscribe"),params:XA}),YA=i1.extend({uri:N()}),GA=n1.extend({method:C("notifications/resources/updated"),params:YA}),JA=P({name:N(),description:U1(N()),required:U1(M1())}),WA=P({...u6.shape,...l4.shape,description:U1(N()),arguments:U1(n(JA)),_meta:U1(C1({}))}),l9=m4.extend({method:C("prompts/list")}),HA=c4.extend({prompts:n(WA)}),zA=m1.extend({name:N(),arguments:K1(N(),N()).optional()}),m9=j1.extend({method:C("prompts/get"),params:zA}),dY=P({type:C("text"),text:N(),annotations:m6.optional(),_meta:K1(N(),B1()).optional()}),iY=P({type:C("image"),data:cY,mimeType:N(),annotations:m6.optional(),_meta:K1(N(),B1()).optional()}),nY=P({type:C("audio"),data:cY,mimeType:N(),annotations:m6.optional(),_meta:K1(N(),B1()).optional()}),BA=P({type:C("tool_use"),name:N(),id:N(),input:K1(N(),B1()),_meta:K1(N(),B1()).optional()}),KA=P({type:C("resource"),resource:J1([QH,XH]),annotations:m6.optional(),_meta:K1(N(),B1()).optional()}),VA=$H.extend({type:C("resource_link")}),oY=J1([dY,iY,nY,VA,KA]),qA=P({role:i4,content:oY}),UA=I1.extend({description:N().optional(),messages:n(qA)}),LA=n1.extend({method:C("notifications/prompts/list_changed"),params:i1.optional()}),FA=P({title:N().optional(),readOnlyHint:M1().optional(),destructiveHint:M1().optional(),idempotentHint:M1().optional(),openWorldHint:M1().optional()}),NA=P({taskSupport:T1(["required","optional","forbidden"]).optional()}),YH=P({...u6.shape,...l4.shape,description:N().optional(),inputSchema:P({type:C("object"),properties:K1(N(),w1).optional(),required:n(N()).optional()}).catchall(B1()),outputSchema:P({type:C("object"),properties:K1(N(),w1).optional(),required:n(N()).optional()}).catchall(B1()).optional(),annotations:FA.optional(),execution:NA.optional(),_meta:K1(N(),B1()).optional()}),c9=m4.extend({method:C("tools/list")}),DA=c4.extend({tools:n(YH)}),p9=I1.extend({content:n(oY).default([]),structuredContent:K1(N(),B1()).optional(),isError:M1().optional()}),jy=p9.or(I1.extend({toolResult:B1()})),OA=h4.extend({name:N(),arguments:K1(N(),B1()).optional()}),c6=j1.extend({method:C("tools/call"),params:OA}),MA=n1.extend({method:C("notifications/tools/list_changed"),params:i1.optional()}),Iy=P({autoRefresh:M1().default(!0),debounceMs:s().int().nonnegative().default(300)}),n4=T1(["debug","info","notice","warning","error","critical","alert","emergency"]),AA=m1.extend({level:n4}),rY=j1.extend({method:C("logging/setLevel"),params:AA}),wA=i1.extend({level:n4,logger:N().optional(),data:B1()}),jA=n1.extend({method:C("notifications/message"),params:wA}),IA=P({name:N().optional()}),bA=P({hints:n(IA).optional(),costPriority:s().min(0).max(1).optional(),speedPriority:s().min(0).max(1).optional(),intelligencePriority:s().min(0).max(1).optional()}),RA=P({mode:T1(["auto","required","none"]).optional()}),EA=P({type:C("tool_result"),toolUseId:N().describe("The unique identifier for the corresponding tool call."),content:n(oY).default([]),structuredContent:P({}).loose().optional(),isError:M1().optional(),_meta:K1(N(),B1()).optional()}),PA=TY("type",[dY,iY,nY]),R9=TY("type",[dY,iY,nY,BA,EA]),SA=P({role:i4,content:J1([R9,n(R9)]),_meta:K1(N(),B1()).optional()}),ZA=h4.extend({messages:n(SA),modelPreferences:bA.optional(),systemPrompt:N().optional(),includeContext:T1(["none","thisServer","allServers"]).optional(),temperature:s().optional(),maxTokens:s().int(),stopSequences:n(N()).optional(),metadata:w1.optional(),tools:n(YH).optional(),toolChoice:RA.optional()}),CA=j1.extend({method:C("sampling/createMessage"),params:ZA}),o4=I1.extend({model:N(),stopReason:U1(T1(["endTurn","stopSequence","maxTokens"]).or(N())),role:i4,content:PA}),tY=I1.extend({model:N(),stopReason:U1(T1(["endTurn","stopSequence","maxTokens","toolUse"]).or(N())),role:i4,content:J1([R9,n(R9)])}),_A=P({type:C("boolean"),title:N().optional(),description:N().optional(),default:M1().optional()}),kA=P({type:C("string"),title:N().optional(),description:N().optional(),minLength:s().optional(),maxLength:s().optional(),format:T1(["email","uri","date","date-time"]).optional(),default:N().optional()}),vA=P({type:T1(["number","integer"]),title:N().optional(),description:N().optional(),minimum:s().optional(),maximum:s().optional(),default:s().optional()}),TA=P({type:C("string"),title:N().optional(),description:N().optional(),enum:n(N()),default:N().optional()}),xA=P({type:C("string"),title:N().optional(),description:N().optional(),oneOf:n(P({const:N(),title:N()})),default:N().optional()}),yA=P({type:C("string"),title:N().optional(),description:N().optional(),enum:n(N()),enumNames:n(N()).optional(),default:N().optional()}),gA=J1([TA,xA]),fA=P({type:C("array"),title:N().optional(),description:N().optional(),minItems:s().optional(),maxItems:s().optional(),items:P({type:C("string"),enum:n(N())}),default:n(N()).optional()}),hA=P({type:C("array"),title:N().optional(),description:N().optional(),minItems:s().optional(),maxItems:s().optional(),items:P({anyOf:n(P({const:N(),title:N()}))}),default:n(N()).optional()}),uA=J1([fA,hA]),lA=J1([yA,gA,uA]),mA=J1([lA,_A,kA,vA]),cA=h4.extend({mode:C("form").optional(),message:N(),requestedSchema:P({type:C("object"),properties:K1(N(),mA),required:n(N()).optional()})}),pA=h4.extend({mode:C("url"),message:N(),elicitationId:N(),url:N().url()}),dA=J1([cA,pA]),iA=j1.extend({method:C("elicitation/create"),params:dA}),nA=i1.extend({elicitationId:N()}),oA=n1.extend({method:C("notifications/elicitation/complete"),params:nA}),p6=I1.extend({action:T1(["accept","decline","cancel"]),content:xY((Q)=>Q===null?void 0:Q,K1(N(),J1([N(),s(),M1(),n(N())])).optional())}),rA=P({type:C("ref/resource"),uri:N()});var tA=P({type:C("ref/prompt"),name:N()}),aA=m1.extend({ref:J1([tA,rA]),argument:P({name:N(),value:N()}),context:P({arguments:K1(N(),N()).optional()}).optional()}),d9=j1.extend({method:C("completion/complete"),params:aA});function GH(Q){if(Q.params.ref.type!=="ref/prompt")throw TypeError(`Expected CompleteRequestPrompt, but got ${Q.params.ref.type}`)}function JH(Q){if(Q.params.ref.type!=="ref/resource")throw TypeError(`Expected CompleteRequestResourceTemplate, but got ${Q.params.ref.type}`)}var sA=I1.extend({completion:C1({values:n(N()).max(100),total:U1(s().int()),hasMore:U1(M1())})}),eA=P({uri:N().startsWith("file://"),name:N().optional(),_meta:K1(N(),B1()).optional()}),Qw=j1.extend({method:C("roots/list"),params:m1.optional()}),aY=I1.extend({roots:n(eA)}),Xw=n1.extend({method:C("notifications/roots/list_changed"),params:i1.optional()}),by=J1([C9,lY,d9,rY,m9,l9,f9,h9,u9,QA,$A,c6,c9,k9,T9,x9,g9]),Ry=J1([Z9,_9,mY,Xw,d4]),Ey=J1([S9,o4,tY,p6,aY,v9,y9,l6]),Py=J1([C9,CA,iA,Qw,k9,T9,x9,g9]),Sy=J1([Z9,_9,jA,GA,sM,MA,LA,d4,oA]),Zy=J1([S9,lM,sA,UA,HA,oM,rM,aM,p9,DA,v9,y9,l6]);class Z extends Error{constructor(Q,X,$){super(`MCP error ${Q}: ${X}`);this.code=Q,this.data=$,this.name="McpError"}static fromError(Q,X,$){if(Q===T.UrlElicitationRequired&&$){let Y=$;if(Y.elicitations)return new WH(Y.elicitations,X)}return new Z(Q,X,$)}}class WH extends Z{constructor(Q,X=`URL elicitation${Q.length>1?"s":""} required`){super(T.UrlElicitationRequired,X,{elicitations:Q})}get elicitations(){return this.data?.elicitations??[]}}function m0(Q){return Q==="completed"||Q==="failed"||Q==="cancelled"}var zH=Symbol("Let zodToJsonSchema decide on which parser to use");var HH={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},BH=(Q)=>typeof Q==="string"?{...HH,name:Q}:{...HH,...Q};var KH=(Q)=>{let X=BH(Q),$=X.name!==void 0?[...X.basePath,X.definitionPath,X.name]:X.basePath;return{...X,flags:{hasReferencedOpenAiAnyType:!1},currentPath:$,propertyPath:void 0,seen:new Map(Object.entries(X.definitions).map(([Y,G])=>[G._def,{def:G._def,path:[...X.basePath,X.definitionPath,Y],jsonSchema:void 0}]))}};function sY(Q,X,$,Y){if(!Y?.errorMessages)return;if($)Q.errorMessage={...Q.errorMessage,[X]:$}}function o(Q,X,$,Y,G){Q[X]=$,sY(Q,X,Y,G)}var i9=(Q,X)=>{let $=0;for(;$<Q.length&&$<X.length;$++)if(Q[$]!==X[$])break;return[(Q.length-$).toString(),...X.slice($)].join("/")};function V1(Q){if(Q.target!=="openAi")return{};let X=[...Q.basePath,Q.definitionPath,Q.openAiAnyTypeName];return Q.flags.hasReferencedOpenAiAnyType=!0,{$ref:Q.$refStrategy==="relative"?i9(X,Q.currentPath):X.join("/")}}function VH(Q,X){let $={type:"array"};if(Q.type?._def&&Q.type?._def?.typeName!==w.ZodAny)$.items=g(Q.type._def,{...X,currentPath:[...X.currentPath,"items"]});if(Q.minLength)o($,"minItems",Q.minLength.value,Q.minLength.message,X);if(Q.maxLength)o($,"maxItems",Q.maxLength.value,Q.maxLength.message,X);if(Q.exactLength)o($,"minItems",Q.exactLength.value,Q.exactLength.message,X),o($,"maxItems",Q.exactLength.value,Q.exactLength.message,X);return $}function qH(Q,X){let $={type:"integer",format:"int64"};if(!Q.checks)return $;for(let Y of Q.checks)switch(Y.kind){case"min":if(X.target==="jsonSchema7")if(Y.inclusive)o($,"minimum",Y.value,Y.message,X);else o($,"exclusiveMinimum",Y.value,Y.message,X);else{if(!Y.inclusive)$.exclusiveMinimum=!0;o($,"minimum",Y.value,Y.message,X)}break;case"max":if(X.target==="jsonSchema7")if(Y.inclusive)o($,"maximum",Y.value,Y.message,X);else o($,"exclusiveMaximum",Y.value,Y.message,X);else{if(!Y.inclusive)$.exclusiveMaximum=!0;o($,"maximum",Y.value,Y.message,X)}break;case"multipleOf":o($,"multipleOf",Y.value,Y.message,X);break}return $}function UH(){return{type:"boolean"}}function n9(Q,X){return g(Q.type._def,X)}var LH=(Q,X)=>{return g(Q.innerType._def,X)};function eY(Q,X,$){let Y=$??X.dateStrategy;if(Array.isArray(Y))return{anyOf:Y.map((G,J)=>eY(Q,X,G))};switch(Y){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return $w(Q,X)}}var $w=(Q,X)=>{let $={type:"integer",format:"unix-time"};if(X.target==="openApi3")return $;for(let Y of Q.checks)switch(Y.kind){case"min":o($,"minimum",Y.value,Y.message,X);break;case"max":o($,"maximum",Y.value,Y.message,X);break}return $};function FH(Q,X){return{...g(Q.innerType._def,X),default:Q.defaultValue()}}function NH(Q,X){return X.effectStrategy==="input"?g(Q.schema._def,X):V1(X)}function DH(Q){return{type:"string",enum:Array.from(Q.values)}}var Yw=(Q)=>{if("type"in Q&&Q.type==="string")return!1;return"allOf"in Q};function OH(Q,X){let $=[g(Q.left._def,{...X,currentPath:[...X.currentPath,"allOf","0"]}),g(Q.right._def,{...X,currentPath:[...X.currentPath,"allOf","1"]})].filter((J)=>!!J),Y=X.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,G=[];return $.forEach((J)=>{if(Yw(J)){if(G.push(...J.allOf),J.unevaluatedProperties===void 0)Y=void 0}else{let W=J;if("additionalProperties"in J&&J.additionalProperties===!1){let{additionalProperties:H,...z}=J;W=z}else Y=void 0;G.push(W)}}),G.length?{allOf:G,...Y}:void 0}function MH(Q,X){let $=typeof Q.value;if($!=="bigint"&&$!=="number"&&$!=="boolean"&&$!=="string")return{type:Array.isArray(Q.value)?"array":"object"};if(X.target==="openApi3")return{type:$==="bigint"?"integer":$,enum:[Q.value]};return{type:$==="bigint"?"integer":$,const:Q.value}}var QG=void 0,s1={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>{if(QG===void 0)QG=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u");return QG},uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function o9(Q,X){let $={type:"string"};if(Q.checks)for(let Y of Q.checks)switch(Y.kind){case"min":o($,"minLength",typeof $.minLength==="number"?Math.max($.minLength,Y.value):Y.value,Y.message,X);break;case"max":o($,"maxLength",typeof $.maxLength==="number"?Math.min($.maxLength,Y.value):Y.value,Y.message,X);break;case"email":switch(X.emailStrategy){case"format:email":e1($,"email",Y.message,X);break;case"format:idn-email":e1($,"idn-email",Y.message,X);break;case"pattern:zod":_1($,s1.email,Y.message,X);break}break;case"url":e1($,"uri",Y.message,X);break;case"uuid":e1($,"uuid",Y.message,X);break;case"regex":_1($,Y.regex,Y.message,X);break;case"cuid":_1($,s1.cuid,Y.message,X);break;case"cuid2":_1($,s1.cuid2,Y.message,X);break;case"startsWith":_1($,RegExp(`^${XG(Y.value,X)}`),Y.message,X);break;case"endsWith":_1($,RegExp(`${XG(Y.value,X)}$`),Y.message,X);break;case"datetime":e1($,"date-time",Y.message,X);break;case"date":e1($,"date",Y.message,X);break;case"time":e1($,"time",Y.message,X);break;case"duration":e1($,"duration",Y.message,X);break;case"length":o($,"minLength",typeof $.minLength==="number"?Math.max($.minLength,Y.value):Y.value,Y.message,X),o($,"maxLength",typeof $.maxLength==="number"?Math.min($.maxLength,Y.value):Y.value,Y.message,X);break;case"includes":{_1($,RegExp(XG(Y.value,X)),Y.message,X);break}case"ip":{if(Y.version!=="v6")e1($,"ipv4",Y.message,X);if(Y.version!=="v4")e1($,"ipv6",Y.message,X);break}case"base64url":_1($,s1.base64url,Y.message,X);break;case"jwt":_1($,s1.jwt,Y.message,X);break;case"cidr":{if(Y.version!=="v6")_1($,s1.ipv4Cidr,Y.message,X);if(Y.version!=="v4")_1($,s1.ipv6Cidr,Y.message,X);break}case"emoji":_1($,s1.emoji(),Y.message,X);break;case"ulid":{_1($,s1.ulid,Y.message,X);break}case"base64":{switch(X.base64Strategy){case"format:binary":{e1($,"binary",Y.message,X);break}case"contentEncoding:base64":{o($,"contentEncoding","base64",Y.message,X);break}case"pattern:zod":{_1($,s1.base64,Y.message,X);break}}break}case"nanoid":_1($,s1.nanoid,Y.message,X);case"toLowerCase":case"toUpperCase":case"trim":break;default:((G)=>{})(Y)}return $}function XG(Q,X){return X.patternStrategy==="escape"?Jw(Q):Q}var Gw=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Jw(Q){let X="";for(let $=0;$<Q.length;$++){if(!Gw.has(Q[$]))X+="\\";X+=Q[$]}return X}function e1(Q,X,$,Y){if(Q.format||Q.anyOf?.some((G)=>G.format)){if(!Q.anyOf)Q.anyOf=[];if(Q.format){if(Q.anyOf.push({format:Q.format,...Q.errorMessage&&Y.errorMessages&&{errorMessage:{format:Q.errorMessage.format}}}),delete Q.format,Q.errorMessage){if(delete Q.errorMessage.format,Object.keys(Q.errorMessage).length===0)delete Q.errorMessage}}Q.anyOf.push({format:X,...$&&Y.errorMessages&&{errorMessage:{format:$}}})}else o(Q,"format",X,$,Y)}function _1(Q,X,$,Y){if(Q.pattern||Q.allOf?.some((G)=>G.pattern)){if(!Q.allOf)Q.allOf=[];if(Q.pattern){if(Q.allOf.push({pattern:Q.pattern,...Q.errorMessage&&Y.errorMessages&&{errorMessage:{pattern:Q.errorMessage.pattern}}}),delete Q.pattern,Q.errorMessage){if(delete Q.errorMessage.pattern,Object.keys(Q.errorMessage).length===0)delete Q.errorMessage}}Q.allOf.push({pattern:AH(X,Y),...$&&Y.errorMessages&&{errorMessage:{pattern:$}}})}else o(Q,"pattern",AH(X,Y),$,Y)}function AH(Q,X){if(!X.applyRegexFlags||!Q.flags)return Q.source;let $={i:Q.flags.includes("i"),m:Q.flags.includes("m"),s:Q.flags.includes("s")},Y=$.i?Q.source.toLowerCase():Q.source,G="",J=!1,W=!1,H=!1;for(let z=0;z<Y.length;z++){if(J){G+=Y[z],J=!1;continue}if($.i){if(W){if(Y[z].match(/[a-z]/)){if(H)G+=Y[z],G+=`${Y[z-2]}-${Y[z]}`.toUpperCase(),H=!1;else if(Y[z+1]==="-"&&Y[z+2]?.match(/[a-z]/))G+=Y[z],H=!0;else G+=`${Y[z]}${Y[z].toUpperCase()}`;continue}}else if(Y[z].match(/[a-z]/)){G+=`[${Y[z]}${Y[z].toUpperCase()}]`;continue}}if($.m){if(Y[z]==="^"){G+=`(^|(?<=[\r
]))`;continue}else if(Y[z]==="$"){G+=`($|(?=[\r
]))`;continue}}if($.s&&Y[z]==="."){G+=W?`${Y[z]}\r
`:`[${Y[z]}\r
]`;continue}if(G+=Y[z],Y[z]==="\\")J=!0;else if(W&&Y[z]==="]")W=!1;else if(!W&&Y[z]==="[")W=!0}try{new RegExp(G)}catch{return console.warn(`Could not convert regex pattern at ${X.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),Q.source}return G}function r9(Q,X){if(X.target==="openAi")console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead.");if(X.target==="openApi3"&&Q.keyType?._def.typeName===w.ZodEnum)return{type:"object",required:Q.keyType._def.values,properties:Q.keyType._def.values.reduce((Y,G)=>({...Y,[G]:g(Q.valueType._def,{...X,currentPath:[...X.currentPath,"properties",G]})??V1(X)}),{}),additionalProperties:X.rejectedAdditionalProperties};let $={type:"object",additionalProperties:g(Q.valueType._def,{...X,currentPath:[...X.currentPath,"additionalProperties"]})??X.allowedAdditionalProperties};if(X.target==="openApi3")return $;if(Q.keyType?._def.typeName===w.ZodString&&Q.keyType._def.checks?.length){let{type:Y,...G}=o9(Q.keyType._def,X);return{...$,propertyNames:G}}else if(Q.keyType?._def.typeName===w.ZodEnum)return{...$,propertyNames:{enum:Q.keyType._def.values}};else if(Q.keyType?._def.typeName===w.ZodBranded&&Q.keyType._def.type._def.typeName===w.ZodString&&Q.keyType._def.type._def.checks?.length){let{type:Y,...G}=n9(Q.keyType._def,X);return{...$,propertyNames:G}}return $}function wH(Q,X){if(X.mapStrategy==="record")return r9(Q,X);let $=g(Q.keyType._def,{...X,currentPath:[...X.currentPath,"items","items","0"]})||V1(X),Y=g(Q.valueType._def,{...X,currentPath:[...X.currentPath,"items","items","1"]})||V1(X);return{type:"array",maxItems:125,items:{type:"array",items:[$,Y],minItems:2,maxItems:2}}}function jH(Q){let X=Q.values,Y=Object.keys(Q.values).filter((J)=>{return typeof X[X[J]]!=="number"}).map((J)=>X[J]),G=Array.from(new Set(Y.map((J)=>typeof J)));return{type:G.length===1?G[0]==="string"?"string":"number":["string","number"],enum:Y}}function IH(Q){return Q.target==="openAi"?void 0:{not:V1({...Q,currentPath:[...Q.currentPath,"not"]})}}function bH(Q){return Q.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var r4={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function EH(Q,X){if(X.target==="openApi3")return RH(Q,X);let $=Q.options instanceof Map?Array.from(Q.options.values()):Q.options;if($.every((Y)=>(Y._def.typeName in r4)&&(!Y._def.checks||!Y._def.checks.length))){let Y=$.reduce((G,J)=>{let W=r4[J._def.typeName];return W&&!G.includes(W)?[...G,W]:G},[]);return{type:Y.length>1?Y:Y[0]}}else if($.every((Y)=>Y._def.typeName==="ZodLiteral"&&!Y.description)){let Y=$.reduce((G,J)=>{let W=typeof J._def.value;switch(W){case"string":case"number":case"boolean":return[...G,W];case"bigint":return[...G,"integer"];case"object":if(J._def.value===null)return[...G,"null"];case"symbol":case"undefined":case"function":default:return G}},[]);if(Y.length===$.length){let G=Y.filter((J,W,H)=>H.indexOf(J)===W);return{type:G.length>1?G:G[0],enum:$.reduce((J,W)=>{return J.includes(W._def.value)?J:[...J,W._def.value]},[])}}}else if($.every((Y)=>Y._def.typeName==="ZodEnum"))return{type:"string",enum:$.reduce((Y,G)=>[...Y,...G._def.values.filter((J)=>!Y.includes(J))],[])};return RH(Q,X)}var RH=(Q,X)=>{let $=(Q.options instanceof Map?Array.from(Q.options.values()):Q.options).map((Y,G)=>g(Y._def,{...X,currentPath:[...X.currentPath,"anyOf",`${G}`]})).filter((Y)=>!!Y&&(!X.strictUnions||typeof Y==="object"&&Object.keys(Y).length>0));return $.length?{anyOf:$}:void 0};function PH(Q,X){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(Q.innerType._def.typeName)&&(!Q.innerType._def.checks||!Q.innerType._def.checks.length)){if(X.target==="openApi3")return{type:r4[Q.innerType._def.typeName],nullable:!0};return{type:[r4[Q.innerType._def.typeName],"null"]}}if(X.target==="openApi3"){let Y=g(Q.innerType._def,{...X,currentPath:[...X.currentPath]});if(Y&&"$ref"in Y)return{allOf:[Y],nullable:!0};return Y&&{...Y,nullable:!0}}let $=g(Q.innerType._def,{...X,currentPath:[...X.currentPath,"anyOf","0"]});return $&&{anyOf:[$,{type:"null"}]}}function SH(Q,X){let $={type:"number"};if(!Q.checks)return $;for(let Y of Q.checks)switch(Y.kind){case"int":$.type="integer",sY($,"type",Y.message,X);break;case"min":if(X.target==="jsonSchema7")if(Y.inclusive)o($,"minimum",Y.value,Y.message,X);else o($,"exclusiveMinimum",Y.value,Y.message,X);else{if(!Y.inclusive)$.exclusiveMinimum=!0;o($,"minimum",Y.value,Y.message,X)}break;case"max":if(X.target==="jsonSchema7")if(Y.inclusive)o($,"maximum",Y.value,Y.message,X);else o($,"exclusiveMaximum",Y.value,Y.message,X);else{if(!Y.inclusive)$.exclusiveMaximum=!0;o($,"maximum",Y.value,Y.message,X)}break;case"multipleOf":o($,"multipleOf",Y.value,Y.message,X);break}return $}function ZH(Q,X){let $=X.target==="openAi",Y={type:"object",properties:{}},G=[],J=Q.shape();for(let H in J){let z=J[H];if(z===void 0||z._def===void 0)continue;let B=Hw(z);if(B&&$){if(z._def.typeName==="ZodOptional")z=z._def.innerType;if(!z.isNullable())z=z.nullable();B=!1}let K=g(z._def,{...X,currentPath:[...X.currentPath,"properties",H],propertyPath:[...X.currentPath,"properties",H]});if(K===void 0)continue;if(Y.properties[H]=K,!B)G.push(H)}if(G.length)Y.required=G;let W=Ww(Q,X);if(W!==void 0)Y.additionalProperties=W;return Y}function Ww(Q,X){if(Q.catchall._def.typeName!=="ZodNever")return g(Q.catchall._def,{...X,currentPath:[...X.currentPath,"additionalProperties"]});switch(Q.unknownKeys){case"passthrough":return X.allowedAdditionalProperties;case"strict":return X.rejectedAdditionalProperties;case"strip":return X.removeAdditionalStrategy==="strict"?X.allowedAdditionalProperties:X.rejectedAdditionalProperties}}function Hw(Q){try{return Q.isOptional()}catch{return!0}}var CH=(Q,X)=>{if(X.currentPath.toString()===X.propertyPath?.toString())return g(Q.innerType._def,X);let $=g(Q.innerType._def,{...X,currentPath:[...X.currentPath,"anyOf","1"]});return $?{anyOf:[{not:V1(X)},$]}:V1(X)};var _H=(Q,X)=>{if(X.pipeStrategy==="input")return g(Q.in._def,X);else if(X.pipeStrategy==="output")return g(Q.out._def,X);let $=g(Q.in._def,{...X,currentPath:[...X.currentPath,"allOf","0"]}),Y=g(Q.out._def,{...X,currentPath:[...X.currentPath,"allOf",$?"1":"0"]});return{allOf:[$,Y].filter((G)=>G!==void 0)}};function kH(Q,X){return g(Q.type._def,X)}function vH(Q,X){let Y={type:"array",uniqueItems:!0,items:g(Q.valueType._def,{...X,currentPath:[...X.currentPath,"items"]})};if(Q.minSize)o(Y,"minItems",Q.minSize.value,Q.minSize.message,X);if(Q.maxSize)o(Y,"maxItems",Q.maxSize.value,Q.maxSize.message,X);return Y}function TH(Q,X){if(Q.rest)return{type:"array",minItems:Q.items.length,items:Q.items.map(($,Y)=>g($._def,{...X,currentPath:[...X.currentPath,"items",`${Y}`]})).reduce(($,Y)=>Y===void 0?$:[...$,Y],[]),additionalItems:g(Q.rest._def,{...X,currentPath:[...X.currentPath,"additionalItems"]})};else return{type:"array",minItems:Q.items.length,maxItems:Q.items.length,items:Q.items.map(($,Y)=>g($._def,{...X,currentPath:[...X.currentPath,"items",`${Y}`]})).reduce(($,Y)=>Y===void 0?$:[...$,Y],[])}}function xH(Q){return{not:V1(Q)}}function yH(Q){return V1(Q)}var gH=(Q,X)=>{return g(Q.innerType._def,X)};var fH=(Q,X,$)=>{switch(X){case w.ZodString:return o9(Q,$);case w.ZodNumber:return SH(Q,$);case w.ZodObject:return ZH(Q,$);case w.ZodBigInt:return qH(Q,$);case w.ZodBoolean:return UH();case w.ZodDate:return eY(Q,$);case w.ZodUndefined:return xH($);case w.ZodNull:return bH($);case w.ZodArray:return VH(Q,$);case w.ZodUnion:case w.ZodDiscriminatedUnion:return EH(Q,$);case w.ZodIntersection:return OH(Q,$);case w.ZodTuple:return TH(Q,$);case w.ZodRecord:return r9(Q,$);case w.ZodLiteral:return MH(Q,$);case w.ZodEnum:return DH(Q);case w.ZodNativeEnum:return jH(Q);case w.ZodNullable:return PH(Q,$);case w.ZodOptional:return CH(Q,$);case w.ZodMap:return wH(Q,$);case w.ZodSet:return vH(Q,$);case w.ZodLazy:return()=>Q.getter()._def;case w.ZodPromise:return kH(Q,$);case w.ZodNaN:case w.ZodNever:return IH($);case w.ZodEffects:return NH(Q,$);case w.ZodAny:return V1($);case w.ZodUnknown:return yH($);case w.ZodDefault:return FH(Q,$);case w.ZodBranded:return n9(Q,$);case w.ZodReadonly:return gH(Q,$);case w.ZodCatch:return LH(Q,$);case w.ZodPipeline:return _H(Q,$);case w.ZodFunction:case w.ZodVoid:case w.ZodSymbol:return;default:return((Y)=>{return})(X)}};function g(Q,X,$=!1){let Y=X.seen.get(Q);if(X.override){let H=X.override?.(Q,X,Y,$);if(H!==zH)return H}if(Y&&!$){let H=zw(Y,X);if(H!==void 0)return H}let G={def:Q,path:X.currentPath,jsonSchema:void 0};X.seen.set(Q,G);let J=fH(Q,Q.typeName,X),W=typeof J==="function"?g(J(),X):J;if(W)Bw(Q,X,W);if(X.postProcess){let H=X.postProcess(W,Q,X);return G.jsonSchema=W,H}return G.jsonSchema=W,W}var zw=(Q,X)=>{switch(X.$refStrategy){case"root":return{$ref:Q.path.join("/")};case"relative":return{$ref:i9(X.currentPath,Q.path)};case"none":case"seen":{if(Q.path.length<X.currentPath.length&&Q.path.every(($,Y)=>X.currentPath[Y]===$))return console.warn(`Recursive reference detected at ${X.currentPath.join("/")}! Defaulting to any`),V1(X);return X.$refStrategy==="seen"?V1(X):void 0}}},Bw=(Q,X,$)=>{if(Q.description){if($.description=Q.description,X.markdownDescription)$.markdownDescription=Q.description}return $};var $G=(Q,X)=>{let $=KH(X),Y=typeof X==="object"&&X.definitions?Object.entries(X.definitions).reduce((z,[B,K])=>({...z,[B]:g(K._def,{...$,currentPath:[...$.basePath,$.definitionPath,B]},!0)??V1($)}),{}):void 0,G=typeof X==="string"?X:X?.nameStrategy==="title"?void 0:X?.name,J=g(Q._def,G===void 0?$:{...$,currentPath:[...$.basePath,$.definitionPath,G]},!1)??V1($),W=typeof X==="object"&&X.name!==void 0&&X.nameStrategy==="title"?X.name:void 0;if(W!==void 0)J.title=W;if($.flags.hasReferencedOpenAiAnyType){if(!Y)Y={};if(!Y[$.openAiAnyTypeName])Y[$.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:$.$refStrategy==="relative"?"1":[...$.basePath,$.definitionPath,$.openAiAnyTypeName].join("/")}}}let H=G===void 0?Y?{...J,[$.definitionPath]:Y}:J:{$ref:[...$.$refStrategy==="relative"?[]:$.basePath,$.definitionPath,G].join("/"),[$.definitionPath]:{...Y,[G]:J}};if($.target==="jsonSchema7")H.$schema="http://json-schema.org/draft-07/schema#";else if($.target==="jsonSchema2019-09"||$.target==="openAi")H.$schema="https://json-schema.org/draft/2019-09/schema#";if($.target==="openAi"&&(("anyOf"in H)||("oneOf"in H)||("allOf"in H)||("type"in H)&&Array.isArray(H.type)))console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property.");return H};function Kw(Q){if(!Q)return"draft-7";if(Q==="jsonSchema7"||Q==="draft-7")return"draft-7";if(Q==="jsonSchema2019-09"||Q==="draft-2020-12")return"draft-2020-12";return"draft-7"}function YG(Q,X){if(d1(Q))return RY(Q,{target:Kw(X?.target),io:X?.pipeStrategy??"input"});return $G(Q,{strictUnions:X?.strictUnions??!0,pipeStrategy:X?.pipeStrategy??"input"})}function GG(Q){let $=u0(Q)?.method;if(!$)throw Error("Schema is missing a method literal");let Y=j9($);if(typeof Y!=="string")throw Error("Schema method literal must be a string");return Y}function JG(Q,X){let $=h0(Q,X);if(!$.success)throw $.error;return $.data}var Vw=60000;class WG{constructor(Q){if(this._options=Q,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(Z9,(X)=>{this._oncancel(X)}),this.setNotificationHandler(_9,(X)=>{this._onprogress(X)}),this.setRequestHandler(C9,(X)=>({})),this._taskStore=Q?.taskStore,this._taskMessageQueue=Q?.taskMessageQueue,this._taskStore)this.setRequestHandler(k9,async(X,$)=>{let Y=await this._taskStore.getTask(X.params.taskId,$.sessionId);if(!Y)throw new Z(T.InvalidParams,"Failed to retrieve task: Task not found");return{...Y}}),this.setRequestHandler(T9,async(X,$)=>{let Y=async()=>{let G=X.params.taskId;if(this._taskMessageQueue){let W;while(W=await this._taskMessageQueue.dequeue(G,$.sessionId)){if(W.type==="response"||W.type==="error"){let H=W.message,z=H.id,B=this._requestResolvers.get(z);if(B)if(this._requestResolvers.delete(z),W.type==="response")B(H);else{let K=H,q=new Z(K.error.code,K.error.message,K.error.data);B(q)}else{let K=W.type==="response"?"Response":"Error";this._onerror(Error(`${K} handler missing for request ${z}`))}continue}await this._transport?.send(W.message,{relatedRequestId:$.requestId})}}let J=await this._taskStore.getTask(G,$.sessionId);if(!J)throw new Z(T.InvalidParams,`Task not found: ${G}`);if(!m0(J.status))return await this._waitForTaskUpdate(G,$.signal),await Y();if(m0(J.status)){let W=await this._taskStore.getTaskResult(G,$.sessionId);return this._clearTaskQueue(G),{...W,_meta:{...W._meta,[l0]:{taskId:G}}}}return await Y()};return await Y()}),this.setRequestHandler(x9,async(X,$)=>{try{let{tasks:Y,nextCursor:G}=await this._taskStore.listTasks(X.params?.cursor,$.sessionId);return{tasks:Y,nextCursor:G,_meta:{}}}catch(Y){throw new Z(T.InvalidParams,`Failed to list tasks: ${Y instanceof Error?Y.message:String(Y)}`)}}),this.setRequestHandler(g9,async(X,$)=>{try{let Y=await this._taskStore.getTask(X.params.taskId,$.sessionId);if(!Y)throw new Z(T.InvalidParams,`Task not found: ${X.params.taskId}`);if(m0(Y.status))throw new Z(T.InvalidParams,`Cannot cancel task in terminal status: ${Y.status}`);await this._taskStore.updateTaskStatus(X.params.taskId,"cancelled","Client cancelled task execution.",$.sessionId),this._clearTaskQueue(X.params.taskId);let G=await this._taskStore.getTask(X.params.taskId,$.sessionId);if(!G)throw new Z(T.InvalidParams,`Task not found after cancellation: ${X.params.taskId}`);return{_meta:{},...G}}catch(Y){if(Y instanceof Z)throw Y;throw new Z(T.InvalidRequest,`Failed to cancel task: ${Y instanceof Error?Y.message:String(Y)}`)}})}async _oncancel(Q){if(!Q.params.requestId)return;this._requestHandlerAbortControllers.get(Q.params.requestId)?.abort(Q.params.reason)}_setupTimeout(Q,X,$,Y,G=!1){this._timeoutInfo.set(Q,{timeoutId:setTimeout(Y,X),startTime:Date.now(),timeout:X,maxTotalTimeout:$,resetTimeoutOnProgress:G,onTimeout:Y})}_resetTimeout(Q){let X=this._timeoutInfo.get(Q);if(!X)return!1;let $=Date.now()-X.startTime;if(X.maxTotalTimeout&&$>=X.maxTotalTimeout)throw this._timeoutInfo.delete(Q),Z.fromError(T.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:X.maxTotalTimeout,totalElapsed:$});return clearTimeout(X.timeoutId),X.timeoutId=setTimeout(X.onTimeout,X.timeout),!0}_cleanupTimeout(Q){let X=this._timeoutInfo.get(Q);if(X)clearTimeout(X.timeoutId),this._timeoutInfo.delete(Q)}async connect(Q){if(this._transport)throw Error("Already connected to a transport. Call close() before connecting to a new transport, or use a separate Protocol instance per connection.");this._transport=Q;let X=this.transport?.onclose;this._transport.onclose=()=>{X?.(),this._onclose()};let $=this.transport?.onerror;this._transport.onerror=(G)=>{$?.(G),this._onerror(G)};let Y=this._transport?.onmessage;this._transport.onmessage=(G,J)=>{if(Y?.(G,J),u4(G)||t3(G))this._onresponse(G);else if(fY(G))this._onrequest(G,J);else if(r3(G))this._onnotification(G);else this._onerror(Error(`Unknown message type: ${JSON.stringify(G)}`))},await this._transport.start()}_onclose(){let Q=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();for(let $ of this._requestHandlerAbortControllers.values())$.abort();this._requestHandlerAbortControllers.clear();let X=Z.fromError(T.ConnectionClosed,"Connection closed");this._transport=void 0,this.onclose?.();for(let $ of Q.values())$(X)}_onerror(Q){this.onerror?.(Q)}_onnotification(Q){let X=this._notificationHandlers.get(Q.method)??this.fallbackNotificationHandler;if(X===void 0)return;Promise.resolve().then(()=>X(Q)).catch(($)=>this._onerror(Error(`Uncaught error in notification handler: ${$}`)))}_onrequest(Q,X){let $=this._requestHandlers.get(Q.method)??this.fallbackRequestHandler,Y=this._transport,G=Q.params?._meta?.[l0]?.taskId;if($===void 0){let B={jsonrpc:"2.0",id:Q.id,error:{code:T.MethodNotFound,message:"Method not found"}};if(G&&this._taskMessageQueue)this._enqueueTaskMessage(G,{type:"error",message:B,timestamp:Date.now()},Y?.sessionId).catch((K)=>this._onerror(Error(`Failed to enqueue error response: ${K}`)));else Y?.send(B).catch((K)=>this._onerror(Error(`Failed to send an error response: ${K}`)));return}let J=new AbortController;this._requestHandlerAbortControllers.set(Q.id,J);let W=i3(Q.params)?Q.params.task:void 0,H=this._taskStore?this.requestTaskStore(Q,Y?.sessionId):void 0,z={signal:J.signal,sessionId:Y?.sessionId,_meta:Q.params?._meta,sendNotification:async(B)=>{if(J.signal.aborted)return;let K={relatedRequestId:Q.id};if(G)K.relatedTask={taskId:G};await this.notification(B,K)},sendRequest:async(B,K,q)=>{if(J.signal.aborted)throw new Z(T.ConnectionClosed,"Request was cancelled");let U={...q,relatedRequestId:Q.id};if(G&&!U.relatedTask)U.relatedTask={taskId:G};let V=U.relatedTask?.taskId??G;if(V&&H)await H.updateTaskStatus(V,"input_required");return await this.request(B,K,U)},authInfo:X?.authInfo,requestId:Q.id,requestInfo:X?.requestInfo,taskId:G,taskStore:H,taskRequestedTtl:W?.ttl,closeSSEStream:X?.closeSSEStream,closeStandaloneSSEStream:X?.closeStandaloneSSEStream};Promise.resolve().then(()=>{if(W)this.assertTaskHandlerCapability(Q.method)}).then(()=>$(Q,z)).then(async(B)=>{if(J.signal.aborted)return;let K={result:B,jsonrpc:"2.0",id:Q.id};if(G&&this._taskMessageQueue)await this._enqueueTaskMessage(G,{type:"response",message:K,timestamp:Date.now()},Y?.sessionId);else await Y?.send(K)},async(B)=>{if(J.signal.aborted)return;let K={jsonrpc:"2.0",id:Q.id,error:{code:Number.isSafeInteger(B.code)?B.code:T.InternalError,message:B.message??"Internal error",...B.data!==void 0&&{data:B.data}}};if(G&&this._taskMessageQueue)await this._enqueueTaskMessage(G,{type:"error",message:K,timestamp:Date.now()},Y?.sessionId);else await Y?.send(K)}).catch((B)=>this._onerror(Error(`Failed to send response: ${B}`))).finally(()=>{this._requestHandlerAbortControllers.delete(Q.id)})}_onprogress(Q){let{progressToken:X,...$}=Q.params,Y=Number(X),G=this._progressHandlers.get(Y);if(!G){this._onerror(Error(`Received a progress notification for an unknown token: ${JSON.stringify(Q)}`));return}let J=this._responseHandlers.get(Y),W=this._timeoutInfo.get(Y);if(W&&J&&W.resetTimeoutOnProgress)try{this._resetTimeout(Y)}catch(H){this._responseHandlers.delete(Y),this._progressHandlers.delete(Y),this._cleanupTimeout(Y),J(H);return}G($)}_onresponse(Q){let X=Number(Q.id),$=this._requestResolvers.get(X);if($){if(this._requestResolvers.delete(X),u4(Q))$(Q);else{let J=new Z(Q.error.code,Q.error.message,Q.error.data);$(J)}return}let Y=this._responseHandlers.get(X);if(Y===void 0){this._onerror(Error(`Received a response for an unknown message ID: ${JSON.stringify(Q)}`));return}this._responseHandlers.delete(X),this._cleanupTimeout(X);let G=!1;if(u4(Q)&&Q.result&&typeof Q.result==="object"){let J=Q.result;if(J.task&&typeof J.task==="object"){let W=J.task;if(typeof W.taskId==="string")G=!0,this._taskProgressTokens.set(W.taskId,X)}}if(!G)this._progressHandlers.delete(X);if(u4(Q))Y(Q);else{let J=Z.fromError(Q.error.code,Q.error.message,Q.error.data);Y(J)}}get transport(){return this._transport}async close(){await this._transport?.close()}async*requestStream(Q,X,$){let{task:Y}=$??{};if(!Y){try{yield{type:"result",result:await this.request(Q,X,$)}}catch(J){yield{type:"error",error:J instanceof Z?J:new Z(T.InternalError,String(J))}}return}let G;try{let J=await this.request(Q,l6,$);if(J.task)G=J.task.taskId,yield{type:"taskCreated",task:J.task};else throw new Z(T.InternalError,"Task creation did not return a task");while(!0){let W=await this.getTask({taskId:G},$);if(yield{type:"taskStatus",task:W},m0(W.status)){if(W.status==="completed")yield{type:"result",result:await this.getTaskResult({taskId:G},X,$)};else if(W.status==="failed")yield{type:"error",error:new Z(T.InternalError,`Task ${G} failed`)};else if(W.status==="cancelled")yield{type:"error",error:new Z(T.InternalError,`Task ${G} was cancelled`)};return}if(W.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:G},X,$)};return}let H=W.pollInterval??this._options?.defaultTaskPollInterval??1000;await new Promise((z)=>setTimeout(z,H)),$?.signal?.throwIfAborted()}}catch(J){yield{type:"error",error:J instanceof Z?J:new Z(T.InternalError,String(J))}}}request(Q,X,$){let{relatedRequestId:Y,resumptionToken:G,onresumptiontoken:J,task:W,relatedTask:H}=$??{};return new Promise((z,B)=>{let K=(O)=>{B(O)};if(!this._transport){K(Error("Not connected"));return}if(this._options?.enforceStrictCapabilities===!0)try{if(this.assertCapabilityForMethod(Q.method),W)this.assertTaskCapability(Q.method)}catch(O){K(O);return}$?.signal?.throwIfAborted();let q=this._requestMessageId++,U={...Q,jsonrpc:"2.0",id:q};if($?.onprogress)this._progressHandlers.set(q,$.onprogress),U.params={...Q.params,_meta:{...Q.params?._meta||{},progressToken:q}};if(W)U.params={...U.params,task:W};if(H)U.params={...U.params,_meta:{...U.params?._meta||{},[l0]:H}};let V=(O)=>{this._responseHandlers.delete(q),this._progressHandlers.delete(q),this._cleanupTimeout(q),this._transport?.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:q,reason:String(O)}},{relatedRequestId:Y,resumptionToken:G,onresumptiontoken:J}).catch((I)=>this._onerror(Error(`Failed to send cancellation: ${I}`)));let j=O instanceof Z?O:new Z(T.RequestTimeout,String(O));B(j)};this._responseHandlers.set(q,(O)=>{if($?.signal?.aborted)return;if(O instanceof Error)return B(O);try{let j=h0(X,O.result);if(!j.success)B(j.error);else z(j.data)}catch(j){B(j)}}),$?.signal?.addEventListener("abort",()=>{V($?.signal?.reason)});let L=$?.timeout??Vw,F=()=>V(Z.fromError(T.RequestTimeout,"Request timed out",{timeout:L}));this._setupTimeout(q,L,$?.maxTotalTimeout,F,$?.resetTimeoutOnProgress??!1);let M=H?.taskId;if(M){let O=(j)=>{let I=this._responseHandlers.get(q);if(I)I(j);else this._onerror(Error(`Response handler missing for side-channeled request ${q}`))};this._requestResolvers.set(q,O),this._enqueueTaskMessage(M,{type:"request",message:U,timestamp:Date.now()}).catch((j)=>{this._cleanupTimeout(q),B(j)})}else this._transport.send(U,{relatedRequestId:Y,resumptionToken:G,onresumptiontoken:J}).catch((O)=>{this._cleanupTimeout(q),B(O)})})}async getTask(Q,X){return this.request({method:"tasks/get",params:Q},v9,X)}async getTaskResult(Q,X,$){return this.request({method:"tasks/result",params:Q},X,$)}async listTasks(Q,X){return this.request({method:"tasks/list",params:Q},y9,X)}async cancelTask(Q,X){return this.request({method:"tasks/cancel",params:Q},s3,X)}async notification(Q,X){if(!this._transport)throw Error("Not connected");this.assertNotificationCapability(Q.method);let $=X?.relatedTask?.taskId;if($){let W={...Q,jsonrpc:"2.0",params:{...Q.params,_meta:{...Q.params?._meta||{},[l0]:X.relatedTask}}};await this._enqueueTaskMessage($,{type:"notification",message:W,timestamp:Date.now()});return}if((this._options?.debouncedNotificationMethods??[]).includes(Q.method)&&!Q.params&&!X?.relatedRequestId&&!X?.relatedTask){if(this._pendingDebouncedNotifications.has(Q.method))return;this._pendingDebouncedNotifications.add(Q.method),Promise.resolve().then(()=>{if(this._pendingDebouncedNotifications.delete(Q.method),!this._transport)return;let W={...Q,jsonrpc:"2.0"};if(X?.relatedTask)W={...W,params:{...W.params,_meta:{...W.params?._meta||{},[l0]:X.relatedTask}}};this._transport?.send(W,X).catch((H)=>this._onerror(H))});return}let J={...Q,jsonrpc:"2.0"};if(X?.relatedTask)J={...J,params:{...J.params,_meta:{...J.params?._meta||{},[l0]:X.relatedTask}}};await this._transport.send(J,X)}setRequestHandler(Q,X){let $=GG(Q);this.assertRequestHandlerCapability($),this._requestHandlers.set($,(Y,G)=>{let J=JG(Q,Y);return Promise.resolve(X(J,G))})}removeRequestHandler(Q){this._requestHandlers.delete(Q)}assertCanSetRequestHandler(Q){if(this._requestHandlers.has(Q))throw Error(`A request handler for ${Q} already exists, which would be overridden`)}setNotificationHandler(Q,X){let $=GG(Q);this._notificationHandlers.set($,(Y)=>{let G=JG(Q,Y);return Promise.resolve(X(G))})}removeNotificationHandler(Q){this._notificationHandlers.delete(Q)}_cleanupTaskProgressHandler(Q){let X=this._taskProgressTokens.get(Q);if(X!==void 0)this._progressHandlers.delete(X),this._taskProgressTokens.delete(Q)}async _enqueueTaskMessage(Q,X,$){if(!this._taskStore||!this._taskMessageQueue)throw Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");let Y=this._options?.maxTaskQueueSize;await this._taskMessageQueue.enqueue(Q,X,$,Y)}async _clearTaskQueue(Q,X){if(this._taskMessageQueue){let $=await this._taskMessageQueue.dequeueAll(Q,X);for(let Y of $)if(Y.type==="request"&&fY(Y.message)){let G=Y.message.id,J=this._requestResolvers.get(G);if(J)J(new Z(T.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(G);else this._onerror(Error(`Resolver missing for request ${G} during task ${Q} cleanup`))}}}async _waitForTaskUpdate(Q,X){let $=this._options?.defaultTaskPollInterval??1000;try{let Y=await this._taskStore?.getTask(Q);if(Y?.pollInterval)$=Y.pollInterval}catch{}return new Promise((Y,G)=>{if(X.aborted){G(new Z(T.InvalidRequest,"Request cancelled"));return}let J=setTimeout(Y,$);X.addEventListener("abort",()=>{clearTimeout(J),G(new Z(T.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(Q,X){let $=this._taskStore;if(!$)throw Error("No task store configured");return{createTask:async(Y)=>{if(!Q)throw Error("No request provided");return await $.createTask(Y,Q.id,{method:Q.method,params:Q.params},X)},getTask:async(Y)=>{let G=await $.getTask(Y,X);if(!G)throw new Z(T.InvalidParams,"Failed to retrieve task: Task not found");return G},storeTaskResult:async(Y,G,J)=>{await $.storeTaskResult(Y,G,J,X);let W=await $.getTask(Y,X);if(W){let H=d4.parse({method:"notifications/tasks/status",params:W});if(await this.notification(H),m0(W.status))this._cleanupTaskProgressHandler(Y)}},getTaskResult:(Y)=>{return $.getTaskResult(Y,X)},updateTaskStatus:async(Y,G,J)=>{let W=await $.getTask(Y,X);if(!W)throw new Z(T.InvalidParams,`Task "${Y}" not found - it may have been cleaned up`);if(m0(W.status))throw new Z(T.InvalidParams,`Cannot update task "${Y}" from terminal status "${W.status}" to "${G}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await $.updateTaskStatus(Y,G,J,X);let H=await $.getTask(Y,X);if(H){let z=d4.parse({method:"notifications/tasks/status",params:H});if(await this.notification(z),m0(H.status))this._cleanupTaskProgressHandler(Y)}},listTasks:(Y)=>{return $.listTasks(Y,X)}}}}function hH(Q){return Q!==null&&typeof Q==="object"&&!Array.isArray(Q)}function uH(Q,X){let $={...Q};for(let Y in X){let G=Y,J=X[G];if(J===void 0)continue;let W=$[G];if(hH(W)&&hH(J))$[G]={...W,...J};else $[G]=J}return $}var Iq=b8(eG(),1),bq=b8(jq(),1);function MS(){let Q=new Iq.default({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return bq.default(Q),Q}class B7{constructor(Q){this._ajv=Q??MS()}getValidator(Q){let X="$id"in Q&&typeof Q.$id==="string"?this._ajv.getSchema(Q.$id)??this._ajv.compile(Q):this._ajv.compile(Q);return($)=>{if(X($))return{valid:!0,data:$,errorMessage:void 0};else return{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(X.errors)}}}}class K7{constructor(Q){this._server=Q}requestStream(Q,X,$){return this._server.requestStream(Q,X,$)}createMessageStream(Q,X){let $=this._server.getClientCapabilities();if((Q.tools||Q.toolChoice)&&!$?.sampling?.tools)throw Error("Client does not support sampling tools capability.");if(Q.messages.length>0){let Y=Q.messages[Q.messages.length-1],G=Array.isArray(Y.content)?Y.content:[Y.content],J=G.some((B)=>B.type==="tool_result"),W=Q.messages.length>1?Q.messages[Q.messages.length-2]:void 0,H=W?Array.isArray(W.content)?W.content:[W.content]:[],z=H.some((B)=>B.type==="tool_use");if(J){if(G.some((B)=>B.type!=="tool_result"))throw Error("The last message must contain only tool_result content if any is present");if(!z)throw Error("tool_result blocks are not matching any tool_use from the previous message")}if(z){let B=new Set(H.filter((q)=>q.type==="tool_use").map((q)=>q.id)),K=new Set(G.filter((q)=>q.type==="tool_result").map((q)=>q.toolUseId));if(B.size!==K.size||![...B].every((q)=>K.has(q)))throw Error("ids of tool_result blocks and tool_use blocks from previous message do not match")}}return this.requestStream({method:"sampling/createMessage",params:Q},o4,X)}elicitInputStream(Q,X){let $=this._server.getClientCapabilities(),Y=Q.mode??"form";switch(Y){case"url":{if(!$?.elicitation?.url)throw Error("Client does not support url elicitation.");break}case"form":{if(!$?.elicitation?.form)throw Error("Client does not support form elicitation.");break}}let G=Y==="form"&&Q.mode===void 0?{...Q,mode:"form"}:Q;return this.requestStream({method:"elicitation/create",params:G},p6,X)}async getTask(Q,X){return this._server.getTask({taskId:Q},X)}async getTaskResult(Q,X,$){return this._server.getTaskResult({taskId:Q},X,$)}async listTasks(Q,X){return this._server.listTasks(Q?{cursor:Q}:void 0,X)}async cancelTask(Q,X){return this._server.cancelTask({taskId:Q},X)}}function Rq(Q,X,$){if(!Q)throw Error(`${$} does not support task creation (required for ${X})`);switch(X){case"tools/call":if(!Q.tools?.call)throw Error(`${$} does not support task creation for tools/call (required for ${X})`);break;default:break}}function Eq(Q,X,$){if(!Q)throw Error(`${$} does not support task creation (required for ${X})`);switch(X){case"sampling/createMessage":if(!Q.sampling?.createMessage)throw Error(`${$} does not support task creation for sampling/createMessage (required for ${X})`);break;case"elicitation/create":if(!Q.elicitation?.create)throw Error(`${$} does not support task creation for elicitation/create (required for ${X})`);break;default:break}}class V7 extends WG{constructor(Q,X){super(X);if(this._serverInfo=Q,this._loggingLevels=new Map,this.LOG_LEVEL_SEVERITY=new Map(n4.options.map(($,Y)=>[$,Y])),this.isMessageIgnored=($,Y)=>{let G=this._loggingLevels.get(Y);return G?this.LOG_LEVEL_SEVERITY.get($)<this.LOG_LEVEL_SEVERITY.get(G):!1},this._capabilities=X?.capabilities??{},this._instructions=X?.instructions,this._jsonSchemaValidator=X?.jsonSchemaValidator??new B7,this.setRequestHandler(lY,($)=>this._oninitialize($)),this.setNotificationHandler(mY,()=>this.oninitialized?.()),this._capabilities.logging)this.setRequestHandler(rY,async($,Y)=>{let G=Y.sessionId||Y.requestInfo?.headers["mcp-session-id"]||void 0,{level:J}=$.params,W=n4.safeParse(J);if(W.success)this._loggingLevels.set(G,W.data);return{}})}get experimental(){if(!this._experimental)this._experimental={tasks:new K7(this)};return this._experimental}registerCapabilities(Q){if(this.transport)throw Error("Cannot register capabilities after connecting to transport");this._capabilities=uH(this._capabilities,Q)}setRequestHandler(Q,X){let Y=u0(Q)?.method;if(!Y)throw Error("Schema is missing a method literal");let G;if(d1(Y)){let W=Y;G=W._zod?.def?.value??W.value}else{let W=Y;G=W._def?.value??W.value}if(typeof G!=="string")throw Error("Schema method literal must be a string");if(G==="tools/call"){let W=async(H,z)=>{let B=h0(c6,H);if(!B.success){let V=B.error instanceof Error?B.error.message:String(B.error);throw new Z(T.InvalidParams,`Invalid tools/call request: ${V}`)}let{params:K}=B.data,q=await Promise.resolve(X(H,z));if(K.task){let V=h0(l6,q);if(!V.success){let L=V.error instanceof Error?V.error.message:String(V.error);throw new Z(T.InvalidParams,`Invalid task creation result: ${L}`)}return V.data}let U=h0(p9,q);if(!U.success){let V=U.error instanceof Error?U.error.message:String(U.error);throw new Z(T.InvalidParams,`Invalid tools/call result: ${V}`)}return U.data};return super.setRequestHandler(Q,W)}return super.setRequestHandler(Q,X)}assertCapabilityForMethod(Q){switch(Q){case"sampling/createMessage":if(!this._clientCapabilities?.sampling)throw Error(`Client does not support sampling (required for ${Q})`);break;case"elicitation/create":if(!this._clientCapabilities?.elicitation)throw Error(`Client does not support elicitation (required for ${Q})`);break;case"roots/list":if(!this._clientCapabilities?.roots)throw Error(`Client does not support listing roots (required for ${Q})`);break;case"ping":break}}assertNotificationCapability(Q){switch(Q){case"notifications/message":if(!this._capabilities.logging)throw Error(`Server does not support logging (required for ${Q})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw Error(`Server does not support notifying about resources (required for ${Q})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw Error(`Server does not support notifying of tool list changes (required for ${Q})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw Error(`Server does not support notifying of prompt list changes (required for ${Q})`);break;case"notifications/elicitation/complete":if(!this._clientCapabilities?.elicitation?.url)throw Error(`Client does not support URL elicitation (required for ${Q})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(Q){if(!this._capabilities)return;switch(Q){case"completion/complete":if(!this._capabilities.completions)throw Error(`Server does not support completions (required for ${Q})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw Error(`Server does not support logging (required for ${Q})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw Error(`Server does not support prompts (required for ${Q})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw Error(`Server does not support resources (required for ${Q})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw Error(`Server does not support tools (required for ${Q})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw Error(`Server does not support tasks capability (required for ${Q})`);break;case"ping":case"initialize":break}}assertTaskCapability(Q){Eq(this._clientCapabilities?.tasks?.requests,Q,"Client")}assertTaskHandlerCapability(Q){if(!this._capabilities)return;Rq(this._capabilities.tasks?.requests,Q,"Server")}async _oninitialize(Q){let X=Q.params.protocolVersion;return this._clientCapabilities=Q.params.capabilities,this._clientVersion=Q.params.clientInfo,{protocolVersion:c3.includes(X)?X:yY,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},S9)}async createMessage(Q,X){if(Q.tools||Q.toolChoice){if(!this._clientCapabilities?.sampling?.tools)throw Error("Client does not support sampling tools capability.")}if(Q.messages.length>0){let $=Q.messages[Q.messages.length-1],Y=Array.isArray($.content)?$.content:[$.content],G=Y.some((z)=>z.type==="tool_result"),J=Q.messages.length>1?Q.messages[Q.messages.length-2]:void 0,W=J?Array.isArray(J.content)?J.content:[J.content]:[],H=W.some((z)=>z.type==="tool_use");if(G){if(Y.some((z)=>z.type!=="tool_result"))throw Error("The last message must contain only tool_result content if any is present");if(!H)throw Error("tool_result blocks are not matching any tool_use from the previous message")}if(H){let z=new Set(W.filter((K)=>K.type==="tool_use").map((K)=>K.id)),B=new Set(Y.filter((K)=>K.type==="tool_result").map((K)=>K.toolUseId));if(z.size!==B.size||![...z].every((K)=>B.has(K)))throw Error("ids of tool_result blocks and tool_use blocks from previous message do not match")}}if(Q.tools)return this.request({method:"sampling/createMessage",params:Q},tY,X);return this.request({method:"sampling/createMessage",params:Q},o4,X)}async elicitInput(Q,X){switch(Q.mode??"form"){case"url":{if(!this._clientCapabilities?.elicitation?.url)throw Error("Client does not support url elicitation.");let Y=Q;return this.request({method:"elicitation/create",params:Y},p6,X)}case"form":{if(!this._clientCapabilities?.elicitation?.form)throw Error("Client does not support form elicitation.");let Y=Q.mode==="form"?Q:{...Q,mode:"form"},G=await this.request({method:"elicitation/create",params:Y},p6,X);if(G.action==="accept"&&G.content&&Y.requestedSchema)try{let W=this._jsonSchemaValidator.getValidator(Y.requestedSchema)(G.content);if(!W.valid)throw new Z(T.InvalidParams,`Elicitation response content does not match requested schema: ${W.errorMessage}`)}catch(J){if(J instanceof Z)throw J;throw new Z(T.InternalError,`Error validating elicitation response: ${J instanceof Error?J.message:String(J)}`)}return G}}}createElicitationCompletionNotifier(Q,X){if(!this._clientCapabilities?.elicitation?.url)throw Error("Client does not support URL elicitation (required for notifications/elicitation/complete)");return()=>this.notification({method:"notifications/elicitation/complete",params:{elicitationId:Q}},X)}async listRoots(Q,X){return this.request({method:"roots/list",params:Q},aY,X)}async sendLoggingMessage(Q,X){if(this._capabilities.logging){if(!this.isMessageIgnored(Q.level,X))return this.notification({method:"notifications/message",params:Q})}}async sendResourceUpdated(Q){return this.notification({method:"notifications/resources/updated",params:Q})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}}var Sq=Symbol.for("mcp.completable");function q7(Q){return!!Q&&typeof Q==="object"&&Sq in Q}function Zq(Q){return Q[Sq]?.complete}var Pq;(function(Q){Q.Completable="McpCompletable"})(Pq||(Pq={}));var AS=/^[A-Za-z0-9._-]{1,128}$/;function wS(Q){let X=[];if(Q.length===0)return{isValid:!1,warnings:["Tool name cannot be empty"]};if(Q.length>128)return{isValid:!1,warnings:[`Tool name exceeds maximum length of 128 characters (current: ${Q.length})`]};if(Q.includes(" "))X.push("Tool name contains spaces, which may cause parsing issues");if(Q.includes(","))X.push("Tool name contains commas, which may cause parsing issues");if(Q.startsWith("-")||Q.endsWith("-"))X.push("Tool name starts or ends with a dash, which may cause parsing issues in some contexts");if(Q.startsWith(".")||Q.endsWith("."))X.push("Tool name starts or ends with a dot, which may cause parsing issues in some contexts");if(!AS.test(Q)){let $=Q.split("").filter((Y)=>!/[A-Za-z0-9._-]/.test(Y)).filter((Y,G,J)=>J.indexOf(Y)===G);return X.push(`Tool name contains invalid characters: ${$.map((Y)=>`"${Y}"`).join(", ")}`,"Allowed characters are: A-Z, a-z, 0-9, underscore (_), dash (-), and dot (.)"),{isValid:!1,warnings:X}}return{isValid:!0,warnings:X}}function jS(Q,X){if(X.length>0){console.warn(`Tool name validation warning for "${Q}":`);for(let $ of X)console.warn(`  - ${$}`);console.warn("Tool registration will proceed, but this may cause compatibility issues."),console.warn("Consider updating the tool name to conform to the MCP tool naming standard."),console.warn("See SEP: Specify Format for Tool Names (https://github.com/modelcontextprotocol/modelcontextprotocol/issues/986) for more details.")}}function U7(Q){let X=wS(Q);return jS(Q,X.warnings),X.isValid}class L7{constructor(Q){this._mcpServer=Q}registerToolTask(Q,X,$){let Y={taskSupport:"required",...X.execution};if(Y.taskSupport==="forbidden")throw Error(`Cannot register task-based tool '${Q}' with taskSupport 'forbidden'. Use registerTool() instead.`);return this._mcpServer._createRegisteredTool(Q,X.title,X.description,X.inputSchema,X.outputSchema,X.annotations,Y,X._meta,$)}}class N7{constructor(Q,X){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new V7(Q,X)}get experimental(){if(!this._experimental)this._experimental={tasks:new L7(this)};return this._experimental}async connect(Q){return await this.server.connect(Q)}async close(){await this.server.close()}setToolRequestHandlers(){if(this._toolHandlersInitialized)return;this.server.assertCanSetRequestHandler(t0(c9)),this.server.assertCanSetRequestHandler(t0(c6)),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(c9,()=>({tools:Object.entries(this._registeredTools).filter(([,Q])=>Q.enabled).map(([Q,X])=>{let $={name:Q,title:X.title,description:X.description,inputSchema:(()=>{let Y=h6(X.inputSchema);return Y?YG(Y,{strictUnions:!0,pipeStrategy:"input"}):IS})(),annotations:X.annotations,execution:X.execution,_meta:X._meta};if(X.outputSchema){let Y=h6(X.outputSchema);if(Y)$.outputSchema=YG(Y,{strictUnions:!0,pipeStrategy:"output"})}return $})})),this.server.setRequestHandler(c6,async(Q,X)=>{try{let $=this._registeredTools[Q.params.name];if(!$)throw new Z(T.InvalidParams,`Tool ${Q.params.name} not found`);if(!$.enabled)throw new Z(T.InvalidParams,`Tool ${Q.params.name} disabled`);let Y=!!Q.params.task,G=$.execution?.taskSupport,J="createTask"in $.handler;if((G==="required"||G==="optional")&&!J)throw new Z(T.InternalError,`Tool ${Q.params.name} has taskSupport '${G}' but was not registered with registerToolTask`);if(G==="required"&&!Y)throw new Z(T.MethodNotFound,`Tool ${Q.params.name} requires task augmentation (taskSupport: 'required')`);if(G==="optional"&&!Y&&J)return await this.handleAutomaticTaskPolling($,Q,X);let W=await this.validateToolInput($,Q.params.arguments,Q.params.name),H=await this.executeToolHandler($,W,X);if(Y)return H;return await this.validateToolOutput($,H,Q.params.name),H}catch($){if($ instanceof Z){if($.code===T.UrlElicitationRequired)throw $}return this.createToolError($ instanceof Error?$.message:String($))}}),this._toolHandlersInitialized=!0}createToolError(Q){return{content:[{type:"text",text:Q}],isError:!0}}async validateToolInput(Q,X,$){if(!Q.inputSchema)return;let G=h6(Q.inputSchema)??Q.inputSchema,J=await A9(G,X);if(!J.success){let W="error"in J?J.error:"Unknown error",H=w9(W);throw new Z(T.InvalidParams,`Input validation error: Invalid arguments for tool ${$}: ${H}`)}return J.data}async validateToolOutput(Q,X,$){if(!Q.outputSchema)return;if(!("content"in X))return;if(X.isError)return;if(!X.structuredContent)throw new Z(T.InvalidParams,`Output validation error: Tool ${$} has an output schema but no structured content was provided`);let Y=h6(Q.outputSchema),G=await A9(Y,X.structuredContent);if(!G.success){let J="error"in G?G.error:"Unknown error",W=w9(J);throw new Z(T.InvalidParams,`Output validation error: Invalid structured content for tool ${$}: ${W}`)}}async executeToolHandler(Q,X,$){let Y=Q.handler;if("createTask"in Y){if(!$.taskStore)throw Error("No task store provided.");let J={...$,taskStore:$.taskStore};if(Q.inputSchema)return await Promise.resolve(Y.createTask(X,J));else return await Promise.resolve(Y.createTask(J))}if(Q.inputSchema)return await Promise.resolve(Y(X,$));else return await Promise.resolve(Y($))}async handleAutomaticTaskPolling(Q,X,$){if(!$.taskStore)throw Error("No task store provided for task-capable tool.");let Y=await this.validateToolInput(Q,X.params.arguments,X.params.name),G=Q.handler,J={...$,taskStore:$.taskStore},W=Y?await Promise.resolve(G.createTask(Y,J)):await Promise.resolve(G.createTask(J)),H=W.task.taskId,z=W.task,B=z.pollInterval??5000;while(z.status!=="completed"&&z.status!=="failed"&&z.status!=="cancelled"){await new Promise((q)=>setTimeout(q,B));let K=await $.taskStore.getTask(H);if(!K)throw new Z(T.InternalError,`Task ${H} not found during polling`);z=K}return await $.taskStore.getTaskResult(H)}setCompletionRequestHandler(){if(this._completionHandlerInitialized)return;this.server.assertCanSetRequestHandler(t0(d9)),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(d9,async(Q)=>{switch(Q.params.ref.type){case"ref/prompt":return GH(Q),this.handlePromptCompletion(Q,Q.params.ref);case"ref/resource":return JH(Q),this.handleResourceCompletion(Q,Q.params.ref);default:throw new Z(T.InvalidParams,`Invalid completion reference: ${Q.params.ref}`)}}),this._completionHandlerInitialized=!0}async handlePromptCompletion(Q,X){let $=this._registeredPrompts[X.name];if(!$)throw new Z(T.InvalidParams,`Prompt ${X.name} not found`);if(!$.enabled)throw new Z(T.InvalidParams,`Prompt ${X.name} disabled`);if(!$.argsSchema)return M8;let G=u0($.argsSchema)?.[Q.params.argument.name];if(!q7(G))return M8;let J=Zq(G);if(!J)return M8;let W=await J(Q.params.argument.value,Q.params.context);return _q(W)}async handleResourceCompletion(Q,X){let $=Object.values(this._registeredResourceTemplates).find((J)=>J.resourceTemplate.uriTemplate.toString()===X.uri);if(!$){if(this._registeredResources[X.uri])return M8;throw new Z(T.InvalidParams,`Resource template ${Q.params.ref.uri} not found`)}let Y=$.resourceTemplate.completeCallback(Q.params.argument.name);if(!Y)return M8;let G=await Y(Q.params.argument.value,Q.params.context);return _q(G)}setResourceRequestHandlers(){if(this._resourceHandlersInitialized)return;this.server.assertCanSetRequestHandler(t0(f9)),this.server.assertCanSetRequestHandler(t0(h9)),this.server.assertCanSetRequestHandler(t0(u9)),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(f9,async(Q,X)=>{let $=Object.entries(this._registeredResources).filter(([G,J])=>J.enabled).map(([G,J])=>({uri:G,name:J.name,...J.metadata})),Y=[];for(let G of Object.values(this._registeredResourceTemplates)){if(!G.resourceTemplate.listCallback)continue;let J=await G.resourceTemplate.listCallback(X);for(let W of J.resources)Y.push({...G.metadata,...W})}return{resources:[...$,...Y]}}),this.server.setRequestHandler(h9,async()=>{return{resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([X,$])=>({name:X,uriTemplate:$.resourceTemplate.uriTemplate.toString(),...$.metadata}))}}),this.server.setRequestHandler(u9,async(Q,X)=>{let $=new URL(Q.params.uri),Y=this._registeredResources[$.toString()];if(Y){if(!Y.enabled)throw new Z(T.InvalidParams,`Resource ${$} disabled`);return Y.readCallback($,X)}for(let G of Object.values(this._registeredResourceTemplates)){let J=G.resourceTemplate.uriTemplate.match($.toString());if(J)return G.readCallback($,J,X)}throw new Z(T.InvalidParams,`Resource ${$} not found`)}),this._resourceHandlersInitialized=!0}setPromptRequestHandlers(){if(this._promptHandlersInitialized)return;this.server.assertCanSetRequestHandler(t0(l9)),this.server.assertCanSetRequestHandler(t0(m9)),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(l9,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,Q])=>Q.enabled).map(([Q,X])=>{return{name:Q,title:X.title,description:X.description,arguments:X.argsSchema?RS(X.argsSchema):void 0}})})),this.server.setRequestHandler(m9,async(Q,X)=>{let $=this._registeredPrompts[Q.params.name];if(!$)throw new Z(T.InvalidParams,`Prompt ${Q.params.name} not found`);if(!$.enabled)throw new Z(T.InvalidParams,`Prompt ${Q.params.name} disabled`);if($.argsSchema){let Y=h6($.argsSchema),G=await A9(Y,Q.params.arguments);if(!G.success){let H="error"in G?G.error:"Unknown error",z=w9(H);throw new Z(T.InvalidParams,`Invalid arguments for prompt ${Q.params.name}: ${z}`)}let J=G.data,W=$.callback;return await Promise.resolve(W(J,X))}else{let Y=$.callback;return await Promise.resolve(Y(X))}}),this._promptHandlersInitialized=!0}resource(Q,X,...$){let Y;if(typeof $[0]==="object")Y=$.shift();let G=$[0];if(typeof X==="string"){if(this._registeredResources[X])throw Error(`Resource ${X} is already registered`);let J=this._createRegisteredResource(Q,void 0,X,Y,G);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),J}else{if(this._registeredResourceTemplates[Q])throw Error(`Resource template ${Q} is already registered`);let J=this._createRegisteredResourceTemplate(Q,void 0,X,Y,G);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),J}}registerResource(Q,X,$,Y){if(typeof X==="string"){if(this._registeredResources[X])throw Error(`Resource ${X} is already registered`);let G=this._createRegisteredResource(Q,$.title,X,$,Y);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),G}else{if(this._registeredResourceTemplates[Q])throw Error(`Resource template ${Q} is already registered`);let G=this._createRegisteredResourceTemplate(Q,$.title,X,$,Y);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),G}}_createRegisteredResource(Q,X,$,Y,G){let J={name:Q,title:X,metadata:Y,readCallback:G,enabled:!0,disable:()=>J.update({enabled:!1}),enable:()=>J.update({enabled:!0}),remove:()=>J.update({uri:null}),update:(W)=>{if(typeof W.uri<"u"&&W.uri!==$){if(delete this._registeredResources[$],W.uri)this._registeredResources[W.uri]=J}if(typeof W.name<"u")J.name=W.name;if(typeof W.title<"u")J.title=W.title;if(typeof W.metadata<"u")J.metadata=W.metadata;if(typeof W.callback<"u")J.readCallback=W.callback;if(typeof W.enabled<"u")J.enabled=W.enabled;this.sendResourceListChanged()}};return this._registeredResources[$]=J,J}_createRegisteredResourceTemplate(Q,X,$,Y,G){let J={resourceTemplate:$,title:X,metadata:Y,readCallback:G,enabled:!0,disable:()=>J.update({enabled:!1}),enable:()=>J.update({enabled:!0}),remove:()=>J.update({name:null}),update:(z)=>{if(typeof z.name<"u"&&z.name!==Q){if(delete this._registeredResourceTemplates[Q],z.name)this._registeredResourceTemplates[z.name]=J}if(typeof z.title<"u")J.title=z.title;if(typeof z.template<"u")J.resourceTemplate=z.template;if(typeof z.metadata<"u")J.metadata=z.metadata;if(typeof z.callback<"u")J.readCallback=z.callback;if(typeof z.enabled<"u")J.enabled=z.enabled;this.sendResourceListChanged()}};this._registeredResourceTemplates[Q]=J;let W=$.uriTemplate.variableNames;if(Array.isArray(W)&&W.some((z)=>!!$.completeCallback(z)))this.setCompletionRequestHandler();return J}_createRegisteredPrompt(Q,X,$,Y,G){let J={title:X,description:$,argsSchema:Y===void 0?void 0:q6(Y),callback:G,enabled:!0,disable:()=>J.update({enabled:!1}),enable:()=>J.update({enabled:!0}),remove:()=>J.update({name:null}),update:(W)=>{if(typeof W.name<"u"&&W.name!==Q){if(delete this._registeredPrompts[Q],W.name)this._registeredPrompts[W.name]=J}if(typeof W.title<"u")J.title=W.title;if(typeof W.description<"u")J.description=W.description;if(typeof W.argsSchema<"u")J.argsSchema=q6(W.argsSchema);if(typeof W.callback<"u")J.callback=W.callback;if(typeof W.enabled<"u")J.enabled=W.enabled;this.sendPromptListChanged()}};if(this._registeredPrompts[Q]=J,Y){if(Object.values(Y).some((H)=>{let z=H instanceof p1?H._def?.innerType:H;return q7(z)}))this.setCompletionRequestHandler()}return J}_createRegisteredTool(Q,X,$,Y,G,J,W,H,z){U7(Q);let B={title:X,description:$,inputSchema:Cq(Y),outputSchema:Cq(G),annotations:J,execution:W,_meta:H,handler:z,enabled:!0,disable:()=>B.update({enabled:!1}),enable:()=>B.update({enabled:!0}),remove:()=>B.update({name:null}),update:(K)=>{if(typeof K.name<"u"&&K.name!==Q){if(typeof K.name==="string")U7(K.name);if(delete this._registeredTools[Q],K.name)this._registeredTools[K.name]=B}if(typeof K.title<"u")B.title=K.title;if(typeof K.description<"u")B.description=K.description;if(typeof K.paramsSchema<"u")B.inputSchema=q6(K.paramsSchema);if(typeof K.outputSchema<"u")B.outputSchema=q6(K.outputSchema);if(typeof K.callback<"u")B.handler=K.callback;if(typeof K.annotations<"u")B.annotations=K.annotations;if(typeof K._meta<"u")B._meta=K._meta;if(typeof K.enabled<"u")B.enabled=K.enabled;this.sendToolListChanged()}};return this._registeredTools[Q]=B,this.setToolRequestHandlers(),this.sendToolListChanged(),B}tool(Q,...X){if(this._registeredTools[Q])throw Error(`Tool ${Q} is already registered`);let $,Y,G,J;if(typeof X[0]==="string")$=X.shift();if(X.length>1){let H=X[0];if(F7(H)){if(Y=X.shift(),X.length>1&&typeof X[0]==="object"&&X[0]!==null&&!F7(X[0]))J=X.shift()}else if(typeof H==="object"&&H!==null)J=X.shift()}let W=X[0];return this._createRegisteredTool(Q,void 0,$,Y,G,J,{taskSupport:"forbidden"},void 0,W)}registerTool(Q,X,$){if(this._registeredTools[Q])throw Error(`Tool ${Q} is already registered`);let{title:Y,description:G,inputSchema:J,outputSchema:W,annotations:H,_meta:z}=X;return this._createRegisteredTool(Q,Y,G,J,W,H,{taskSupport:"forbidden"},z,$)}prompt(Q,...X){if(this._registeredPrompts[Q])throw Error(`Prompt ${Q} is already registered`);let $;if(typeof X[0]==="string")$=X.shift();let Y;if(X.length>1)Y=X.shift();let G=X[0],J=this._createRegisteredPrompt(Q,void 0,$,Y,G);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),J}registerPrompt(Q,X,$){if(this._registeredPrompts[Q])throw Error(`Prompt ${Q} is already registered`);let{title:Y,description:G,argsSchema:J}=X,W=this._createRegisteredPrompt(Q,Y,G,J,$);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),W}isConnected(){return this.server.transport!==void 0}async sendLoggingMessage(Q,X){return this.server.sendLoggingMessage(Q,X)}sendResourceListChanged(){if(this.isConnected())this.server.sendResourceListChanged()}sendToolListChanged(){if(this.isConnected())this.server.sendToolListChanged()}sendPromptListChanged(){if(this.isConnected())this.server.sendPromptListChanged()}}var IS={type:"object",properties:{}};function kq(Q){return Q!==null&&typeof Q==="object"&&"parse"in Q&&typeof Q.parse==="function"&&"safeParse"in Q&&typeof Q.safeParse==="function"}function bS(Q){return"_def"in Q||"_zod"in Q||kq(Q)}function F7(Q){if(typeof Q!=="object"||Q===null)return!1;if(bS(Q))return!1;if(Object.keys(Q).length===0)return!0;return Object.values(Q).some(kq)}function Cq(Q){if(!Q)return;if(F7(Q))return q6(Q);return Q}function RS(Q){let X=u0(Q);if(!X)return[];return Object.entries(X).map(([$,Y])=>{let G=A3(Y),J=w3(Y);return{name:$,description:G,required:!J}})}function t0(Q){let $=u0(Q)?.method;if(!$)throw Error("Schema is missing a method literal");let Y=j9($);if(typeof Y==="string")return Y;throw Error("Schema method literal must be a string")}function _q(Q){return{completion:{values:Q.slice(0,100),total:Q.length,hasMore:Q.length>100}}}var M8={completion:{values:[],hasMore:!1}};function ES(Q,X,$,Y,G){return{name:Q,description:X,inputSchema:$,handler:Y,annotations:G?.annotations}}function PS(Q){let X=new N7({name:Q.name,version:Q.version??"1.0.0"},{capabilities:{tools:Q.tools?{}:void 0}});if(Q.tools)Q.tools.forEach(($)=>{X.registerTool($.name,{description:$.description,inputSchema:$.inputSchema,annotations:$.annotations},$.handler)});return{type:"sdk",name:Q.name,instance:X}}function Xm({prompt:Q,options:X}){let{systemPrompt:$,settingSources:Y,sandbox:G,...J}=X??{},W,H;if($===void 0)W="";else if(typeof $==="string")W=$;else if($.type==="preset")H=$.append;let z=J.pathToClaudeCodeExecutable;if(!z)z=n8(import.meta.url);process.env.CLAUDE_AGENT_SDK_VERSION="0.2.50";let{abortController:B=w6(),additionalDirectories:K=[],agent:q,agents:U,allowedTools:V=[],betas:L,canUseTool:F,continue:M,cwd:O,debug:j,debugFile:I,disallowedTools:v=[],tools:k,env:q1,executable:F1=P6()?"bun":"node",executableArgs:c1=[],extraArgs:a0={},fallbackModel:U0,enableFileCheckpointing:s0,forkSession:Z0,hooks:e0,includePartialMessages:u,persistSession:vQ,thinking:Q6,effort:$4,maxThinkingTokens:X6,maxTurns:A8,maxBudgetUsd:w8,mcpServers:R1,model:C0,outputFormat:M6,permissionMode:vq="default",allowDangerouslySkipPermissions:Tq=!1,permissionPromptToolName:xq,plugins:yq,resume:gq,resumeSessionAt:fq,sessionId:hq,stderr:uq,strictMcpConfig:lq}=J,D7=M6?.type==="json_schema"?M6.schema:void 0,A6=q1;if(!A6)A6={...process.env};if(!A6.CLAUDE_CODE_ENTRYPOINT)A6.CLAUDE_CODE_ENTRYPOINT="sdk-ts";if(s0)A6.CLAUDE_CODE_ENABLE_SDK_FILE_CHECKPOINTING="true";if(!z)throw Error("pathToClaudeCodeExecutable is required");let TQ={},O7=new Map;if(R1)for(let[j8,I8]of Object.entries(R1))if(I8.type==="sdk"&&"instance"in I8)O7.set(j8,I8.instance),TQ[j8]={type:"sdk",name:j8};else TQ[j8]=I8;let mq=typeof Q==="string",Y4;if(Q6)switch(Q6.type){case"adaptive":Y4={type:"adaptive"};break;case"enabled":Y4={type:"enabled",budgetTokens:Q6.budgetTokens};break;case"disabled":Y4={type:"disabled"};break}else if(X6!==void 0)Y4=X6===0?{type:"disabled"}:{type:"enabled",budgetTokens:X6};let M7=new J4({abortController:B,additionalDirectories:K,agent:q,betas:L,cwd:O,debug:j,debugFile:I,executable:F1,executableArgs:c1,extraArgs:a0,pathToClaudeCodeExecutable:z,env:A6,forkSession:Z0,stderr:uq,thinkingConfig:Y4,effort:$4,maxTurns:A8,maxBudgetUsd:w8,model:C0,fallbackModel:U0,jsonSchema:D7,permissionMode:vq,allowDangerouslySkipPermissions:Tq,permissionPromptToolName:xq,continueConversation:M,resume:gq,resumeSessionAt:fq,sessionId:hq,settingSources:Y??[],allowedTools:V,disallowedTools:v,tools:k,mcpServers:TQ,strictMcpConfig:lq,canUseTool:!!F,hooks:!!e0,includePartialMessages:u,persistSession:vQ,plugins:yq,sandbox:G,spawnClaudeCodeProcess:J.spawnClaudeCodeProcess}),cq={systemPrompt:W,appendSystemPrompt:H,agents:U,promptSuggestions:J.promptSuggestions},A7=new H4(M7,mq,F,e0,B,O7,D7,cq);if(typeof Q==="string")M7.write(S1({type:"user",session_id:"",message:{role:"user",content:[{type:"text",text:Q}]},parent_tool_use_id:null})+`
`);else A7.streamInput(Q);return A7}function $m(Q){return wX(Q)}function Ym(Q,X){return aJ(Q,X)}async function Gm(Q,X){let Y=[];try{const $=e(Y,wX(X),1);await $.send(Q);for await(let z of $.stream())if(z.type==="result")return z;throw Error("Session ended without result message")}catch(G){var J=G,W=1}finally{var H=Q1(Y,J,W);H&&await H}}export{Ym as unstable_v2_resumeSession,Gm as unstable_v2_prompt,$m as unstable_v2_createSession,ES as tool,Xm as query,PS as createSdkMcpServer,yL as HOOK_EVENTS,gL as EXIT_REASONS,D0 as AbortError};
